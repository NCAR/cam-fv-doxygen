<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DART CAM-SE: direct_netcdf_mod</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DART CAM-SE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">direct_netcdf_mod</div></div>
</div><!--header-->
<div class="contents">

<p>Netcdf IO for a domain. The idea is to be generic rather than having a converter for each module. Also aim to go to the filesystem only once, e.g.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga5e6a92968fe0fa12010bff633ab92549" id="r_ga5e6a92968fe0fa12010bff633ab92549"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549">direct_netcdf_mod::read_transpose</a> (state_ens_handle, name_handle, domain, dart_index, read_single_vars)</td></tr>
<tr class="memdesc:ga5e6a92968fe0fa12010bff633ab92549"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and transpose variables in cyclic-cyclic distribution (round robbin)  <br /></td></tr>
<tr class="separator:ga5e6a92968fe0fa12010bff633ab92549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ca56c81dfed34ffca506790ad794e1c" id="r_ga8ca56c81dfed34ffca506790ad794e1c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c">direct_netcdf_mod::transpose_write</a> (state_ens_handle, name_handle, domain, dart_index, write_single_vars, write_single_precision)</td></tr>
<tr class="memdesc:ga8ca56c81dfed34ffca506790ad794e1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This code transposes and writes out the state vector copies This can either be done on a single task or with multiple tasks.  <br /></td></tr>
<tr class="separator:ga8ca56c81dfed34ffca506790ad794e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga811379f67b7a78e7cbfab32f80b54b8c" id="r_ga811379f67b7a78e7cbfab32f80b54b8c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c">direct_netcdf_mod::initialize_single_file_io</a> (ens_handle, file_handle)</td></tr>
<tr class="memdesc:ga811379f67b7a78e7cbfab32f80b54b8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a template file for single file io Calls the model for any model specific attributes to be written.  <br /></td></tr>
<tr class="separator:ga811379f67b7a78e7cbfab32f80b54b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5da57561c4275530367b53a116303f9f" id="r_ga5da57561c4275530367b53a116303f9f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5da57561c4275530367b53a116303f9f">direct_netcdf_mod::finalize_single_file_io</a> (file_handle)</td></tr>
<tr class="separator:ga5da57561c4275530367b53a116303f9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1bde9358fa6fadc774d471d0bec36553" id="r_ga1bde9358fa6fadc774d471d0bec36553"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553">direct_netcdf_mod::read_single_file</a> (state_ens_handle, file_handle, use_time_from_file, mtime, pert_from_single_copy)</td></tr>
<tr class="memdesc:ga1bde9358fa6fadc774d471d0bec36553"><td class="mdescLeft">&#160;</td><td class="mdescRight">read a single netcdf file containing all of the members and possibly inflation information  <br /></td></tr>
<tr class="separator:ga1bde9358fa6fadc774d471d0bec36553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53e97fc6bd08a2af8be0d542ecc56a58" id="r_ga53e97fc6bd08a2af8be0d542ecc56a58"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga53e97fc6bd08a2af8be0d542ecc56a58">direct_netcdf_mod::write_single_file</a> (ens_handle, file_handle)</td></tr>
<tr class="memdesc:ga53e97fc6bd08a2af8be0d542ecc56a58"><td class="mdescLeft">&#160;</td><td class="mdescRight">write all variable to a single file including all member, and optionally inflation, mean, sd  <br /></td></tr>
<tr class="separator:ga53e97fc6bd08a2af8be0d542ecc56a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4db4441591f610b3e2c4d06480c28535" id="r_ga4db4441591f610b3e2c4d06480c28535"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535">direct_netcdf_mod::write_augmented_state</a> (ens_handle, file_handle)</td></tr>
<tr class="memdesc:ga4db4441591f610b3e2c4d06480c28535"><td class="mdescLeft">&#160;</td><td class="mdescRight">insert the mean and sd into the input file if the user requests this assumes that the files has already been closed and the variables read in.  <br /></td></tr>
<tr class="separator:ga4db4441591f610b3e2c4d06480c28535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ff418907b25b36edeaf6a7bae9f42a2" id="r_ga5ff418907b25b36edeaf6a7bae9f42a2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5ff418907b25b36edeaf6a7bae9f42a2">direct_netcdf_mod::read_variables</a> (ncfile_in, var_block, start_var, end_var, domain)</td></tr>
<tr class="memdesc:ga5ff418907b25b36edeaf6a7bae9f42a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in variables from start_var to end_var Read the latest time slice in the file.  <br /></td></tr>
<tr class="separator:ga5ff418907b25b36edeaf6a7bae9f42a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bd1c0ced6a496672242e6b11e230b18" id="r_ga5bd1c0ced6a496672242e6b11e230b18"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5bd1c0ced6a496672242e6b11e230b18">direct_netcdf_mod::read_transpose_single_task</a> (state_ens_handle, name_handle, domain, dart_index)</td></tr>
<tr class="memdesc:ga5bd1c0ced6a496672242e6b11e230b18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills up a row of copies for each file.  <br /></td></tr>
<tr class="separator:ga5bd1c0ced6a496672242e6b11e230b18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a0dc19e06b1c54e04d3bd0921f674a1" id="r_ga5a0dc19e06b1c54e04d3bd0921f674a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1">direct_netcdf_mod::transpose_write_single_task</a> (state_ens_handle, name_handle, domain, dart_index, write_single_precision)</td></tr>
<tr class="memdesc:ga5a0dc19e06b1c54e04d3bd0921f674a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single processor version of transpose write. Takes copies array one row at a time and writes copy to a netcdf file.  <br /></td></tr>
<tr class="separator:ga5a0dc19e06b1c54e04d3bd0921f674a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ddfc9953eb0e009c773f60a75a61f78" id="r_ga4ddfc9953eb0e009c773f60a75a61f78"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78">direct_netcdf_mod::read_transpose_multi_task</a> (state_ens_handle, name_handle, domain, dart_index, read_var_by_var)</td></tr>
<tr class="memdesc:ga4ddfc9953eb0e009c773f60a75a61f78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read in variables from model restart file and transpose so that every processor has all copies of a subset of state variables (fill state_ens_handlecopies) Read and transpose data according to the memory limit imposed by read_var_by_var.  <br /></td></tr>
<tr class="separator:ga4ddfc9953eb0e009c773f60a75a61f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac697410acb3e6e9c9483c6865694799" id="r_gaac697410acb3e6e9c9483c6865694799"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799">direct_netcdf_mod::transpose_write_multi_task</a> (state_ens_handle, name_handle, domain, dart_index, write_var_by_var, write_single_precision)</td></tr>
<tr class="memdesc:gaac697410acb3e6e9c9483c6865694799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_var_by_var.  <br /></td></tr>
<tr class="separator:gaac697410acb3e6e9c9483c6865694799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga285ec6a4e531cbba343a349a20deea76" id="r_ga285ec6a4e531cbba343a349a20deea76"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga285ec6a4e531cbba343a349a20deea76">direct_netcdf_mod::clamp_variable</a> (dom_id, var_index, variable)</td></tr>
<tr class="memdesc:ga285ec6a4e531cbba343a349a20deea76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits, this routine returns .TRUE. If the variable is unbounded, this routine returns .FALSE. The return value is not an indication of whether or not the values have actually been modified.  <br /></td></tr>
<tr class="separator:ga285ec6a4e531cbba343a349a20deea76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4797f5013f67a845fdd1ac9aee5bdd9a" id="r_ga4797f5013f67a845fdd1ac9aee5bdd9a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a">direct_netcdf_mod::write_variables</a> (ncid, var_block, start_var, end_var, domain, do_file_clamping, force_copy)</td></tr>
<tr class="memdesc:ga4797f5013f67a845fdd1ac9aee5bdd9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write variables from start_var to end_var no clamping.  <br /></td></tr>
<tr class="separator:ga4797f5013f67a845fdd1ac9aee5bdd9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30e5e10d0b1bbc7e42a16ee50f75906f" id="r_ga30e5e10d0b1bbc7e42a16ee50f75906f"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f">direct_netcdf_mod::create_and_open_state_output</a> (name_handle, dom_id, copy_number, dart_time, single_precision_output)</td></tr>
<tr class="memdesc:ga30e5e10d0b1bbc7e42a16ee50f75906f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write variables from start_var to end_var for actual ensemble members.  <br /></td></tr>
<tr class="separator:ga30e5e10d0b1bbc7e42a16ee50f75906f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga507c64d98551df97643e9e549a1e3a6d" id="r_ga507c64d98551df97643e9e549a1e3a6d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d">direct_netcdf_mod::write_variable_attributes</a> (filename, ncfileid, ncvarid, domid, varid, name_handle, copy_number)</td></tr>
<tr class="memdesc:ga507c64d98551df97643e9e549a1e3a6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model attributes if they exist. This is only used for files that are created by DART.  <br /></td></tr>
<tr class="separator:ga507c64d98551df97643e9e549a1e3a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b4b6fd124b574282fccbff0d7c07437" id="r_ga9b4b6fd124b574282fccbff0d7c07437"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga9b4b6fd124b574282fccbff0d7c07437">direct_netcdf_mod::nc_write_file_information</a> (ncfileid, filename, description)</td></tr>
<tr class="memdesc:ga9b4b6fd124b574282fccbff0d7c07437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write global clamping attributes to files that already exist.  <br /></td></tr>
<tr class="separator:ga9b4b6fd124b574282fccbff0d7c07437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09f849b5b89663f36e43ba4058555515" id="r_ga09f849b5b89663f36e43ba4058555515"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga09f849b5b89663f36e43ba4058555515">direct_netcdf_mod::nc_write_variable_att_clamping</a> (ncfileid, filename, ncvarid, domid, varid)</td></tr>
<tr class="memdesc:ga09f849b5b89663f36e43ba4058555515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write clamping to variable attributes to files created from scratch.  <br /></td></tr>
<tr class="separator:ga09f849b5b89663f36e43ba4058555515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14f0ad63f26920f56019fe2036506b71" id="r_ga14f0ad63f26920f56019fe2036506b71"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga14f0ad63f26920f56019fe2036506b71">direct_netcdf_mod::nc_write_global_att_clamping</a> (ncfileid, copy, domid, from_scratch)</td></tr>
<tr class="memdesc:ga14f0ad63f26920f56019fe2036506b71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write global clamping attributes for variables that have clamping.  <br /></td></tr>
<tr class="separator:ga14f0ad63f26920f56019fe2036506b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8d438fbf74476572922b31434f3f2e9" id="r_gaf8d438fbf74476572922b31434f3f2e9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gaf8d438fbf74476572922b31434f3f2e9">direct_netcdf_mod::nc_write_revision_info</a> (ncfileid)</td></tr>
<tr class="memdesc:gaf8d438fbf74476572922b31434f3f2e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write revision information.  <br /></td></tr>
<tr class="separator:gaf8d438fbf74476572922b31434f3f2e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85a4fb44801f712976ce12f96ac367f2" id="r_ga85a4fb44801f712976ce12f96ac367f2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2">direct_netcdf_mod::nc_write_missing_value_int</a> (ncfileid, filename, ncvarid, domid, varid)</td></tr>
<tr class="memdesc:ga85a4fb44801f712976ce12f96ac367f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model integer missing_value/_FillValue attributes if they exist.  <br /></td></tr>
<tr class="separator:ga85a4fb44801f712976ce12f96ac367f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga97512c742d614257d5013e176e85a3a9" id="r_ga97512c742d614257d5013e176e85a3a9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga97512c742d614257d5013e176e85a3a9">direct_netcdf_mod::nc_write_missing_value_r4</a> (ncfileid, filename, ncvarid, domid, varid)</td></tr>
<tr class="memdesc:ga97512c742d614257d5013e176e85a3a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model r4 missing_value/_FillValue attributes if they exist.  <br /></td></tr>
<tr class="separator:ga97512c742d614257d5013e176e85a3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad501af477a3530059fd8cac992d89632" id="r_gad501af477a3530059fd8cac992d89632"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gad501af477a3530059fd8cac992d89632">direct_netcdf_mod::nc_write_missing_value_r8</a> (ncfileid, filename, ncvarid, domid, varid)</td></tr>
<tr class="memdesc:gad501af477a3530059fd8cac992d89632"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model r8 missing_value/_FillValue attributes if they exist.  <br /></td></tr>
<tr class="separator:gad501af477a3530059fd8cac992d89632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga637259129bab7191a953fc685b83b23f" id="r_ga637259129bab7191a953fc685b83b23f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f">direct_netcdf_mod::get_pe_loops</a> (ens_size, recv_start, recv_end, send_start, send_end)</td></tr>
<tr class="memdesc:ga637259129bab7191a953fc685b83b23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy tasks will send, everyone will receive.  <br /></td></tr>
<tr class="separator:ga637259129bab7191a953fc685b83b23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4f365fad4bff8aeef537b79fa8c65c6" id="r_gad4f365fad4bff8aeef537b79fa8c65c6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gad4f365fad4bff8aeef537b79fa8c65c6">direct_netcdf_mod::send_to_waiting_task</a> (state_ens_handle, recv_pe, start, elm_count, block_size, variable_block)</td></tr>
<tr class="memdesc:gad4f365fad4bff8aeef537b79fa8c65c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send elements of variables to a processor. This routine must be called with a corresponding 'wait_to_receive'. The data on the sender are non-contiguous with a stride of task_count. The start is different depending on which pe is the recv and which variables are being sent (these are calculated in the calling routine). The data on the receiver are contiguous (it is the copies array)  <br /></td></tr>
<tr class="separator:gad4f365fad4bff8aeef537b79fa8c65c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcb9423c2f193aec26e71a63aa6496d3" id="r_gadcb9423c2f193aec26e71a63aa6496d3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gadcb9423c2f193aec26e71a63aa6496d3">direct_netcdf_mod::send_variables_to_write</a> (state_ens_handle, recv_pe, ensemble_member, start, finish)</td></tr>
<tr class="memdesc:gadcb9423c2f193aec26e71a63aa6496d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in copies on the sending pe. Finish is the last index in copies to send. If all variables are transposed at once, start = 1, finish = ens_handlemy_num_vars (on sending pe) This routine must be called with a corresponding 'recv_variables_to_write.' The data on the sender is non-contiguous since it is a ROW of copies.  <br /></td></tr>
<tr class="separator:gadcb9423c2f193aec26e71a63aa6496d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b0931795ec7b987d9782e4998a62b51" id="r_ga7b0931795ec7b987d9782e4998a62b51"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga7b0931795ec7b987d9782e4998a62b51">direct_netcdf_mod::wait_to_receive</a> (state_ens_handle, recv_pe, ensemble_member, start, finish)</td></tr>
<tr class="memdesc:ga7b0931795ec7b987d9782e4998a62b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from a reader. Start and finish are the local indicies in the copies array for the data being received. If all variables are transposed at once, start = 1, finish = ens_handlemy_num_vars (on receiveing pe) This routine must be called with a corresponding 'send_to_waiting_task'. The data on the sender is non-contiguous since it is a ROW of copies.  <br /></td></tr>
<tr class="separator:ga7b0931795ec7b987d9782e4998a62b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab53c53011a55614fac307142233b83d4" id="r_gab53c53011a55614fac307142233b83d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gab53c53011a55614fac307142233b83d4">direct_netcdf_mod::recv_variables_to_write</a> (state_ens_handle, sending_pe, start, elm_count, block_size, variable_block)</td></tr>
<tr class="memdesc:gab53c53011a55614fac307142233b83d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data to write/collect. The data is put non-contiguously into variable_block. Variable_block is the block of data writen to a netcdf file. It may be 1 or more variables. start and elm_count depend on the sending pe. These are calculated in the calling code. The stride is task_count() since we are assuming a round robin distribution of state vector onto processors. This routine must be called with a corresponding 'send_variables_to_write'.  <br /></td></tr>
<tr class="separator:gab53c53011a55614fac307142233b83d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9832acfa2d0a5df09bb4a312efa0d407" id="r_ga9832acfa2d0a5df09bb4a312efa0d407"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga9832acfa2d0a5df09bb4a312efa0d407">direct_netcdf_mod::write_model_variables</a> (ncfileid, model_state, memindex, curr_ens_time, timeindex)</td></tr>
<tr class="memdesc:ga9832acfa2d0a5df09bb4a312efa0d407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write state to the last time slice of a file when using "single file io".  <br /></td></tr>
<tr class="separator:ga9832acfa2d0a5df09bb4a312efa0d407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga490370b86f88f566fa0e84c367401b0a" id="r_ga490370b86f88f566fa0e84c367401b0a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a">direct_netcdf_mod::write_model_attributes</a> (ncfileid, member_dimid, time_dimid, file_handle)</td></tr>
<tr class="memdesc:ga490370b86f88f566fa0e84c367401b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model attributes to for each variable when using "single file io".  <br /></td></tr>
<tr class="separator:ga490370b86f88f566fa0e84c367401b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b7ae906009b2de66351c7a1bb904987" id="r_ga1b7ae906009b2de66351c7a1bb904987"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga1b7ae906009b2de66351c7a1bb904987">direct_netcdf_mod::write_extra_variables</a> (ncfileid, model_state, copyname, curr_ens_time, timeindex)</td></tr>
<tr class="memdesc:ga1b7ae906009b2de66351c7a1bb904987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for the when writting single file diagnostc/restart files.  <br /></td></tr>
<tr class="separator:ga1b7ae906009b2de66351c7a1bb904987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06dc065665c83c091c1b4c4feb5c16b8" id="r_ga06dc065665c83c091c1b4c4feb5c16b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8">direct_netcdf_mod::write_extra_attributes</a> (ncfileid, time_dimid, file_handle, copy_index)</td></tr>
<tr class="memdesc:ga06dc065665c83c091c1b4c4feb5c16b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out extra copies (if specified in the filter_nml) attribute in the last time slot. This is only used when writting single file diagnostc/restart files.  <br /></td></tr>
<tr class="separator:ga06dc065665c83c091c1b4c4feb5c16b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac25ed7ba0ea54f5ac988274990c2f955" id="r_gac25ed7ba0ea54f5ac988274990c2f955"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gac25ed7ba0ea54f5ac988274990c2f955">direct_netcdf_mod::get_dimension_info</a> (copy, dom_id, var_id, timestep, is_extra, numdims, start, lengths)</td></tr>
<tr class="memdesc:gac25ed7ba0ea54f5ac988274990c2f955"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper function to return the netcdf dimension id's and lengths  <br /></td></tr>
<tr class="separator:gac25ed7ba0ea54f5ac988274990c2f955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13ebb0777e5db14d4e6915b13b652b23" id="r_ga13ebb0777e5db14d4e6915b13b652b23"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga13ebb0777e5db14d4e6915b13b652b23">direct_netcdf_mod::check_singlefile_member_info</a> (ncid, fname, ens_size, do_pert)</td></tr>
<tr class="memdesc:ga13ebb0777e5db14d4e6915b13b652b23"><td class="mdescLeft">&#160;</td><td class="mdescRight">we're in read_single_file - there better be multiple members or we can't read in an ensemble from this file. the only exception is if we are reading in a single member to perturb into an ensemble. otherwise it's an error.  <br /></td></tr>
<tr class="separator:ga13ebb0777e5db14d4e6915b13b652b23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0254908b100e01af1a9f26cc4685bf76" id="r_ga0254908b100e01af1a9f26cc4685bf76"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga0254908b100e01af1a9f26cc4685bf76">direct_netcdf_mod::nc_get_tindex</a> (ncfileid, statetime)</td></tr>
<tr class="memdesc:ga0254908b100e01af1a9f26cc4685bf76"><td class="mdescLeft">&#160;</td><td class="mdescRight">We need to compare the time of the current assim_model to the netcdf time coordinate variable (the unlimited dimension). If they are the same, no problem ... If it is earlier, we need to find the right index and insert ... If it is the "future", we need to add another one ... If it is in the past but does not match any we have, we're in trouble. The new length of the "time" variable is returned.  <br /></td></tr>
<tr class="separator:ga0254908b100e01af1a9f26cc4685bf76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9dc061f4e03f757d1ead8be309c5a28" id="r_gad9dc061f4e03f757d1ead8be309c5a28"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gad9dc061f4e03f757d1ead8be309c5a28">direct_netcdf_mod::nc_append_time</a> (ncfileid, dart_time)</td></tr>
<tr class="memdesc:gad9dc061f4e03f757d1ead8be309c5a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current time is appended to the "time" coordinate variable. The new length of the "time" variable is returned.  <br /></td></tr>
<tr class="separator:gad9dc061f4e03f757d1ead8be309c5a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31098fc0ee34f4559645cd5122edc81e" id="r_ga31098fc0ee34f4559645cd5122edc81e"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga31098fc0ee34f4559645cd5122edc81e">direct_netcdf_mod::nc_write_calendar_atts</a> (ncfileid, timevarid)</td></tr>
<tr class="memdesc:ga31098fc0ee34f4559645cd5122edc81e"><td class="mdescLeft">&#160;</td><td class="mdescRight">routine write calendar attributes  <br /></td></tr>
<tr class="separator:ga31098fc0ee34f4559645cd5122edc81e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb7b451fc6de3f86bffb169fa700f668" id="r_gafb7b451fc6de3f86bffb169fa700f668"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gafb7b451fc6de3f86bffb169fa700f668">direct_netcdf_mod::nc_get_num_times</a> (fname)</td></tr>
<tr class="separator:gafb7b451fc6de3f86bffb169fa700f668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6de05cb71d2bbee35200331c64f5a4c5" id="r_ga6de05cb71d2bbee35200331c64f5a4c5"><td class="memItemLeft" align="right" valign="top">integer(i8) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5">direct_netcdf_mod::num_elements_on_pe</a> (pe, start_rank, block_size)</td></tr>
<tr class="memdesc:ga6de05cb71d2bbee35200331c64f5a4c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sending pe (transpose_write) for a given start_rank and block_size. block_size is the number of elements in a block of variables. There may be 1 variable or all variables depending on buffer_state_io. start_rank is the pe that owns the 1st element of the 1st variable in the variable_block.  <br /></td></tr>
<tr class="separator:ga6de05cb71d2bbee35200331c64f5a4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac406bea6ff4528072fe75da92c522693" id="r_gac406bea6ff4528072fe75da92c522693"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693">direct_netcdf_mod::get_start_rank</a> (variable, domain)</td></tr>
<tr class="memdesc:gac406bea6ff4528072fe75da92c522693"><td class="mdescLeft">&#160;</td><td class="mdescRight">Give the rank of the processor that owns the start of a variable.  <br /></td></tr>
<tr class="separator:gac406bea6ff4528072fe75da92c522693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga806acc05ff4f8aaa9db2906f9df08c47" id="r_ga806acc05ff4f8aaa9db2906f9df08c47"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47">direct_netcdf_mod::find_start_point</a> (recv_pe, start_rank)</td></tr>
<tr class="memdesc:ga806acc05ff4f8aaa9db2906f9df08c47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find i, the start point in var_block for a given recv_pe This is assuming round robin. - will have to query the ensemble manager to find this for different disrtibutions.  <br /></td></tr>
<tr class="separator:ga806acc05ff4f8aaa9db2906f9df08c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cfe0a8ae9bd2d3677457afeeb15226e" id="r_ga5cfe0a8ae9bd2d3677457afeeb15226e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga5cfe0a8ae9bd2d3677457afeeb15226e">direct_netcdf_mod::set_dart_missing_value</a> (array, domain, variable)</td></tr>
<tr class="memdesc:ga5cfe0a8ae9bd2d3677457afeeb15226e"><td class="mdescLeft">&#160;</td><td class="mdescRight">replace the netCDF missing_value or _FillValue with the DART missing value.  <br /></td></tr>
<tr class="separator:ga5cfe0a8ae9bd2d3677457afeeb15226e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31a5d51284ae8bd115186ab8e168a574" id="r_ga31a5d51284ae8bd115186ab8e168a574"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga31a5d51284ae8bd115186ab8e168a574">direct_netcdf_mod::set_model_missing_value</a> (array, domain, variable)</td></tr>
<tr class="memdesc:ga31a5d51284ae8bd115186ab8e168a574"><td class="mdescLeft">&#160;</td><td class="mdescRight">replace the DART missing value code with the original netCDF missing_value (or _FillValue) value.  <br /></td></tr>
<tr class="separator:ga31a5d51284ae8bd115186ab8e168a574"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga8747a4cc552d1e203e04d48d72ae3269" id="r_ga8747a4cc552d1e203e04d48d72ae3269"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga8747a4cc552d1e203e04d48d72ae3269">direct_netcdf_mod::single_io_task_id</a> = 0</td></tr>
<tr class="separator:ga8747a4cc552d1e203e04d48d72ae3269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1afe8e546cf04d71faf60750393aaa9f" id="r_ga1afe8e546cf04d71faf60750393aaa9f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga1afe8e546cf04d71faf60750393aaa9f">direct_netcdf_mod::ret</a></td></tr>
<tr class="separator:ga1afe8e546cf04d71faf60750393aaa9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9895fa2d5184a06d7e067817bc46895" id="r_gaf9895fa2d5184a06d7e067817bc46895"><td class="memItemLeft" align="right" valign="top">character(len=512)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#gaf9895fa2d5184a06d7e067817bc46895">direct_netcdf_mod::msgstring</a></td></tr>
<tr class="separator:gaf9895fa2d5184a06d7e067817bc46895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ee9f8782a2aebda59b8b20a45537673" id="r_ga0ee9f8782a2aebda59b8b20a45537673"><td class="memItemLeft" align="right" valign="top">character(len=512)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga0ee9f8782a2aebda59b8b20a45537673">direct_netcdf_mod::msgstring2</a></td></tr>
<tr class="separator:ga0ee9f8782a2aebda59b8b20a45537673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga537d935ffe862c59c53c24dc4825ec14" id="r_ga537d935ffe862c59c53c24dc4825ec14"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__direct__netcdf__mod.html#ga537d935ffe862c59c53c24dc4825ec14">direct_netcdf_mod::overwrite_time_in_output_file</a> = .false.</td></tr>
<tr class="separator:ga537d935ffe862c59c53c24dc4825ec14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Netcdf IO for a domain. The idea is to be generic rather than having a converter for each module. Also aim to go to the filesystem only once, e.g. </p>
<pre class="fragment">      wrf =&gt; dart =&gt; wrf</pre><p> rather than </p><pre class="fragment">      wrf =&gt; wrf_to_dart =&gt; dart =&gt; dart_to_wrf =&gt; wrf</pre><p>Every task needs the dimensions of each state variable to calculate what it is going to recieve in the IO transpose (this is calculated in add_domain ) </p><dl class="section user"><dt>Aim of the limited transpose:</dt><dd></dd></dl>
<p>To limit how much of the state vector you can read at once. You can limit the transpose by memory using <code>buffer_state_io</code>.</p>
<p>What you (potentially) gain from this:</p>
<ul>
<li>Don't have to have the whole state vector.</li>
<li>Don't have to use a parallel IO library.</li>
</ul>
<p>If buffer_state_io is false you have the regular transpose + IO, except:</p><ol type="1">
<li>You are reading directly from a netcdf file, not a dart state vector file.</li>
<li>You only transpose the copies that are being written/read.</li>
</ol>
<p>This code has multiple places where round-robin layout of state onto task is assumed. These are in the section labelled: <br  />
 </p><pre class="fragment">    !--------------------------------------------------------
    ! Routines that are making the assumption that the ensemble
    ! distribution is round-robin (distribution type 1)
    !--------------------------------------------------------</pre><p>read_transpose() is the read routine. transpose_write() is the write routine.</p>
<p>Note dart_index is an inout variable to read_transpose() and transpose_write(). This is making the assumption that the calling code is using dart_index in the following way:</p><ul>
<li>dart_index going in to the subroutines is where the domain starts in the state vector.</li>
<li>dart_index coming out of the subroutines is where the domain ends.</li>
<li>The domain is contiguous in the state_vector. </li>
</ul>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga13ebb0777e5db14d4e6915b13b652b23" name="ga13ebb0777e5db14d4e6915b13b652b23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga13ebb0777e5db14d4e6915b13b652b23">&#9670;&#160;</a></span>check_singlefile_member_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::check_singlefile_member_info </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=nf90_max_name), intent(in)&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ens_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_pert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>we're in read_single_file - there better be multiple members or we can't read in an ensemble from this file. the only exception is if we are reading in a single member to perturb into an ensemble. otherwise it's an error. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02614">2614</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_cgraph" id="agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_cgraph">
<area shape="rect" title="we&#39;re in read_single_file &#45; there better be multiple members or we can&#39;t read in an ensemble from thi..." alt="" coords="5,100,202,141"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="441,71,569,111"/>
<area shape="poly" title=" " alt="" coords="202,111,425,94,426,99,202,116"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="250,128,387,169"/>
<area shape="poly" title=" " alt="" coords="203,131,235,135,234,140,202,136"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="626,5,754,46"/>
<area shape="poly" title=" " alt="" coords="564,68,615,49,617,54,566,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="626,71,754,111"/>
<area shape="poly" title=" " alt="" coords="570,88,611,88,611,94,570,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="623,136,757,161"/>
<area shape="poly" title=" " alt="" coords="571,108,632,128,631,133,569,113"/>
<area shape="poly" title=" " alt="" coords="386,125,425,113,427,118,387,130"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="435,136,575,177"/>
<area shape="poly" title=" " alt="" coords="387,149,419,150,419,155,387,154"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_icgraph" id="agroup__direct__netcdf__mod_ga13ebb0777e5db14d4e6915b13b652b23_icgraph">
<area shape="rect" title="we&#39;re in read_single_file &#45; there better be multiple members or we can&#39;t read in an ensemble from thi..." alt="" coords="975,287,1171,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="791,287,927,328"/>
<area shape="poly" title=" " alt="" coords="960,310,927,310,927,305,960,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga285ec6a4e531cbba343a349a20deea76" name="ga285ec6a4e531cbba343a349a20deea76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga285ec6a4e531cbba343a349a20deea76">&#9670;&#160;</a></span>clamp_variable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::clamp_variable </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dom_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>var_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits, this routine returns .TRUE. If the variable is unbounded, this routine returns .FALSE. The return value is not an indication of whether or not the values have actually been modified. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000050">Todo:</a></b></dt><dd>this is what the code needs to be for CLM and any other </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000051">Todo:</a></b></dt><dd>again, if we're allowing missing in state, this has to be masked: </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000052">Todo:</a></b></dt><dd>again, if we're allowing missing in state, this has to be masked: </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01456">1456</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_cgraph" id="agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_cgraph">
<area shape="rect" title="Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits,..." alt="" coords="5,164,142,205"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="190,29,363,70"/>
<area shape="poly" title=" " alt="" coords="92,162,134,121,188,81,199,75,201,80,191,85,137,126,96,166"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="192,119,361,159"/>
<area shape="poly" title=" " alt="" coords="141,167,176,159,177,164,143,172"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="190,208,363,249"/>
<area shape="poly" title=" " alt="" coords="143,197,175,204,174,209,141,202"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="206,297,347,338"/>
<area shape="poly" title=" " alt="" coords="108,203,233,286,230,291,105,207"/>
<area shape="poly" title=" " alt="" coords="238,29,236,19,242,10,256,5,276,3,298,5,312,11,309,16,297,10,276,8,257,10,246,15,241,20,243,28"/>
<area shape="poly" title=" " alt="" coords="238,119,236,109,242,100,256,94,276,92,298,94,312,101,309,105,297,100,276,97,257,99,246,104,241,110,243,117"/>
<area shape="poly" title=" " alt="" coords="238,208,236,198,242,189,256,183,276,181,298,184,312,190,309,195,297,189,276,187,257,189,246,193,241,199,243,207"/>
<area shape="poly" title=" " alt="" coords="238,297,236,287,242,278,256,273,276,271,298,273,312,279,309,284,297,278,276,276,257,278,246,283,241,288,243,296"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_icgraph" id="agroup__direct__netcdf__mod_ga285ec6a4e531cbba343a349a20deea76_icgraph">
<area shape="rect" title="Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits,..." alt="" coords="1584,287,1720,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a" title="Write variables from start_var to end_var no clamping." alt="" coords="1400,287,1536,328"/>
<area shape="poly" title=" " alt="" coords="1569,310,1537,310,1537,305,1569,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,297,1349,291,1350,286,1385,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,323,1353,328,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga30e5e10d0b1bbc7e42a16ee50f75906f" name="ga30e5e10d0b1bbc7e42a16ee50f75906f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga30e5e10d0b1bbc7e42a16ee50f75906f">&#9670;&#160;</a></span>create_and_open_state_output()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::create_and_open_state_output </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dom_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>copy_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>dart_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>single_precision_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write variables from start_var to end_var for actual ensemble members. </p>
<p>Create the output files</p>
<p>A 'blank' domain is one variable called state, with dimension = model size. It is used when the model has not supplied any netcdf info but direct_netcdf_write = .true. The file is intentionally left OPEN. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000055">Todo:</a></b></dt><dd>if we already have a unique names we can take this test out </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01645">1645</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_cgraph" id="agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_cgraph">
<area shape="rect" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="5,727,162,783"/>
<area shape="rect" href="group__state__structure__mod.html#ga1afde1c8dca54decec4036a12a074a95" title="Returns whether a variable should be updated or not." alt="" coords="228,29,368,70"/>
<area shape="poly" title=" " alt="" coords="84,727,95,593,118,403,135,305,155,214,179,139,193,110,208,87,217,77,220,81,212,90,197,112,184,141,160,216,140,306,124,404,101,594,89,727"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="890,444,1018,485"/>
<area shape="poly" title=" " alt="" coords="83,727,92,598,112,416,128,324,149,241,175,174,191,149,208,130,230,115,251,106,272,102,293,103,336,114,387,130,470,157,552,193,630,233,704,277,831,363,918,432,915,436,827,368,701,282,628,238,549,197,468,162,385,135,334,119,292,109,272,108,253,111,233,120,211,134,195,152,180,177,154,243,133,326,117,417,97,598,89,727"/>
<area shape="rect" href="group__io__filenames__mod.html#ga931e77da21e002703282c7662cb77f47" title=" " alt="" coords="216,168,380,209"/>
<area shape="poly" title=" " alt="" coords="85,726,100,617,125,466,142,389,161,319,183,260,208,220,211,217,215,220,212,223,188,263,166,320,147,390,130,467,105,617,91,727"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="228,257,368,298"/>
<area shape="poly" title=" " alt="" coords="82,726,88,647,105,539,121,480,143,421,171,365,208,315,217,305,221,309,212,318,176,368,148,423,126,481,110,540,93,648,88,727"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="449,943,601,983"/>
<area shape="poly" title=" " alt="" coords="96,782,112,821,136,867,169,911,189,930,211,946,265,968,322,979,380,981,433,977,433,982,380,986,322,984,263,973,208,951,185,935,165,915,131,870,107,824,91,784"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="228,396,368,437"/>
<area shape="poly" title=" " alt="" coords="86,726,98,669,120,595,156,517,180,480,208,448,213,443,217,447,212,452,184,483,160,519,125,597,103,670,91,727"/>
<area shape="rect" href="group__state__structure__mod.html#ga9785cd791c2c595b03f4d91943b8160a" title="Return the number of unique dimensions." alt="" coords="210,485,386,526"/>
<area shape="poly" title=" " alt="" coords="91,726,108,684,132,633,166,581,208,536,212,532,215,537,211,540,170,584,137,636,112,686,96,728"/>
<area shape="rect" href="group__state__structure__mod.html#ga68f57b50ab4c6a2e004bb260ed3304e5" title="Return the unique dimension lengths." alt="" coords="228,574,368,630"/>
<area shape="poly" title=" " alt="" coords="109,725,154,682,208,639,215,635,218,640,211,644,157,686,113,729"/>
<area shape="rect" href="group__state__structure__mod.html#gada93d6e8d8cfe4b22c20d5710d451f90" title="Return the unique dimension names." alt="" coords="210,677,386,718"/>
<area shape="poly" title=" " alt="" coords="161,732,204,720,205,725,163,737"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="455,444,595,485"/>
<area shape="poly" title=" " alt="" coords="87,726,103,640,129,529,146,473,165,424,185,384,208,358,231,344,253,335,273,331,294,331,337,341,387,358,418,372,448,390,495,430,492,435,444,395,416,376,385,363,335,346,293,336,274,336,254,340,234,348,211,362,190,387,169,426,151,475,134,530,108,642,92,727"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="222,816,374,857"/>
<area shape="poly" title=" " alt="" coords="160,781,229,808,227,813,158,786"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="455,652,595,693"/>
<area shape="poly" title=" " alt="" coords="162,752,269,746,328,738,385,727,428,714,468,697,470,702,430,719,387,732,329,744,269,751,162,758"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="455,1032,595,1073"/>
<area shape="poly" title=" " alt="" coords="94,782,108,828,132,884,166,940,187,965,211,986,265,1017,324,1036,384,1047,439,1051,439,1057,384,1052,323,1041,263,1021,208,991,183,968,161,943,127,886,103,830,89,784"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="681,1973,818,2014"/>
<area shape="poly" title=" " alt="" coords="92,783,105,838,128,910,163,986,185,1021,212,1053,239,1079,264,1098,312,1123,367,1139,435,1162,463,1170,488,1173,533,1175,554,1177,575,1183,596,1194,617,1213,636,1239,652,1272,680,1358,703,1462,720,1576,741,1799,750,1958,744,1958,736,1799,714,1577,697,1463,675,1360,647,1274,631,1242,613,1217,593,1198,573,1188,553,1182,533,1180,487,1179,461,1175,433,1167,365,1145,310,1128,261,1103,235,1083,208,1057,181,1024,158,988,123,912,100,840,87,784"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga9b4b6fd124b574282fccbff0d7c07437" title="Write global clamping attributes to files that already exist." alt="" coords="215,1628,381,1669"/>
<area shape="poly" title=" " alt="" coords="88,783,93,951,111,1199,127,1328,148,1447,176,1546,193,1584,212,1613,214,1616,210,1619,208,1617,188,1587,171,1548,143,1448,122,1329,106,1200,88,951,83,784"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga14f0ad63f26920f56019fe2036506b71" title="Write global clamping attributes for variables that have clamping." alt="" coords="230,881,366,936"/>
<area shape="poly" title=" " alt="" coords="113,781,157,824,211,866,218,870,215,875,208,871,154,828,109,785"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaf8d438fbf74476572922b31434f3f2e9" title="Write revision information." alt="" coords="223,2060,373,2101"/>
<area shape="poly" title=" " alt="" coords="90,783,103,930,127,1167,164,1452,212,1745,251,1913,288,2044,283,2046,246,1915,207,1746,159,1453,122,1167,97,931,84,783"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="228,1693,368,1734"/>
<area shape="poly" title=" " alt="" coords="88,783,91,962,97,1090,108,1230,123,1370,145,1498,174,1605,192,1647,212,1679,217,1684,213,1688,208,1682,187,1649,169,1607,140,1500,118,1370,102,1230,92,1091,86,962,82,783"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="217,1563,379,1603"/>
<area shape="poly" title=" " alt="" coords="95,782,290,1547,285,1548,89,784"/>
<area shape="poly" title=" " alt="" coords="257,29,255,19,262,10,276,5,298,3,321,5,335,11,333,16,320,10,298,8,277,10,265,15,260,20,262,28"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1075,379,1202,419"/>
<area shape="poly" title=" " alt="" coords="1012,441,1064,422,1066,427,1014,446"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1075,444,1202,485"/>
<area shape="poly" title=" " alt="" coords="1018,462,1060,462,1060,467,1018,467"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1072,509,1205,535"/>
<area shape="poly" title=" " alt="" coords="1019,482,1081,501,1080,506,1018,487"/>
<area shape="poly" title=" " alt="" coords="257,168,255,158,262,149,276,143,298,141,321,144,335,150,333,155,320,149,298,147,277,149,265,153,260,159,262,167"/>
<area shape="poly" title=" " alt="" coords="257,257,255,247,262,238,276,233,298,231,321,233,335,239,333,244,320,238,298,236,277,238,265,243,260,248,262,256"/>
<area shape="poly" title=" " alt="" coords="482,943,480,933,487,924,502,918,525,916,549,918,563,925,561,930,548,924,525,921,503,923,490,928,485,934,487,941"/>
<area shape="poly" title=" " alt="" coords="257,396,255,386,262,377,276,371,298,369,321,372,335,378,333,383,320,377,298,375,277,377,265,381,260,387,262,395"/>
<area shape="poly" title=" " alt="" coords="257,485,255,475,262,466,276,461,298,459,321,461,335,467,333,472,320,466,298,464,277,466,265,471,260,476,262,484"/>
<area shape="poly" title=" " alt="" coords="256,573,256,563,264,555,278,549,298,547,320,550,334,557,332,561,319,555,298,552,279,554,267,559,261,565,261,574"/>
<area shape="poly" title=" " alt="" coords="257,677,255,667,262,658,276,653,298,651,321,653,335,659,333,664,320,658,298,656,277,658,265,663,260,668,262,676"/>
<area shape="poly" title=" " alt="" coords="482,444,480,434,487,425,502,419,525,417,549,420,563,426,561,431,548,425,525,423,503,425,490,429,485,435,487,443"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="679,444,820,485"/>
<area shape="poly" title=" " alt="" coords="595,462,663,462,663,467,595,467"/>
<area shape="poly" title=" " alt="" coords="820,462,874,462,874,467,820,467"/>
<area shape="poly" title=" " alt="" coords="257,816,255,806,262,797,276,791,298,789,321,792,335,798,333,803,320,797,298,795,277,797,265,801,260,807,262,815"/>
<area shape="poly" title=" " alt="" coords="482,652,480,642,487,633,502,627,525,625,549,628,563,634,561,639,548,633,525,631,503,633,490,637,485,643,487,651"/>
<area shape="poly" title=" " alt="" coords="482,1032,480,1022,487,1013,502,1007,525,1005,549,1008,563,1014,561,1019,548,1013,525,1011,503,1013,490,1017,485,1023,487,1031"/>
<area shape="poly" title=" " alt="" coords="751,1973,945,500,950,500,756,1974"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="884,1973,1024,2014"/>
<area shape="poly" title=" " alt="" coords="819,1991,868,1991,868,1996,819,1996"/>
<area shape="poly" title=" " alt="" coords="375,1667,388,1680,401,1703,409,1732,416,1804,413,1888,406,1978,400,2068,400,2150,403,2185,410,2216,421,2242,436,2261,457,2278,479,2290,500,2296,521,2297,543,2294,565,2286,614,2261,642,2239,667,2212,687,2181,704,2148,727,2083,740,2029,745,2030,732,2085,708,2151,692,2184,671,2215,646,2243,617,2265,567,2291,544,2299,521,2302,499,2301,477,2294,455,2283,432,2265,416,2244,405,2218,398,2186,395,2150,395,2068,401,1978,408,1888,410,1804,404,1733,396,1705,384,1683,371,1671"/>
<area shape="poly" title=" " alt="" coords="365,884,384,867,404,835,415,805,419,777,419,749,417,688,421,654,432,615,463,551,497,496,501,499,467,553,436,617,426,655,422,688,424,749,424,777,420,807,409,837,388,870,368,888"/>
<area shape="poly" title=" " alt="" coords="365,883,384,867,397,847,404,828,407,789,410,750,418,730,432,709,443,699,446,703,436,713,422,732,415,751,412,790,410,829,402,849,388,870,368,887"/>
<area shape="poly" title=" " alt="" coords="366,882,425,869,492,863,526,866,559,873,589,886,617,905,626,922,634,954,653,1060,692,1377,727,1721,748,1958,742,1958,721,1721,687,1377,648,1061,629,955,621,924,613,909,587,890,557,878,525,871,492,869,426,874,367,887"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="679,1077,820,1118"/>
<area shape="poly" title=" " alt="" coords="366,878,433,860,486,848,530,838,550,836,571,839,593,846,617,861,634,877,644,894,650,930,651,969,656,990,666,1011,687,1040,712,1065,708,1068,683,1043,661,1014,651,991,646,970,644,931,639,896,630,880,614,865,591,851,570,844,550,841,530,843,487,853,435,866,367,884"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="663,817,836,858"/>
<area shape="poly" title=" " alt="" coords="365,881,384,866,394,853,400,839,405,811,411,784,419,771,433,759,467,744,504,737,542,739,579,747,650,774,708,806,705,811,648,779,578,752,541,744,504,743,469,749,435,764,423,775,416,786,410,812,405,841,399,856,388,870,368,886"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="665,960,834,1001"/>
<area shape="poly" title=" " alt="" coords="365,879,384,866,398,852,406,837,416,822,433,810,482,791,525,784,567,790,617,810,725,946,721,949,614,814,566,795,525,789,484,796,435,815,420,826,411,839,403,855,388,870,368,883"/>
<area shape="poly" title=" " alt="" coords="711,1077,709,1067,715,1058,729,1053,750,1051,772,1053,785,1059,783,1064,770,1058,749,1056,730,1058,718,1063,714,1068,716,1076"/>
<area shape="poly" title=" " alt="" coords="711,817,709,807,715,798,729,793,750,791,772,793,785,799,783,804,770,798,749,796,730,798,718,803,714,808,716,816"/>
<area shape="poly" title=" " alt="" coords="711,960,709,950,715,941,729,935,750,933,772,936,785,942,783,947,770,941,749,939,730,941,718,945,714,951,716,959"/>
<area shape="poly" title=" " alt="" coords="307,2100,321,2146,346,2204,363,2233,384,2261,408,2285,435,2305,483,2328,526,2336,546,2334,568,2329,614,2305,646,2278,672,2245,694,2208,711,2169,733,2092,743,2029,748,2030,738,2093,716,2171,699,2211,677,2248,650,2282,617,2309,569,2334,547,2340,526,2341,482,2333,433,2309,404,2289,380,2264,359,2236,341,2206,316,2148,302,2102"/>
<area shape="poly" title=" " alt="" coords="299,1562,313,1447,340,1277,358,1189,379,1108,404,1041,432,995,435,991,439,995,436,998,409,1043,385,1110,363,1190,345,1278,318,1447,304,1563"/>
<area shape="poly" title=" " alt="" coords="296,1562,298,1476,303,1416,313,1348,330,1278,354,1208,388,1142,432,1083,440,1075,443,1079,436,1086,392,1144,359,1210,335,1280,319,1349,308,1416,303,1476,301,1562"/>
<area shape="poly" title=" " alt="" coords="375,1602,388,1615,400,1636,408,1663,414,1728,412,1805,407,1888,402,1970,402,2045,412,2106,422,2129,436,2146,457,2163,478,2173,499,2178,519,2179,564,2168,614,2146,651,2122,683,2091,709,2057,729,2026,733,2029,714,2060,687,2094,655,2126,617,2151,565,2173,520,2184,498,2184,476,2179,454,2168,432,2150,418,2132,407,2107,397,2045,397,1970,401,1888,407,1805,409,1728,402,1664,395,1638,384,1618,371,1606"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="444,1787,606,1827"/>
<area shape="poly" title=" " alt="" coords="371,1602,388,1614,401,1632,409,1648,414,1681,419,1714,425,1730,436,1748,468,1776,464,1780,432,1751,420,1733,414,1715,409,1682,404,1650,397,1634,384,1618,368,1606"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="455,1876,595,1917"/>
<area shape="poly" title=" " alt="" coords="373,1602,388,1615,407,1643,416,1671,418,1699,416,1725,414,1780,421,1808,436,1837,449,1853,465,1865,462,1869,446,1856,432,1841,416,1810,409,1780,410,1725,412,1699,411,1672,402,1646,384,1618,370,1606"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="455,2096,595,2137"/>
<area shape="poly" title=" " alt="" coords="375,1602,388,1615,408,1644,421,1673,429,1700,432,1728,429,1781,419,1834,408,1887,402,1941,404,1969,410,1997,420,2027,436,2058,448,2073,464,2085,460,2090,445,2076,432,2060,415,2029,404,1999,399,1969,397,1941,402,1886,414,1833,424,1781,427,1728,424,1702,416,1674,403,1647,384,1618,371,1606"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="442,1251,607,1291"/>
<area shape="poly" title=" " alt="" coords="301,1562,315,1510,340,1441,379,1367,404,1333,432,1302,437,1298,441,1302,436,1306,408,1336,383,1370,345,1443,320,1512,306,1563"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="455,1340,595,1381"/>
<area shape="poly" title=" " alt="" coords="306,1561,325,1525,353,1480,389,1433,432,1392,440,1386,443,1391,436,1396,393,1436,358,1483,330,1528,311,1563"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="455,1429,595,1470"/>
<area shape="poly" title=" " alt="" coords="321,1560,371,1521,433,1481,445,1474,448,1479,435,1485,374,1525,324,1564"/>
<area shape="rect" href="group__state__structure__mod.html#ga66d88ca7f0eeb73d74f5be11ce71da9b" title="Return short_name of a variable if it exist." alt="" coords="455,1519,595,1559"/>
<area shape="poly" title=" " alt="" coords="379,1565,439,1553,440,1558,380,1570"/>
<area shape="rect" href="group__state__structure__mod.html#ga4025efcde2bd8bc702bb10b26b393075" title="Return units of a variable if it exist." alt="" coords="455,1608,595,1649"/>
<area shape="poly" title=" " alt="" coords="380,1597,440,1609,439,1614,379,1602"/>
<area shape="rect" href="group__io__filenames__mod.html#ga34c52d7cbf0e9288483454380aedafe8" title="Determine whether a copy could potentially have units. Copies such as Spread and Inflation never have..." alt="" coords="440,1697,609,1738"/>
<area shape="poly" title=" " alt="" coords="363,1602,387,1614,412,1635,436,1658,476,1687,473,1691,432,1662,409,1639,385,1619,361,1606"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="434,2211,615,2251"/>
<area shape="poly" title=" " alt="" coords="375,1602,388,1615,401,1638,410,1666,418,1735,418,1816,413,1904,409,1991,408,2073,416,2141,424,2169,436,2191,444,2199,440,2203,432,2194,419,2171,411,2142,403,2073,404,1991,408,1904,413,1816,413,1735,405,1667,396,1640,384,1618,371,1606"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga97512c742d614257d5013e176e85a3a9" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="436,1941,614,1982"/>
<area shape="poly" title=" " alt="" coords="374,1602,388,1615,412,1656,421,1696,419,1735,412,1773,406,1811,404,1849,413,1887,436,1927,438,1929,434,1933,432,1930,408,1889,399,1849,400,1810,407,1772,414,1734,416,1696,407,1658,384,1618,371,1606"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad501af477a3530059fd8cac992d89632" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="436,2007,614,2047"/>
<area shape="poly" title=" " alt="" coords="374,1602,388,1615,405,1640,416,1664,423,1689,425,1713,422,1760,412,1806,403,1851,400,1897,402,1921,409,1944,420,1968,436,1992,438,1995,434,1998,432,1995,415,1970,404,1946,397,1922,394,1898,398,1851,407,1805,417,1759,420,1713,418,1690,411,1666,400,1642,384,1618,371,1606"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga09f849b5b89663f36e43ba4058555515" title="Write clamping to variable attributes to files created from scratch." alt="" coords="453,1097,597,1152"/>
<area shape="poly" title=" " alt="" coords="301,1561,316,1499,343,1411,381,1311,405,1261,432,1214,453,1186,476,1161,480,1165,457,1189,436,1216,409,1263,386,1313,348,1412,321,1501,306,1563"/>
<area shape="poly" title=" " alt="" coords="482,1787,480,1777,487,1768,502,1762,525,1760,549,1762,563,1769,561,1774,548,1768,525,1765,503,1767,490,1772,485,1778,487,1785"/>
<area shape="poly" title=" " alt="" coords="482,1876,480,1866,487,1857,502,1851,525,1849,549,1852,563,1858,561,1863,548,1857,525,1855,503,1857,490,1861,485,1867,487,1875"/>
<area shape="poly" title=" " alt="" coords="482,2096,480,2086,487,2077,502,2071,525,2069,549,2072,563,2078,561,2083,548,2077,525,2075,503,2077,490,2081,485,2087,487,2095"/>
<area shape="poly" title=" " alt="" coords="482,1251,480,1241,487,1232,502,1226,525,1224,549,1226,563,1233,561,1238,548,1232,525,1229,503,1231,490,1236,485,1242,487,1249"/>
<area shape="poly" title=" " alt="" coords="482,1340,480,1330,487,1321,502,1315,525,1313,549,1316,563,1322,561,1327,548,1321,525,1319,503,1321,490,1325,485,1331,487,1339"/>
<area shape="poly" title=" " alt="" coords="482,1429,480,1419,487,1410,502,1405,525,1403,549,1405,563,1411,561,1416,548,1410,525,1408,503,1410,490,1415,485,1421,487,1428"/>
<area shape="poly" title=" " alt="" coords="482,1519,480,1509,487,1500,502,1494,525,1492,549,1494,563,1501,561,1506,548,1500,525,1497,503,1499,490,1504,485,1510,487,1517"/>
<area shape="poly" title=" " alt="" coords="482,1608,480,1598,487,1589,502,1583,525,1581,549,1584,563,1590,561,1595,548,1589,525,1587,503,1589,490,1593,485,1599,487,1607"/>
<area shape="poly" title=" " alt="" coords="482,1697,480,1687,487,1678,502,1673,525,1671,549,1673,563,1679,561,1684,548,1678,525,1676,503,1678,490,1683,485,1689,487,1696"/>
<area shape="poly" title=" " alt="" coords="586,2208,614,2190,652,2152,685,2108,731,2027,735,2029,689,2111,656,2155,617,2194,589,2212"/>
<area shape="poly" title=" " alt="" coords="615,1972,666,1979,665,1984,614,1977"/>
<area shape="poly" title=" " alt="" coords="614,2011,665,2003,666,2009,615,2016"/>
<area shape="poly" title=" " alt="" coords="598,1151,617,1169,634,1198,650,1235,677,1328,699,1439,716,1560,739,1794,749,1958,744,1958,734,1794,711,1561,693,1440,672,1329,645,1237,630,1201,613,1173,595,1154"/>
<area shape="poly" title=" " alt="" coords="597,1113,663,1105,664,1110,597,1118"/>
<area shape="poly" title=" " alt="" coords="596,1098,613,1083,628,1063,636,1044,641,1007,644,968,650,946,661,923,683,893,709,867,713,870,687,896,666,926,655,948,649,969,646,1008,641,1046,632,1065,617,1086,599,1102"/>
<area shape="poly" title=" " alt="" coords="594,1094,614,1082,638,1062,662,1040,704,1008,707,1012,665,1044,642,1066,617,1087,596,1098"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_icgraph" id="agroup__direct__netcdf__mod_ga30e5e10d0b1bbc7e42a16ee50f75906f_icgraph">
<area shape="rect" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1400,280,1556,335"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,296,1349,291,1350,285,1385,291"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,324,1353,329,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga5da57561c4275530367b53a116303f9f" name="ga5da57561c4275530367b53a116303f9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5da57561c4275530367b53a116303f9f">&#9670;&#160;</a></span>finalize_single_file_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::finalize_single_file_io </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>file_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00445">445</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_cgraph" id="agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,95,150,135"/>
<area shape="rect" href="group__state__structure__mod.html#ga389fd43eca1eeec366e3f3870298e7a1" title="Clean up the diagnostic structure." alt="" coords="198,5,372,46"/>
<area shape="poly" title=" " alt="" coords="120,92,197,57,213,50,215,55,199,61,123,96"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="220,95,350,135"/>
<area shape="poly" title=" " alt="" coords="150,112,204,112,204,118,150,118"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="216,160,354,201"/>
<area shape="poly" title=" " alt="" coords="145,133,204,152,203,157,143,138"/>
<area shape="poly" title=" " alt="" coords="246,95,244,85,250,76,264,70,285,68,307,70,320,77,318,81,306,76,285,73,265,75,254,80,249,86,251,93"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="426,95,554,135"/>
<area shape="poly" title=" " alt="" coords="350,112,411,112,411,118,350,118"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="611,29,739,70"/>
<area shape="poly" title=" " alt="" coords="549,92,600,73,602,78,551,97"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="611,95,739,135"/>
<area shape="poly" title=" " alt="" coords="555,112,596,112,596,118,555,118"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="608,160,742,185"/>
<area shape="poly" title=" " alt="" coords="556,132,617,152,616,157,554,137"/>
<area shape="poly" title=" " alt="" coords="350,157,410,137,412,143,352,162"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="420,160,560,201"/>
<area shape="poly" title=" " alt="" coords="354,178,404,178,404,183,354,183"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_icgraph" id="agroup__direct__netcdf__mod_ga5da57561c4275530367b53a116303f9f_icgraph">
<area shape="rect" title=" " alt="" coords="379,47,523,88"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="364,48,310,34,312,29,365,43"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,55,306,80"/>
<area shape="poly" title=" " alt="" coords="364,70,306,70,306,65,364,65"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,80,137,106"/>
<area shape="poly" title=" " alt="" coords="364,91,331,95,229,101,137,99,137,94,229,95,331,90,363,85"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="195,79,138,87,137,81,194,73"/>
</map>
</div>

</div>
</div>
<a id="ga806acc05ff4f8aaa9db2906f9df08c47" name="ga806acc05ff4f8aaa9db2906f9df08c47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga806acc05ff4f8aaa9db2906f9df08c47">&#9670;&#160;</a></span>find_start_point()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::find_start_point </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recv_pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find i, the start point in var_block for a given recv_pe This is assuming round robin. - will have to query the ensemble manager to find this for different disrtibutions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">recv_pe</td><td>the receiver </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">start_rank</td><td>the pe that owns the 1st element of the var_block </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l03044">3044</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_cgraph" id="agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_cgraph">
<area shape="rect" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="5,71,142,111"/>
<area shape="poly" title=" " alt="" coords="39,71,37,61,43,52,55,46,74,44,93,46,105,53,103,57,92,52,73,49,56,51,46,56,42,62,44,70"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="190,71,320,111"/>
<area shape="poly" title=" " alt="" coords="142,88,174,88,174,94,142,94"/>
<area shape="poly" title=" " alt="" coords="221,71,219,61,225,52,237,46,255,44,274,46,286,53,283,57,273,52,255,49,238,51,228,56,224,62,226,70"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="368,71,496,111"/>
<area shape="poly" title=" " alt="" coords="320,88,352,88,352,94,320,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="547,5,675,46"/>
<area shape="poly" title=" " alt="" coords="489,68,538,49,540,54,491,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="547,71,675,111"/>
<area shape="poly" title=" " alt="" coords="497,88,532,88,532,94,497,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="544,136,678,161"/>
<area shape="poly" title=" " alt="" coords="497,109,555,128,553,133,496,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_icgraph" id="agroup__direct__netcdf__mod_ga806acc05ff4f8aaa9db2906f9df08c47_icgraph">
<area shape="rect" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="1394,367,1530,408"/>
<area shape="poly" title=" " alt="" coords="1495,354,1483,348,1462,346,1442,348,1430,352,1426,358,1428,366,1423,367,1421,357,1427,348,1441,343,1462,341,1484,343,1498,349"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,367,1117,408"/>
<area shape="poly" title=" " alt="" coords="1378,390,1118,390,1118,385,1378,385"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1167,306,1344,347"/>
<area shape="poly" title=" " alt="" coords="1378,365,1326,350,1327,345,1380,360"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,429,1346,469"/>
<area shape="poly" title=" " alt="" coords="1380,415,1327,430,1326,425,1378,410"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,302,743,343"/>
<area shape="poly" title=" " alt="" coords="965,382,880,372,790,357,742,345,743,340,791,352,881,367,966,377"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,761,552,801"/>
<area shape="poly" title=" " alt="" coords="658,358,555,598,479,761,475,759,550,596,653,356"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,660,331,686"/>
<area shape="poly" title=" " alt="" coords="628,295,574,265,509,240,475,233,441,232,410,239,381,255,372,272,358,313,323,436,265,660,260,659,318,434,353,311,367,270,377,251,408,234,441,227,475,228,510,235,576,260,630,291"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,711,315,736"/>
<area shape="poly" title=" " alt="" coords="609,299,555,282,494,273,463,273,433,278,406,289,381,305,370,318,363,335,354,380,352,436,354,497,355,616,349,664,342,684,333,700,317,713,313,709,329,696,337,682,344,663,350,616,348,497,347,436,349,380,358,334,366,315,377,302,403,284,432,273,462,268,494,267,556,277,611,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,764,306,790"/>
<area shape="poly" title=" " alt="" coords="585,323,525,324,464,329,413,340,394,347,381,356,361,379,348,402,340,425,336,449,340,496,351,545,363,595,369,646,368,672,362,698,350,724,333,751,322,761,308,769,305,764,318,757,329,747,346,722,356,696,362,671,364,646,358,596,346,546,335,497,331,449,335,424,343,400,357,376,377,352,392,342,412,335,464,324,524,319,584,318"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,789,137,815"/>
<area shape="poly" title=" " alt="" coords="661,287,648,241,627,187,595,136,575,114,551,96,506,75,467,69,427,77,380,97,338,120,304,144,278,169,257,196,223,262,187,347,170,398,162,442,159,482,160,521,161,601,154,647,139,699,113,751,85,791,81,787,108,748,134,697,149,646,155,601,155,521,154,482,156,441,165,396,182,345,218,259,252,193,274,165,301,139,335,115,378,92,425,72,467,64,508,70,554,92,578,110,599,133,632,185,654,239,666,286"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,5,538,31"/>
<area shape="poly" title=" " alt="" coords="661,287,649,235,627,172,595,108,574,78,551,52,521,34,524,29,554,48,579,75,600,105,632,170,654,234,667,286"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,107,514,132"/>
<area shape="poly" title=" " alt="" coords="652,289,612,221,584,185,551,154,513,134,516,129,554,149,588,181,616,218,657,286"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,359,323,384"/>
<area shape="poly" title=" " alt="" coords="647,291,607,243,581,221,551,205,504,187,465,180,426,186,380,205,357,219,337,238,304,282,280,325,266,359,261,357,275,323,299,279,333,234,354,215,378,200,424,180,465,175,506,182,553,200,584,217,611,239,651,287"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,927,323,952"/>
<area shape="poly" title=" " alt="" coords="586,348,553,357,500,364,457,364,437,366,418,371,400,382,381,400,363,432,353,478,347,533,345,593,344,712,341,763,334,803,320,840,302,875,271,928,266,925,298,872,315,838,328,801,336,762,339,712,340,593,342,533,347,477,358,431,377,397,397,378,416,366,436,361,456,359,500,358,552,352,585,343"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,411,545,436"/>
<area shape="poly" title=" " alt="" coords="627,353,553,394,508,413,506,408,551,389,624,349"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,460,535,486"/>
<area shape="poly" title=" " alt="" coords="650,357,609,406,583,430,554,451,531,462,529,457,551,447,579,426,605,402,646,354"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,509,546,535"/>
<area shape="poly" title=" " alt="" coords="658,358,641,392,618,430,589,468,554,500,534,511,532,506,551,496,585,465,614,427,637,390,653,356"/>
<area shape="poly" title=" " alt="" coords="421,754,378,726,330,701,301,689,303,684,332,696,380,722,424,749"/>
<area shape="poly" title=" " alt="" coords="375,759,307,740,308,734,376,753"/>
<area shape="poly" title=" " alt="" coords="363,782,307,780,307,775,363,776"/>
<area shape="poly" title=" " alt="" coords="364,801,331,805,229,809,137,808,137,802,229,803,331,800,363,796"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,660,94,686"/>
<area shape="poly" title=" " alt="" coords="169,676,95,676,95,670,169,670"/>
<area shape="poly" title=" " alt="" coords="195,788,138,796,137,791,194,783"/>
<area shape="poly" title=" " alt="" coords="405,138,381,154,357,178,336,205,302,264,279,319,265,359,260,357,274,317,297,262,331,202,353,174,377,149,402,134"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,302,1117,343"/>
<area shape="poly" title=" " alt="" coords="1151,327,1118,326,1118,321,1152,321"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,302,933,343"/>
<area shape="poly" title=" " alt="" coords="966,325,933,325,933,320,966,320"/>
<area shape="poly" title=" " alt="" coords="775,325,743,325,743,320,775,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,487,1117,528"/>
<area shape="poly" title=" " alt="" coords="1168,476,1119,491,1117,486,1167,471"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,543,933,584"/>
<area shape="poly" title=" " alt="" coords="967,535,933,545,931,540,965,530"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,653,743,693"/>
<area shape="poly" title=" " alt="" coords="813,594,710,654,707,650,810,590"/>
<area shape="poly" title=" " alt="" coords="625,704,554,745,517,762,515,757,551,740,623,699"/>
<area shape="poly" title=" " alt="" coords="585,676,331,676,331,670,585,670"/>
<area shape="poly" title=" " alt="" coords="585,686,315,719,314,714,584,681"/>
<area shape="poly" title=" " alt="" coords="655,708,638,736,615,766,587,794,553,815,518,827,481,833,444,833,407,828,339,812,287,793,289,788,341,807,408,823,444,827,481,827,517,822,551,810,583,790,611,763,634,733,651,705"/>
<area shape="poly" title=" " alt="" coords="659,709,643,742,620,778,590,812,554,838,494,861,430,872,366,874,302,869,242,858,188,845,105,818,106,813,189,840,243,853,303,863,366,869,430,867,492,856,551,833,586,808,615,775,638,739,654,706"/>
<area shape="poly" title=" " alt="" coords="584,661,465,634,413,618,377,599,351,574,329,546,294,485,272,427,260,385,265,384,277,425,299,482,333,543,355,571,381,595,415,613,467,629,585,656"/>
<area shape="poly" title=" " alt="" coords="666,709,653,756,631,811,599,866,578,889,554,910,527,925,498,937,437,951,377,954,323,952,324,946,377,949,436,945,496,932,525,921,551,905,574,886,595,862,626,809,648,755,661,708"/>
<area shape="poly" title=" " alt="" coords="659,638,644,594,622,543,591,493,572,470,551,450,533,439,536,435,554,445,576,466,595,490,627,541,649,593,664,636"/>
<area shape="poly" title=" " alt="" coords="653,639,637,605,614,568,585,530,551,499,532,489,534,484,554,495,589,527,618,565,641,603,658,637"/>
<area shape="poly" title=" " alt="" coords="646,641,605,593,579,569,551,548,529,538,531,533,554,544,583,565,609,589,650,638"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,559,515,584"/>
<area shape="poly" title=" " alt="" coords="624,646,551,606,506,587,508,582,553,601,627,642"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,977,524,1003"/>
<area shape="poly" title=" " alt="" coords="667,709,655,763,634,830,601,899,580,931,554,960,524,979,521,975,551,956,575,928,597,897,629,828,650,762,662,708"/>
<area shape="poly" title=" " alt="" coords="400,562,377,550,335,510,302,463,277,419,262,386,267,384,282,417,306,461,339,506,381,545,403,557"/>
<area shape="poly" title=" " alt="" coords="394,976,313,956,314,950,396,970"/>
</map>
</div>

</div>
</div>
<a id="gac25ed7ba0ea54f5ac988274990c2f955" name="gac25ed7ba0ea54f5ac988274990c2f955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac25ed7ba0ea54f5ac988274990c2f955">&#9670;&#160;</a></span>get_dimension_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::get_dimension_info </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dom_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>var_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_extra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>numdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension  (nf90_max_var_dims), intent(out)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nf90_max_var_dims), intent(out)&#160;</td>
          <td class="paramname"><em>lengths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>helper function to return the netcdf dimension id's and lengths </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02540">2540</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_cgraph" id="agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_cgraph">
<area shape="rect" title="helper function to return the netcdf dimension id&#39;s and lengths" alt="" coords="5,119,142,159"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="190,29,330,70"/>
<area shape="poly" title=" " alt="" coords="116,116,189,81,200,75,203,80,191,85,119,121"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="190,119,330,159"/>
<area shape="poly" title=" " alt="" coords="142,136,174,136,174,142,142,142"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="190,208,330,249"/>
<area shape="poly" title=" " alt="" coords="119,158,203,198,201,203,117,162"/>
<area shape="poly" title=" " alt="" coords="224,29,222,19,228,10,241,5,260,3,280,5,292,11,290,16,279,10,260,8,242,10,232,15,228,20,229,28"/>
<area shape="poly" title=" " alt="" coords="224,119,222,109,228,100,241,94,260,92,280,94,292,101,290,105,279,100,260,97,242,99,232,104,228,110,229,118"/>
<area shape="poly" title=" " alt="" coords="224,208,222,198,228,189,241,183,260,181,280,184,292,190,290,195,279,189,260,187,242,189,232,193,228,199,229,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_icgraph" id="agroup__direct__netcdf__mod_gac25ed7ba0ea54f5ac988274990c2f955_icgraph">
<area shape="rect" title="helper function to return the netcdf dimension id&#39;s and lengths" alt="" coords="975,287,1111,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="791,287,927,328"/>
<area shape="poly" title=" " alt="" coords="960,310,928,310,928,305,960,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga637259129bab7191a953fc685b83b23f" name="ga637259129bab7191a953fc685b83b23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga637259129bab7191a953fc685b83b23f">&#9670;&#160;</a></span>get_pe_loops()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::get_pe_loops </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ens_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>recv_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>recv_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>send_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>send_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy tasks will send, everyone will receive. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">recv_start</td><td>for RECIEVING_PE_LOOP </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">recv_end</td><td>for RECIEVING_PE_LOOP </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">send_start</td><td>for RECEIVE_FROM_EACH_LOOP </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">send_end</td><td>for RECEIVE_FROM_EACH_LOOP </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02060">2060</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_cgraph" id="agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_cgraph">
<area shape="rect" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="5,71,142,111"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="190,71,320,111"/>
<area shape="poly" title=" " alt="" coords="142,88,174,88,174,94,142,94"/>
<area shape="poly" title=" " alt="" coords="221,71,219,61,225,52,237,46,255,44,274,46,286,53,283,57,273,52,255,49,238,51,228,56,224,62,226,70"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="368,71,496,111"/>
<area shape="poly" title=" " alt="" coords="320,88,352,88,352,94,320,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="547,5,675,46"/>
<area shape="poly" title=" " alt="" coords="489,68,538,49,540,54,491,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="547,71,675,111"/>
<area shape="poly" title=" " alt="" coords="497,88,532,88,532,94,497,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="544,136,678,161"/>
<area shape="poly" title=" " alt="" coords="497,109,555,128,553,133,496,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_icgraph" id="agroup__direct__netcdf__mod_ga637259129bab7191a953fc685b83b23f_icgraph">
<area shape="rect" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="1394,367,1530,408"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,367,1117,408"/>
<area shape="poly" title=" " alt="" coords="1378,390,1118,390,1118,385,1378,385"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1167,306,1344,347"/>
<area shape="poly" title=" " alt="" coords="1378,365,1326,350,1327,345,1380,360"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,429,1346,469"/>
<area shape="poly" title=" " alt="" coords="1380,415,1327,430,1326,425,1378,410"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,302,743,343"/>
<area shape="poly" title=" " alt="" coords="965,382,880,372,790,357,742,345,743,340,791,352,881,367,966,377"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,761,552,801"/>
<area shape="poly" title=" " alt="" coords="658,358,555,598,479,761,475,759,550,596,653,356"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,660,331,686"/>
<area shape="poly" title=" " alt="" coords="628,295,574,265,509,240,475,233,441,232,410,239,381,255,372,272,358,313,323,436,265,660,260,659,318,434,353,311,367,270,377,251,408,234,441,227,475,228,510,235,576,260,630,291"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,711,315,736"/>
<area shape="poly" title=" " alt="" coords="609,299,555,282,494,273,463,273,433,278,406,289,381,305,370,318,363,335,354,380,352,436,354,497,355,616,349,664,342,684,333,700,317,713,313,709,329,696,337,682,344,663,350,616,348,497,347,436,349,380,358,334,366,315,377,302,403,284,432,273,462,268,494,267,556,277,611,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,764,306,790"/>
<area shape="poly" title=" " alt="" coords="585,323,525,324,464,329,413,340,394,347,381,356,361,379,348,402,340,425,336,449,340,496,351,545,363,595,369,646,368,672,362,698,350,724,333,751,322,761,308,769,305,764,318,757,329,747,346,722,356,696,362,671,364,646,358,596,346,546,335,497,331,449,335,424,343,400,357,376,377,352,392,342,412,335,464,324,524,319,584,318"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,789,137,815"/>
<area shape="poly" title=" " alt="" coords="661,287,648,241,627,187,595,136,575,114,551,96,506,75,467,69,427,77,380,97,338,120,304,144,278,169,257,196,223,262,187,347,170,398,162,442,159,482,160,521,161,601,154,647,139,699,113,751,85,791,81,787,108,748,134,697,149,646,155,601,155,521,154,482,156,441,165,396,182,345,218,259,252,193,274,165,301,139,335,115,378,92,425,72,467,64,508,70,554,92,578,110,599,133,632,185,654,239,666,286"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,5,538,31"/>
<area shape="poly" title=" " alt="" coords="661,287,649,235,627,172,595,108,574,78,551,52,521,34,524,29,554,48,579,75,600,105,632,170,654,234,667,286"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,107,514,132"/>
<area shape="poly" title=" " alt="" coords="652,289,612,221,584,185,551,154,513,134,516,129,554,149,588,181,616,218,657,286"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,359,323,384"/>
<area shape="poly" title=" " alt="" coords="647,291,607,243,581,221,551,205,504,187,465,180,426,186,380,205,357,219,337,238,304,282,280,325,266,359,261,357,275,323,299,279,333,234,354,215,378,200,424,180,465,175,506,182,553,200,584,217,611,239,651,287"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,927,323,952"/>
<area shape="poly" title=" " alt="" coords="586,348,553,357,500,364,457,364,437,366,418,371,400,382,381,400,363,432,353,478,347,533,345,593,344,712,341,763,334,803,320,840,302,875,271,928,266,925,298,872,315,838,328,801,336,762,339,712,340,593,342,533,347,477,358,431,377,397,397,378,416,366,436,361,456,359,500,358,552,352,585,343"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,411,545,436"/>
<area shape="poly" title=" " alt="" coords="627,353,553,394,508,413,506,408,551,389,624,349"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,460,535,486"/>
<area shape="poly" title=" " alt="" coords="650,357,609,406,583,430,554,451,531,462,529,457,551,447,579,426,605,402,646,354"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,509,546,535"/>
<area shape="poly" title=" " alt="" coords="658,358,641,392,618,430,589,468,554,500,534,511,532,506,551,496,585,465,614,427,637,390,653,356"/>
<area shape="poly" title=" " alt="" coords="421,754,378,726,330,701,301,689,303,684,332,696,380,722,424,749"/>
<area shape="poly" title=" " alt="" coords="375,759,307,740,308,734,376,753"/>
<area shape="poly" title=" " alt="" coords="363,782,307,780,307,775,363,776"/>
<area shape="poly" title=" " alt="" coords="364,801,331,805,229,809,137,808,137,802,229,803,331,800,363,796"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,660,94,686"/>
<area shape="poly" title=" " alt="" coords="169,676,95,676,95,670,169,670"/>
<area shape="poly" title=" " alt="" coords="195,788,138,796,137,791,194,783"/>
<area shape="poly" title=" " alt="" coords="405,138,381,154,357,178,336,205,302,264,279,319,265,359,260,357,274,317,297,262,331,202,353,174,377,149,402,134"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,302,1117,343"/>
<area shape="poly" title=" " alt="" coords="1151,327,1118,326,1118,321,1152,321"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,302,933,343"/>
<area shape="poly" title=" " alt="" coords="966,325,933,325,933,320,966,320"/>
<area shape="poly" title=" " alt="" coords="775,325,743,325,743,320,775,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,487,1117,528"/>
<area shape="poly" title=" " alt="" coords="1168,476,1119,491,1117,486,1167,471"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,543,933,584"/>
<area shape="poly" title=" " alt="" coords="967,535,933,545,931,540,965,530"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,653,743,693"/>
<area shape="poly" title=" " alt="" coords="813,594,710,654,707,650,810,590"/>
<area shape="poly" title=" " alt="" coords="625,704,554,745,517,762,515,757,551,740,623,699"/>
<area shape="poly" title=" " alt="" coords="585,676,331,676,331,670,585,670"/>
<area shape="poly" title=" " alt="" coords="585,686,315,719,314,714,584,681"/>
<area shape="poly" title=" " alt="" coords="655,708,638,736,615,766,587,794,553,815,518,827,481,833,444,833,407,828,339,812,287,793,289,788,341,807,408,823,444,827,481,827,517,822,551,810,583,790,611,763,634,733,651,705"/>
<area shape="poly" title=" " alt="" coords="659,709,643,742,620,778,590,812,554,838,494,861,430,872,366,874,302,869,242,858,188,845,105,818,106,813,189,840,243,853,303,863,366,869,430,867,492,856,551,833,586,808,615,775,638,739,654,706"/>
<area shape="poly" title=" " alt="" coords="584,661,465,634,413,618,377,599,351,574,329,546,294,485,272,427,260,385,265,384,277,425,299,482,333,543,355,571,381,595,415,613,467,629,585,656"/>
<area shape="poly" title=" " alt="" coords="666,709,653,756,631,811,599,866,578,889,554,910,527,925,498,937,437,951,377,954,323,952,324,946,377,949,436,945,496,932,525,921,551,905,574,886,595,862,626,809,648,755,661,708"/>
<area shape="poly" title=" " alt="" coords="659,638,644,594,622,543,591,493,572,470,551,450,533,439,536,435,554,445,576,466,595,490,627,541,649,593,664,636"/>
<area shape="poly" title=" " alt="" coords="653,639,637,605,614,568,585,530,551,499,532,489,534,484,554,495,589,527,618,565,641,603,658,637"/>
<area shape="poly" title=" " alt="" coords="646,641,605,593,579,569,551,548,529,538,531,533,554,544,583,565,609,589,650,638"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,559,515,584"/>
<area shape="poly" title=" " alt="" coords="624,646,551,606,506,587,508,582,553,601,627,642"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,977,524,1003"/>
<area shape="poly" title=" " alt="" coords="667,709,655,763,634,830,601,899,580,931,554,960,524,979,521,975,551,956,575,928,597,897,629,828,650,762,662,708"/>
<area shape="poly" title=" " alt="" coords="400,562,377,550,335,510,302,463,277,419,262,386,267,384,282,417,306,461,339,506,381,545,403,557"/>
<area shape="poly" title=" " alt="" coords="394,976,313,956,314,950,396,970"/>
</map>
</div>

</div>
</div>
<a id="gac406bea6ff4528072fe75da92c522693" name="gac406bea6ff4528072fe75da92c522693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac406bea6ff4528072fe75da92c522693">&#9670;&#160;</a></span>get_start_rank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::get_start_rank </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>variable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Give the rank of the processor that owns the start of a variable. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l03027">3027</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_cgraph" id="agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_cgraph">
<area shape="rect" title="Give the rank of the processor that owns the start of a variable." alt="" coords="5,75,142,115"/>
<area shape="poly" title=" " alt="" coords="34,75,33,65,39,56,53,50,74,48,96,50,109,57,107,61,94,56,73,53,54,55,42,60,38,66,40,73"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="190,29,369,70"/>
<area shape="poly" title=" " alt="" coords="141,77,174,70,175,75,143,83"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="214,119,345,159"/>
<area shape="poly" title=" " alt="" coords="142,107,199,119,198,124,141,112"/>
<area shape="poly" title=" " alt="" coords="241,29,239,19,245,10,259,5,279,3,301,5,314,11,312,16,300,10,279,8,260,10,249,15,244,20,246,28"/>
<area shape="poly" title=" " alt="" coords="241,119,239,109,245,100,259,94,279,92,301,94,314,101,312,105,300,100,279,97,260,99,249,104,244,110,246,117"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="417,119,545,159"/>
<area shape="poly" title=" " alt="" coords="345,136,402,136,402,142,345,142"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="596,53,724,94"/>
<area shape="poly" title=" " alt="" coords="538,116,587,97,589,102,540,121"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="596,119,724,159"/>
<area shape="poly" title=" " alt="" coords="546,136,581,136,581,142,546,142"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="593,184,727,209"/>
<area shape="poly" title=" " alt="" coords="546,157,604,176,602,181,545,162"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_icgraph" id="agroup__direct__netcdf__mod_gac406bea6ff4528072fe75da92c522693_icgraph">
<area shape="rect" title="Give the rank of the processor that owns the start of a variable." alt="" coords="1394,367,1530,408"/>
<area shape="poly" title=" " alt="" coords="1495,354,1483,348,1462,346,1442,348,1430,352,1426,358,1428,366,1423,367,1421,357,1427,348,1441,343,1462,341,1484,343,1498,349"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,367,1117,408"/>
<area shape="poly" title=" " alt="" coords="1378,390,1118,390,1118,385,1378,385"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1167,306,1344,347"/>
<area shape="poly" title=" " alt="" coords="1378,365,1326,350,1327,345,1380,360"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,429,1346,469"/>
<area shape="poly" title=" " alt="" coords="1380,415,1327,430,1326,425,1378,410"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,302,743,343"/>
<area shape="poly" title=" " alt="" coords="965,382,880,372,790,357,742,345,743,340,791,352,881,367,966,377"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,761,552,801"/>
<area shape="poly" title=" " alt="" coords="658,358,555,598,479,761,475,759,550,596,653,356"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,660,331,686"/>
<area shape="poly" title=" " alt="" coords="628,295,574,265,509,240,475,233,441,232,410,239,381,255,372,272,358,313,323,436,265,660,260,659,318,434,353,311,367,270,377,251,408,234,441,227,475,228,510,235,576,260,630,291"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,711,315,736"/>
<area shape="poly" title=" " alt="" coords="609,299,555,282,494,273,463,273,433,278,406,289,381,305,370,318,363,335,354,380,352,436,354,497,355,616,349,664,342,684,333,700,317,713,313,709,329,696,337,682,344,663,350,616,348,497,347,436,349,380,358,334,366,315,377,302,403,284,432,273,462,268,494,267,556,277,611,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,764,306,790"/>
<area shape="poly" title=" " alt="" coords="585,323,525,324,464,329,413,340,394,347,381,356,361,379,348,402,340,425,336,449,340,496,351,545,363,595,369,646,368,672,362,698,350,724,333,751,322,761,308,769,305,764,318,757,329,747,346,722,356,696,362,671,364,646,358,596,346,546,335,497,331,449,335,424,343,400,357,376,377,352,392,342,412,335,464,324,524,319,584,318"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,789,137,815"/>
<area shape="poly" title=" " alt="" coords="661,287,648,241,627,187,595,136,575,114,551,96,506,75,467,69,427,77,380,97,338,120,304,144,278,169,257,196,223,262,187,347,170,398,162,442,159,482,160,521,161,601,154,647,139,699,113,751,85,791,81,787,108,748,134,697,149,646,155,601,155,521,154,482,156,441,165,396,182,345,218,259,252,193,274,165,301,139,335,115,378,92,425,72,467,64,508,70,554,92,578,110,599,133,632,185,654,239,666,286"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,5,538,31"/>
<area shape="poly" title=" " alt="" coords="661,287,649,235,627,172,595,108,574,78,551,52,521,34,524,29,554,48,579,75,600,105,632,170,654,234,667,286"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,107,514,132"/>
<area shape="poly" title=" " alt="" coords="652,289,612,221,584,185,551,154,513,134,516,129,554,149,588,181,616,218,657,286"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,359,323,384"/>
<area shape="poly" title=" " alt="" coords="647,291,607,243,581,221,551,205,504,187,465,180,426,186,380,205,357,219,337,238,304,282,280,325,266,359,261,357,275,323,299,279,333,234,354,215,378,200,424,180,465,175,506,182,553,200,584,217,611,239,651,287"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,927,323,952"/>
<area shape="poly" title=" " alt="" coords="586,348,553,357,500,364,457,364,437,366,418,371,400,382,381,400,363,432,353,478,347,533,345,593,344,712,341,763,334,803,320,840,302,875,271,928,266,925,298,872,315,838,328,801,336,762,339,712,340,593,342,533,347,477,358,431,377,397,397,378,416,366,436,361,456,359,500,358,552,352,585,343"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,411,545,436"/>
<area shape="poly" title=" " alt="" coords="627,353,553,394,508,413,506,408,551,389,624,349"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,460,535,486"/>
<area shape="poly" title=" " alt="" coords="650,357,609,406,583,430,554,451,531,462,529,457,551,447,579,426,605,402,646,354"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,509,546,535"/>
<area shape="poly" title=" " alt="" coords="658,358,641,392,618,430,589,468,554,500,534,511,532,506,551,496,585,465,614,427,637,390,653,356"/>
<area shape="poly" title=" " alt="" coords="421,754,378,726,330,701,301,689,303,684,332,696,380,722,424,749"/>
<area shape="poly" title=" " alt="" coords="375,759,307,740,308,734,376,753"/>
<area shape="poly" title=" " alt="" coords="363,782,307,780,307,775,363,776"/>
<area shape="poly" title=" " alt="" coords="364,801,331,805,229,809,137,808,137,802,229,803,331,800,363,796"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,660,94,686"/>
<area shape="poly" title=" " alt="" coords="169,676,95,676,95,670,169,670"/>
<area shape="poly" title=" " alt="" coords="195,788,138,796,137,791,194,783"/>
<area shape="poly" title=" " alt="" coords="405,138,381,154,357,178,336,205,302,264,279,319,265,359,260,357,274,317,297,262,331,202,353,174,377,149,402,134"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,302,1117,343"/>
<area shape="poly" title=" " alt="" coords="1151,327,1118,326,1118,321,1152,321"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,302,933,343"/>
<area shape="poly" title=" " alt="" coords="966,325,933,325,933,320,966,320"/>
<area shape="poly" title=" " alt="" coords="775,325,743,325,743,320,775,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,487,1117,528"/>
<area shape="poly" title=" " alt="" coords="1168,476,1119,491,1117,486,1167,471"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,543,933,584"/>
<area shape="poly" title=" " alt="" coords="967,535,933,545,931,540,965,530"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,653,743,693"/>
<area shape="poly" title=" " alt="" coords="813,594,710,654,707,650,810,590"/>
<area shape="poly" title=" " alt="" coords="625,704,554,745,517,762,515,757,551,740,623,699"/>
<area shape="poly" title=" " alt="" coords="585,676,331,676,331,670,585,670"/>
<area shape="poly" title=" " alt="" coords="585,686,315,719,314,714,584,681"/>
<area shape="poly" title=" " alt="" coords="655,708,638,736,615,766,587,794,553,815,518,827,481,833,444,833,407,828,339,812,287,793,289,788,341,807,408,823,444,827,481,827,517,822,551,810,583,790,611,763,634,733,651,705"/>
<area shape="poly" title=" " alt="" coords="659,709,643,742,620,778,590,812,554,838,494,861,430,872,366,874,302,869,242,858,188,845,105,818,106,813,189,840,243,853,303,863,366,869,430,867,492,856,551,833,586,808,615,775,638,739,654,706"/>
<area shape="poly" title=" " alt="" coords="584,661,465,634,413,618,377,599,351,574,329,546,294,485,272,427,260,385,265,384,277,425,299,482,333,543,355,571,381,595,415,613,467,629,585,656"/>
<area shape="poly" title=" " alt="" coords="666,709,653,756,631,811,599,866,578,889,554,910,527,925,498,937,437,951,377,954,323,952,324,946,377,949,436,945,496,932,525,921,551,905,574,886,595,862,626,809,648,755,661,708"/>
<area shape="poly" title=" " alt="" coords="659,638,644,594,622,543,591,493,572,470,551,450,533,439,536,435,554,445,576,466,595,490,627,541,649,593,664,636"/>
<area shape="poly" title=" " alt="" coords="653,639,637,605,614,568,585,530,551,499,532,489,534,484,554,495,589,527,618,565,641,603,658,637"/>
<area shape="poly" title=" " alt="" coords="646,641,605,593,579,569,551,548,529,538,531,533,554,544,583,565,609,589,650,638"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,559,515,584"/>
<area shape="poly" title=" " alt="" coords="624,646,551,606,506,587,508,582,553,601,627,642"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,977,524,1003"/>
<area shape="poly" title=" " alt="" coords="667,709,655,763,634,830,601,899,580,931,554,960,524,979,521,975,551,956,575,928,597,897,629,828,650,762,662,708"/>
<area shape="poly" title=" " alt="" coords="400,562,377,550,335,510,302,463,277,419,262,386,267,384,282,417,306,461,339,506,381,545,403,557"/>
<area shape="poly" title=" " alt="" coords="394,976,313,956,314,950,396,970"/>
</map>
</div>

</div>
</div>
<a id="ga811379f67b7a78e7cbfab32f80b54b8c" name="ga811379f67b7a78e7cbfab32f80b54b8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga811379f67b7a78e7cbfab32f80b54b8c">&#9670;&#160;</a></span>initialize_single_file_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::initialize_single_file_io </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>file_handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a template file for single file io Calls the model for any model specific attributes to be written. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00215">215</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_cgraph" id="agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_cgraph">
<area shape="rect" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="5,838,156,879"/>
<area shape="rect" href="namespacempi__utilities__mod.html#a11898801659b52a8b452d89672fb7e8e" title="Broadcast logical." alt="" coords="1258,265,1389,305"/>
<area shape="poly" title=" " alt="" coords="81,837,89,775,104,684,130,575,168,460,192,403,220,349,253,300,290,256,331,220,378,192,429,174,487,168,927,168,974,170,1022,176,1116,199,1200,227,1267,255,1265,260,1198,232,1114,204,1021,182,974,175,927,173,487,173,431,179,380,197,334,224,293,260,257,303,225,352,197,405,173,461,135,576,110,685,94,776,86,838"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1446,590,1574,631"/>
<area shape="poly" title=" " alt="" coords="81,837,94,722,119,554,135,467,155,386,177,318,201,270,262,197,291,171,322,150,356,135,394,124,437,119,487,117,1128,117,1175,118,1215,123,1250,132,1282,146,1311,164,1340,187,1400,251,1428,290,1451,333,1469,377,1483,423,1501,508,1509,574,1504,575,1496,508,1478,424,1464,379,1446,335,1423,293,1396,255,1336,191,1308,168,1279,150,1248,137,1214,129,1174,124,1128,122,487,122,437,124,395,130,358,140,325,155,294,175,265,201,206,273,182,320,160,387,141,468,124,555,99,723,86,838"/>
<area shape="rect" href="namespaceutilities__mod.html#afdcde1c8f26a0500ee25850c24d09162" title="Reads a text file into a character variable. Initially needed to read a namelist file into a variable..." alt="" coords="222,555,341,596"/>
<area shape="poly" title=" " alt="" coords="94,836,255,607,259,610,99,839"/>
<area shape="rect" href="namespaceutilities__mod.html#ae943a84ea3b7e8579a41d1f744f4be7f" title="Determines the number of lines and maximum line length of an ascii file." alt="" coords="427,663,550,704"/>
<area shape="poly" title=" " alt="" coords="120,835,203,794,314,747,415,707,417,712,316,752,205,799,122,840"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="205,1471,358,1512"/>
<area shape="poly" title=" " alt="" coords="84,879,85,972,90,1039,99,1115,114,1196,136,1278,166,1358,206,1433,232,1460,228,1464,201,1436,161,1360,131,1280,109,1197,94,1116,85,1040,80,973,79,879"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="423,947,553,988"/>
<area shape="poly" title=" " alt="" coords="133,877,204,902,310,930,408,951,407,956,309,935,203,907,131,882"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="857,1005,994,1045"/>
<area shape="poly" title=" " alt="" coords="156,859,345,875,458,889,570,909,683,943,848,997,846,1002,682,948,569,914,457,894,344,880,156,864"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga31098fc0ee34f4559645cd5122edc81e" title="routine write calendar attributes" alt="" coords="204,809,359,849"/>
<area shape="poly" title=" " alt="" coords="156,845,188,840,189,845,157,850"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="208,1175,355,1216"/>
<area shape="poly" title=" " alt="" coords="96,877,262,1160,258,1163,92,880"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="205,1382,358,1423"/>
<area shape="poly" title=" " alt="" coords="90,878,136,1024,206,1227,266,1367,261,1369,201,1228,131,1026,85,880"/>
<area shape="poly" title=" " alt="" coords="1339,304,1492,575,1487,578,1334,307"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1625,618,1752,659"/>
<area shape="poly" title=" " alt="" coords="1575,618,1610,623,1609,628,1574,623"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1625,471,1752,512"/>
<area shape="poly" title=" " alt="" coords="1541,587,1643,518,1646,523,1544,591"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1622,568,1755,594"/>
<area shape="poly" title=" " alt="" coords="1574,597,1606,592,1607,597,1575,602"/>
<area shape="poly" title=" " alt="" coords="342,575,723,590,1249,605,1430,607,1430,612,1249,610,723,595,341,581"/>
<area shape="rect" href="namespaceutilities__mod.html#aaa23ed1a0469bb9addcd0de6c52645b8" title="Closes the given unit_number if that unit is open. Not an error to call on an already closed unit...." alt="" coords="847,664,1004,690"/>
<area shape="poly" title=" " alt="" coords="342,582,831,660,831,665,341,587"/>
<area shape="poly" title=" " alt="" coords="320,594,408,642,430,654,428,658,406,647,318,599"/>
<area shape="rect" href="namespaceutilities__mod.html#a77ad7301456803b1c560cd7c75a37549" title="open a file. assigns a unit number to be used for subsequent read/writes. can open an existing file,..." alt="" coords="631,396,785,422"/>
<area shape="poly" title=" " alt="" coords="315,552,357,528,406,504,529,457,640,424,641,429,531,462,408,509,360,532,317,557"/>
<area shape="rect" href="string_8f.html#aa3112b3661ec475fe7949d9ae5bafb40" title=" " alt="" coords="1100,56,1153,82"/>
<area shape="poly" title=" " alt="" coords="300,553,347,507,405,457,523,373,618,314,845,193,975,130,1084,83,1086,88,978,135,848,198,621,318,526,378,409,462,350,511,304,557"/>
<area shape="poly" title=" " alt="" coords="1004,674,1185,668,1291,658,1397,642,1435,633,1437,638,1398,647,1292,663,1185,673,1005,680"/>
<area shape="rect" href="namespaceutilities__mod.html#a3f63425c321a0636992b51e9c79fcac7" title=" " alt="" coords="1052,475,1201,516"/>
<area shape="poly" title=" " alt="" coords="939,662,1090,524,1094,528,943,666"/>
<area shape="poly" title=" " alt="" coords="1202,505,1297,525,1399,554,1458,580,1456,585,1397,559,1296,530,1201,510"/>
<area shape="rect" href="namespaceutilities__mod.html#a3903dfa8070eb2885c7f5805043e539b" title=" " alt="" coords="1249,461,1398,487"/>
<area shape="poly" title=" " alt="" coords="1202,485,1234,481,1234,486,1202,490"/>
<area shape="poly" title=" " alt="" coords="1363,485,1399,504,1444,539,1482,576,1478,580,1441,544,1396,508,1361,490"/>
<area shape="poly" title=" " alt="" coords="1398,475,1610,485,1609,490,1398,480"/>
<area shape="poly" title=" " alt="" coords="1292,462,1286,453,1290,443,1303,437,1324,435,1346,437,1358,444,1355,448,1344,442,1323,440,1304,442,1294,447,1291,452,1297,459"/>
<area shape="poly" title=" " alt="" coords="551,691,719,713,821,721,924,725,1128,725,1205,722,1265,713,1323,696,1397,669,1463,637,1465,641,1399,674,1325,701,1266,718,1206,727,1128,730,924,730,821,727,718,718,550,696"/>
<area shape="poly" title=" " alt="" coords="550,680,831,676,831,681,550,685"/>
<area shape="rect" href="namespaceutilities__mod.html#adc9c6ca8c4039bd52d9a72f806a9dcd2" title=" " alt="" coords="866,498,985,539"/>
<area shape="poly" title=" " alt="" coords="544,660,854,542,856,547,545,665"/>
<area shape="poly" title=" " alt="" coords="504,661,685,432,689,436,508,665"/>
<area shape="poly" title=" " alt="" coords="985,509,1036,503,1037,508,986,514"/>
<area shape="poly" title=" " alt="" coords="887,498,885,488,891,479,905,473,925,471,947,474,960,480,958,485,946,479,925,476,906,478,895,483,890,489,892,497"/>
<area shape="poly" title=" " alt="" coords="723,420,791,494,826,530,848,548,880,557,937,565,1097,581,1430,603,1430,609,1096,587,936,571,879,562,845,553,823,534,787,498,719,424"/>
<area shape="poly" title=" " alt="" coords="730,393,781,367,850,341,889,333,928,329,968,333,1005,345,1040,368,1070,398,1094,430,1111,460,1107,463,1089,433,1066,402,1037,372,1003,350,967,338,928,335,890,338,852,346,783,372,732,398"/>
<area shape="poly" title=" " alt="" coords="722,393,774,354,809,334,846,320,890,309,925,306,961,310,1005,320,1089,346,1169,381,1239,418,1291,450,1288,455,1236,423,1167,386,1087,351,1003,325,960,316,925,312,890,314,847,325,811,339,777,359,726,398"/>
<area shape="rect" href="namespaceutilities__mod.html#a2b089bab595179a60cb2e3d12db6e8ae" title="Useful for dumping all the attributes for a file &#39;unit&#39; A debugging routine. TJH Oct 2004." alt="" coords="858,359,993,400"/>
<area shape="poly" title=" " alt="" coords="785,396,842,388,843,393,786,401"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="897,424,954,450"/>
<area shape="poly" title=" " alt="" coords="786,416,882,429,881,434,785,421"/>
<area shape="rect" href="namespaceutilities__mod.html#a3cd818255d7f98765915ab676582b413" title="convert a string to upper case in place" alt="" coords="849,208,1002,234"/>
<area shape="poly" title=" " alt="" coords="716,394,765,327,803,287,845,251,867,238,869,243,848,255,806,291,770,331,720,397"/>
<area shape="poly" title=" " alt="" coords="983,398,1005,409,1088,463,1085,468,1003,414,980,403"/>
<area shape="poly" title=" " alt="" coords="943,205,1095,89,1098,93,946,209"/>
<area shape="rect" href="bort2_8f.html#afef28b5a86909cc8999fad7d98b11f00" title=" " alt="" coords="1485,31,1535,56"/>
<area shape="poly" title=" " alt="" coords="1153,64,1469,43,1469,49,1154,70"/>
<area shape="rect" href="parusr_8f.html#ae49e5fa3610c743607ca6288d4107d28" title=" " alt="" coords="1295,5,1352,31"/>
<area shape="poly" title=" " alt="" coords="1153,60,1279,27,1280,32,1154,65"/>
<area shape="poly" title=" " alt="" coords="1353,19,1470,35,1469,41,1352,25"/>
<area shape="poly" title=" " alt="" coords="243,1471,241,1461,248,1452,261,1447,281,1445,303,1447,316,1453,314,1458,302,1452,281,1450,262,1452,251,1456,246,1462,248,1470"/>
<area shape="poly" title=" " alt="" coords="531,944,604,913,700,878,810,851,867,843,924,840,1128,840,1172,838,1210,832,1242,822,1270,809,1327,772,1396,723,1443,683,1481,641,1485,644,1447,686,1399,727,1330,777,1273,814,1243,827,1211,837,1173,843,1128,845,924,845,868,848,811,856,702,884,606,918,533,949"/>
<area shape="poly" title=" " alt="" coords="449,947,447,937,453,928,467,923,488,921,511,923,524,929,522,934,509,928,488,926,469,928,457,932,452,938,454,946"/>
<area shape="poly" title=" " alt="" coords="994,1002,1230,927,1338,887,1375,871,1396,859,1418,835,1437,809,1467,750,1487,693,1500,645,1505,646,1493,695,1472,752,1442,811,1422,839,1399,863,1378,876,1340,892,1232,932,995,1007"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="1057,1005,1197,1045"/>
<area shape="poly" title=" " alt="" coords="994,1022,1041,1022,1041,1028,994,1028"/>
<area shape="poly" title=" " alt="" coords="360,828,452,834,565,850,685,878,744,898,800,922,852,955,895,992,891,996,849,960,797,927,742,903,683,883,564,855,452,840,359,833"/>
<area shape="rect" href="namespacetime__manager__mod.html#ad4d5cb71942ebf3f1bb9d4a29a6d9a04" title=" " alt="" coords="408,758,569,799"/>
<area shape="poly" title=" " alt="" coords="359,807,392,799,393,804,360,812"/>
<area shape="poly" title=" " alt="" coords="449,758,447,748,453,739,467,733,488,731,511,734,524,740,522,745,509,739,488,736,469,738,457,743,452,749,454,757"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="624,765,792,805"/>
<area shape="poly" title=" " alt="" coords="569,778,608,779,608,784,569,783"/>
<area shape="poly" title=" " alt="" coords="288,1174,305,1137,331,1091,364,1042,405,999,411,994,415,998,409,1003,368,1045,335,1093,310,1140,293,1176"/>
<area shape="poly" title=" " alt="" coords="324,1172,406,1137,452,1122,488,1114,524,1104,568,1086,591,1070,616,1054,673,1038,732,1028,841,1020,841,1025,733,1033,675,1043,618,1059,594,1074,571,1091,526,1109,490,1119,453,1127,408,1142,326,1177"/>
<area shape="rect" href="group__io__filenames__mod.html#gaa18cdd7babc2d4407b56a32660feb0ba" title="set netcdf file type" alt="" coords="412,1037,564,1077"/>
<area shape="poly" title=" " alt="" coords="304,1173,349,1134,406,1093,424,1082,427,1087,408,1098,353,1138,307,1177"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="418,1175,558,1216"/>
<area shape="poly" title=" " alt="" coords="355,1193,403,1193,403,1198,355,1198"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="418,1354,558,1395"/>
<area shape="poly" title=" " alt="" coords="304,1214,351,1262,409,1315,445,1343,442,1347,405,1319,347,1265,300,1218"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="418,1558,558,1599"/>
<area shape="poly" title=" " alt="" coords="295,1215,326,1283,362,1369,374,1413,379,1448,388,1482,409,1519,437,1547,433,1551,405,1522,383,1484,374,1449,369,1414,356,1371,321,1285,290,1217"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="418,1265,558,1305"/>
<area shape="poly" title=" " alt="" coords="332,1214,426,1255,424,1260,329,1219"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="407,1469,569,1509"/>
<area shape="poly" title=" " alt="" coords="295,1215,341,1300,373,1353,409,1405,455,1456,451,1459,405,1408,369,1356,336,1303,290,1218"/>
<area shape="poly" title=" " alt="" coords="449,1036,447,1027,453,1018,467,1012,488,1010,511,1012,524,1018,522,1023,509,1017,488,1015,469,1017,457,1022,452,1028,454,1035"/>
<area shape="poly" title=" " alt="" coords="449,1175,447,1165,453,1156,467,1151,488,1149,511,1151,524,1157,522,1162,509,1156,488,1154,469,1156,457,1160,452,1166,454,1174"/>
<area shape="poly" title=" " alt="" coords="449,1354,447,1344,453,1335,467,1329,488,1327,511,1330,524,1336,522,1341,509,1335,488,1332,469,1334,457,1339,452,1345,454,1353"/>
<area shape="poly" title=" " alt="" coords="449,1558,447,1548,453,1539,467,1533,488,1531,511,1534,524,1540,522,1545,509,1539,488,1536,469,1538,457,1543,452,1549,454,1557"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="1057,1637,1197,1677"/>
<area shape="poly" title=" " alt="" coords="558,1597,571,1610,584,1634,592,1663,598,1735,596,1820,589,1911,583,2002,583,2084,586,2120,593,2151,604,2177,619,2196,658,2224,697,2236,736,2234,775,2219,813,2194,850,2160,886,2119,921,2071,985,1966,1039,1859,1082,1762,1110,1690,1115,1692,1086,1764,1044,1861,989,1969,926,2074,891,2122,854,2164,816,2199,777,2224,737,2239,697,2241,656,2229,615,2200,599,2179,588,2153,581,2121,577,2084,577,2001,583,1911,590,1820,593,1735,587,1664,579,1636,567,1613,555,1601"/>
<area shape="poly" title=" " alt="" coords="1134,1635,1241,1363,1395,948,1495,645,1500,646,1400,950,1246,1364,1139,1637"/>
<area shape="poly" title=" " alt="" coords="449,1264,447,1255,453,1246,467,1240,488,1238,511,1240,524,1246,522,1251,509,1245,488,1243,469,1245,457,1250,452,1256,454,1263"/>
<area shape="poly" title=" " alt="" coords="548,1466,567,1449,588,1410,596,1372,594,1335,588,1299,582,1263,581,1226,591,1188,615,1150,636,1130,657,1118,678,1111,699,1109,745,1106,770,1101,798,1092,877,1051,879,1056,800,1097,772,1106,746,1111,700,1114,679,1117,659,1123,639,1134,619,1153,596,1190,587,1226,587,1262,593,1298,599,1335,601,1373,593,1411,571,1452,551,1470"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="627,2057,789,2097"/>
<area shape="poly" title=" " alt="" coords="558,1508,571,1520,593,1554,607,1586,615,1618,619,1649,615,1708,602,1767,589,1826,582,1887,584,1918,590,1950,602,1984,620,2018,631,2033,646,2046,643,2050,628,2037,615,2021,597,1986,585,1952,579,1919,577,1887,583,1826,597,1766,609,1708,614,1649,610,1619,602,1588,588,1556,567,1524,555,1512"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="638,2146,778,2187"/>
<area shape="poly" title=" " alt="" coords="558,1508,571,1521,584,1544,593,1573,602,1643,603,1725,600,1813,595,1902,595,1985,602,2055,609,2084,620,2107,631,2122,646,2135,643,2139,627,2126,615,2110,604,2086,596,2056,590,1985,590,1902,594,1813,598,1725,597,1643,588,1574,579,1546,567,1524,555,1512"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="632,1253,784,1293"/>
<area shape="poly" title=" " alt="" coords="545,1466,567,1448,580,1430,586,1413,590,1377,594,1341,601,1323,615,1304,619,1301,623,1305,619,1308,606,1326,599,1343,595,1378,592,1414,585,1433,571,1452,549,1470"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="638,1342,778,1383"/>
<area shape="poly" title=" " alt="" coords="539,1466,568,1448,582,1434,591,1421,600,1407,616,1393,625,1388,627,1392,619,1398,604,1411,595,1424,586,1438,571,1452,542,1470"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="625,1431,791,1472"/>
<area shape="poly" title=" " alt="" coords="569,1472,609,1466,610,1471,570,1478"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="638,1521,778,1561"/>
<area shape="poly" title=" " alt="" coords="570,1505,624,1518,622,1523,569,1511"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="638,1610,778,1651"/>
<area shape="poly" title=" " alt="" coords="549,1507,571,1520,586,1533,596,1545,619,1571,658,1599,655,1603,616,1575,592,1548,582,1537,568,1524,546,1512"/>
<area shape="rect" href="group__state__structure__mod.html#ga66d88ca7f0eeb73d74f5be11ce71da9b" title="Return short_name of a variable if it exist." alt="" coords="638,1699,778,1740"/>
<area shape="poly" title=" " alt="" coords="555,1508,571,1520,585,1538,593,1556,598,1590,602,1625,608,1642,619,1660,651,1689,647,1693,615,1664,603,1644,596,1626,592,1591,588,1558,580,1541,567,1524,552,1512"/>
<area shape="rect" href="group__state__structure__mod.html#ga4025efcde2bd8bc702bb10b26b393075" title="Return units of a variable if it exist." alt="" coords="638,1789,778,1829"/>
<area shape="poly" title=" " alt="" coords="557,1508,571,1520,590,1550,599,1579,601,1607,599,1635,596,1663,597,1690,604,1719,620,1750,633,1765,649,1778,645,1782,629,1769,615,1753,599,1721,592,1691,591,1662,593,1635,595,1607,594,1580,586,1553,567,1524,554,1512"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="638,1878,778,1919"/>
<area shape="poly" title=" " alt="" coords="558,1508,571,1520,596,1562,606,1602,605,1641,600,1679,594,1717,592,1756,599,1796,620,1839,632,1854,647,1867,644,1871,628,1858,615,1842,594,1798,587,1756,588,1717,595,1678,600,1641,600,1603,591,1564,567,1524,554,1512"/>
<area shape="rect" href="group__io__filenames__mod.html#ga34c52d7cbf0e9288483454380aedafe8" title="Determine whether a copy could potentially have units. Copies such as Spread and Inflation never have..." alt="" coords="623,1967,793,2008"/>
<area shape="poly" title=" " alt="" coords="558,1508,571,1520,589,1548,601,1574,609,1600,612,1626,610,1675,601,1723,591,1772,587,1822,595,1874,604,1901,620,1929,632,1944,647,1957,644,1961,628,1948,615,1932,600,1903,589,1875,582,1822,586,1771,596,1722,605,1674,607,1626,604,1601,596,1576,585,1550,567,1524,555,1512"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="617,1163,799,1204"/>
<area shape="poly" title=" " alt="" coords="547,1466,567,1448,585,1418,592,1389,592,1361,589,1333,586,1304,587,1275,596,1245,615,1215,618,1212,622,1216,619,1218,601,1248,593,1276,592,1304,595,1332,598,1361,597,1390,590,1420,571,1452,551,1470"/>
<area shape="poly" title=" " alt="" coords="667,2056,665,2047,672,2038,686,2032,708,2030,732,2032,746,2038,743,2043,730,2037,708,2035,687,2037,675,2042,670,2048,672,2055"/>
<area shape="poly" title=" " alt="" coords="667,2146,665,2136,672,2127,686,2121,708,2119,732,2122,746,2128,743,2133,730,2127,708,2124,687,2126,675,2131,670,2137,672,2145"/>
<area shape="poly" title=" " alt="" coords="667,1252,665,1243,672,1234,686,1228,708,1226,732,1228,746,1234,743,1239,730,1233,708,1231,687,1233,675,1238,670,1244,672,1251"/>
<area shape="poly" title=" " alt="" coords="667,1342,665,1332,672,1323,686,1317,708,1315,732,1318,746,1324,743,1329,730,1323,708,1320,687,1322,675,1327,670,1333,672,1341"/>
<area shape="poly" title=" " alt="" coords="667,1431,665,1421,672,1412,686,1407,708,1405,732,1407,746,1413,743,1418,730,1412,708,1410,687,1412,675,1416,670,1422,672,1430"/>
<area shape="poly" title=" " alt="" coords="667,1520,665,1511,672,1502,686,1496,708,1494,732,1496,746,1502,743,1507,730,1501,708,1499,687,1501,675,1506,670,1512,672,1519"/>
<area shape="poly" title=" " alt="" coords="667,1610,665,1600,672,1591,686,1585,708,1583,732,1586,746,1592,743,1597,730,1591,708,1588,687,1590,675,1595,670,1601,672,1609"/>
<area shape="poly" title=" " alt="" coords="667,1699,665,1689,672,1680,686,1675,708,1673,732,1675,746,1681,743,1686,730,1680,708,1678,687,1680,675,1684,670,1690,672,1698"/>
<area shape="poly" title=" " alt="" coords="667,1788,665,1779,672,1770,686,1764,708,1762,732,1764,746,1770,743,1775,730,1769,708,1767,687,1769,675,1774,670,1780,672,1787"/>
<area shape="poly" title=" " alt="" coords="667,1878,665,1868,672,1859,686,1853,708,1851,732,1854,746,1860,743,1865,730,1859,708,1856,687,1858,675,1863,670,1869,672,1877"/>
<area shape="poly" title=" " alt="" coords="667,1967,665,1957,672,1948,686,1943,708,1941,732,1943,746,1949,743,1954,730,1948,708,1946,687,1948,675,1952,670,1958,672,1966"/>
<area shape="poly" title=" " alt="" coords="765,1160,797,1143,851,1099,895,1055,899,1059,855,1103,800,1147,767,1165"/>
<area shape="poly" title=" " alt="" coords="291,1380,323,1313,356,1227,365,1192,368,1162,367,1107,369,1081,374,1055,385,1028,405,999,409,995,413,998,409,1002,390,1031,379,1057,374,1082,373,1107,373,1162,370,1193,362,1228,328,1315,296,1382"/>
<area shape="poly" title=" " alt="" coords="341,1420,394,1433,455,1439,486,1438,515,1432,543,1421,568,1404,584,1388,595,1371,605,1336,603,1299,595,1261,587,1222,583,1182,591,1142,601,1122,616,1103,841,1043,842,1049,619,1107,605,1125,596,1144,589,1182,592,1221,600,1260,608,1298,610,1336,600,1373,588,1391,571,1408,545,1425,517,1437,486,1443,455,1445,394,1439,340,1426"/>
<area shape="poly" title=" " alt="" coords="290,1380,334,1307,367,1264,405,1227,412,1222,415,1226,409,1231,371,1268,338,1310,295,1383"/>
<area shape="poly" title=" " alt="" coords="358,1389,402,1383,403,1388,358,1394"/>
<area shape="poly" title=" " alt="" coords="343,1421,361,1434,378,1455,387,1476,394,1497,409,1519,440,1547,437,1551,405,1523,389,1499,382,1478,374,1458,357,1437,340,1425"/>
<area shape="poly" title=" " alt="" coords="308,1379,353,1348,406,1316,417,1310,420,1315,408,1320,356,1352,311,1384"/>
<area shape="poly" title=" " alt="" coords="333,1421,425,1460,422,1464,331,1426"/>
<area shape="rect" href="group__state__structure__mod.html#gac1ff557084c37c7e9ee32f2deb248c5d" title="Transform the state type to a domain that can be used to write diagnostic files. One domain for the w..." alt="" coords="418,1777,558,1833"/>
<area shape="poly" title=" " alt="" coords="348,1421,361,1434,386,1478,395,1519,393,1560,387,1600,380,1639,378,1679,386,1720,409,1763,409,1764,405,1767,405,1766,381,1722,373,1680,375,1639,382,1599,388,1559,390,1520,381,1479,357,1437,344,1425"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="418,1647,558,1688"/>
<area shape="poly" title=" " alt="" coords="346,1421,361,1434,377,1457,385,1479,388,1521,390,1563,396,1585,409,1609,437,1636,433,1640,405,1612,391,1587,385,1564,383,1521,380,1480,372,1459,357,1437,343,1425"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="418,1713,558,1753"/>
<area shape="poly" title=" " alt="" coords="347,1421,361,1434,382,1469,390,1503,390,1536,385,1568,381,1600,381,1632,389,1664,409,1698,411,1700,407,1704,405,1701,384,1666,376,1633,376,1600,380,1567,384,1535,385,1503,377,1471,357,1437,344,1425"/>
<area shape="poly" title=" " alt="" coords="449,1647,447,1637,453,1628,467,1623,488,1621,511,1623,524,1629,522,1634,509,1628,488,1626,469,1628,457,1632,452,1638,454,1646"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_icgraph" id="agroup__direct__netcdf__mod_ga811379f67b7a78e7cbfab32f80b54b8c_icgraph">
<area shape="rect" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="791,287,941,328"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="gad9dc061f4e03f757d1ead8be309c5a28" name="gad9dc061f4e03f757d1ead8be309c5a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9dc061f4e03f757d1ead8be309c5a28">&#9670;&#160;</a></span>nc_append_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::nc_append_time </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>dart_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The current time is appended to the "time" coordinate variable. The new length of the "time" variable is returned. </p>
<p>This REQUIRES that "time" is a coordinate variable AND it is the unlimited dimension. If not ... bad things happen. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02831">2831</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_cgraph" id="agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_cgraph">
<area shape="rect" title="The current time is appended to the &quot;time&quot; coordinate variable. The new length of the &quot;time&quot; variable..." alt="" coords="5,71,142,111"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="451,71,579,111"/>
<area shape="poly" title=" " alt="" coords="142,88,436,88,436,94,142,94"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="190,28,383,53"/>
<area shape="poly" title=" " alt="" coords="141,72,214,55,215,60,143,77"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="218,128,355,169"/>
<area shape="poly" title=" " alt="" coords="143,107,203,123,202,128,141,112"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="650,5,778,46"/>
<area shape="poly" title=" " alt="" coords="578,68,635,49,637,54,580,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="650,71,778,111"/>
<area shape="poly" title=" " alt="" coords="580,88,635,88,635,94,580,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="647,136,781,161"/>
<area shape="poly" title=" " alt="" coords="580,107,653,128,652,133,579,112"/>
<area shape="poly" title=" " alt="" coords="348,51,436,71,435,76,347,56"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="431,5,599,46"/>
<area shape="poly" title=" " alt="" coords="383,31,415,29,416,35,384,37"/>
<area shape="poly" title=" " alt="" coords="355,129,435,108,437,113,356,134"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="445,136,585,177"/>
<area shape="poly" title=" " alt="" coords="356,148,429,151,429,156,355,153"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_icgraph" id="agroup__direct__netcdf__mod_gad9dc061f4e03f757d1ead8be309c5a28_icgraph">
<area shape="rect" title="The current time is appended to the &quot;time&quot; coordinate variable. The new length of the &quot;time&quot; variable..." alt="" coords="1159,287,1296,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga0254908b100e01af1a9f26cc4685bf76" title="We need to compare the time of the current assim_model to the netcdf time coordinate variable (the un..." alt="" coords="975,287,1111,328"/>
<area shape="poly" title=" " alt="" coords="1144,310,1112,310,1112,305,1144,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga53e97fc6bd08a2af8be0d542ecc56a58" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="791,287,927,328"/>
<area shape="poly" title=" " alt="" coords="960,310,928,310,928,305,960,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="gafb7b451fc6de3f86bffb169fa700f668" name="gafb7b451fc6de3f86bffb169fa700f668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb7b451fc6de3f86bffb169fa700f668">&#9670;&#160;</a></span>nc_get_num_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public direct_netcdf_mod::nc_get_num_times </td>
          <td>(</td>
          <td class="paramtype">character(len=256), intent(in)&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02966">2966</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_cgraph" id="agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,142,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="190,104,327,145"/>
<area shape="poly" title=" " alt="" coords="142,122,174,122,174,127,142,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="381,71,509,111"/>
<area shape="poly" title=" " alt="" coords="327,109,365,103,366,108,328,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="375,136,515,177"/>
<area shape="poly" title=" " alt="" coords="328,133,360,139,359,144,327,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="566,5,694,46"/>
<area shape="poly" title=" " alt="" coords="504,68,555,49,557,54,506,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="566,71,694,111"/>
<area shape="poly" title=" " alt="" coords="510,88,551,88,551,94,510,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="563,136,697,161"/>
<area shape="poly" title=" " alt="" coords="511,108,572,128,571,133,509,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_icgraph" id="agroup__direct__netcdf__mod_gafb7b451fc6de3f86bffb169fa700f668_icgraph">
<area shape="rect" title=" " alt="" coords="294,5,430,46"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="100,13,246,39"/>
<area shape="poly" title=" " alt="" coords="278,28,247,28,247,23,278,23"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="5,13,52,39"/>
<area shape="poly" title=" " alt="" coords="84,28,52,28,52,23,84,23"/>
</map>
</div>

</div>
</div>
<a id="ga0254908b100e01af1a9f26cc4685bf76" name="ga0254908b100e01af1a9f26cc4685bf76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0254908b100e01af1a9f26cc4685bf76">&#9670;&#160;</a></span>nc_get_tindex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::nc_get_tindex </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>statetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>We need to compare the time of the current assim_model to the netcdf time coordinate variable (the unlimited dimension). If they are the same, no problem ... If it is earlier, we need to find the right index and insert ... If it is the "future", we need to add another one ... If it is in the past but does not match any we have, we're in trouble. The new length of the "time" variable is returned. </p>
<p>A "times" array has been added to mirror the times that are stored in the netcdf time coordinate variable. While somewhat unpleasant, it is SUBSTANTIALLY faster than reading the netcdf time variable at every turn &ndash; which caused a geometric or exponential increase in overall netcdf I/O. (i.e. this was really bad)</p>
<p>The time mirror is maintained as a time_type, so the comparison with the state time uses the operators for the time_type. The netCDF file, however, has time units of a different convention. The times are converted only when appending to the time coordinate variable. <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02679">2679</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_cgraph" id="agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_cgraph">
<area shape="rect" title="We need to compare the time of the current assim_model to the netcdf time coordinate variable (the un..." alt="" coords="5,79,142,119"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="635,84,764,125"/>
<area shape="poly" title=" " alt="" coords="142,98,190,99,620,102,620,107,190,104,142,103"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="374,13,567,39"/>
<area shape="poly" title=" " alt="" coords="104,76,143,53,189,35,275,20,359,17,359,22,275,25,190,40,145,58,106,80"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad9dc061f4e03f757d1ead8be309c5a28" title="The current time is appended to the &quot;time&quot; coordinate variable. The new length of the &quot;time&quot; variable..." alt="" coords="190,49,326,90"/>
<area shape="poly" title=" " alt="" coords="142,86,174,80,174,86,142,91"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="402,164,539,205"/>
<area shape="poly" title=" " alt="" coords="120,117,190,143,292,164,387,176,386,181,291,169,189,148,118,122"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="835,19,962,59"/>
<area shape="poly" title=" " alt="" coords="763,81,819,62,821,67,764,86"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="835,84,962,125"/>
<area shape="poly" title=" " alt="" coords="764,102,819,102,819,107,764,107"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="832,149,965,175"/>
<area shape="poly" title=" " alt="" coords="765,120,838,142,836,147,763,125"/>
<area shape="poly" title=" " alt="" coords="513,37,568,55,627,76,625,81,566,60,512,42"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="615,5,784,46"/>
<area shape="poly" title=" " alt="" coords="568,23,600,23,600,28,568,28"/>
<area shape="poly" title=" " alt="" coords="327,72,620,95,620,101,326,78"/>
<area shape="poly" title=" " alt="" coords="326,53,390,40,391,45,327,58"/>
<area shape="poly" title=" " alt="" coords="299,88,419,154,416,159,296,93"/>
<area shape="poly" title=" " alt="" coords="530,161,624,128,626,133,532,166"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="629,164,770,205"/>
<area shape="poly" title=" " alt="" coords="540,182,614,182,614,187,540,187"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_icgraph" id="agroup__direct__netcdf__mod_ga0254908b100e01af1a9f26cc4685bf76_icgraph">
<area shape="rect" title="We need to compare the time of the current assim_model to the netcdf time coordinate variable (the un..." alt="" coords="975,287,1111,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga53e97fc6bd08a2af8be0d542ecc56a58" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="791,287,927,328"/>
<area shape="poly" title=" " alt="" coords="960,310,928,310,928,305,960,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga31098fc0ee34f4559645cd5122edc81e" name="ga31098fc0ee34f4559645cd5122edc81e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31098fc0ee34f4559645cd5122edc81e">&#9670;&#160;</a></span>nc_write_calendar_atts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer function direct_netcdf_mod::nc_write_calendar_atts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timevarid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>routine write calendar attributes </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000070">Todo:</a></b></dt><dd>FIXME this duplicates code in <a class="el" href="dart__time__io__mod_8f90.html">dart_time_io_mod.f90</a> - it should be one place or the other. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02921">2921</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_cgraph" id="agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_cgraph">
<area shape="rect" title="routine write calendar attributes" alt="" coords="5,63,161,103"/>
<area shape="rect" href="namespacetime__manager__mod.html#ad4d5cb71942ebf3f1bb9d4a29a6d9a04" title=" " alt="" coords="209,29,370,70"/>
<area shape="poly" title=" " alt="" coords="161,68,193,63,194,68,162,73"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="221,95,358,135"/>
<area shape="poly" title=" " alt="" coords="162,92,206,99,205,105,161,98"/>
<area shape="poly" title=" " alt="" coords="250,29,248,19,255,10,269,5,289,3,312,5,325,11,323,16,310,10,289,8,270,10,258,15,253,20,255,28"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="418,29,586,70"/>
<area shape="poly" title=" " alt="" coords="370,47,402,47,402,52,370,52"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="438,95,566,135"/>
<area shape="poly" title=" " alt="" coords="358,112,423,112,423,118,358,118"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="432,160,572,201"/>
<area shape="poly" title=" " alt="" coords="359,133,420,152,418,157,357,138"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="637,29,765,70"/>
<area shape="poly" title=" " alt="" coords="565,92,622,73,624,78,567,97"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="637,95,765,135"/>
<area shape="poly" title=" " alt="" coords="567,112,622,112,622,118,567,118"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="634,160,768,185"/>
<area shape="poly" title=" " alt="" coords="567,131,640,152,639,157,566,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_icgraph" id="agroup__direct__netcdf__mod_ga31098fc0ee34f4559645cd5122edc81e_icgraph">
<area shape="rect" title="routine write calendar attributes" alt="" coords="989,287,1144,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="791,287,941,328"/>
<area shape="poly" title=" " alt="" coords="974,310,942,310,942,305,974,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga9b4b6fd124b574282fccbff0d7c07437" name="ga9b4b6fd124b574282fccbff0d7c07437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9b4b6fd124b574282fccbff0d7c07437">&#9670;&#160;</a></span>nc_write_file_information()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_file_information </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>description</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write global clamping attributes to files that already exist. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000059">Todo:</a></b></dt><dd>FIXME ? use derived type for copy number and get long name </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01845">1845</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_cgraph" id="agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_cgraph">
<area shape="rect" title="Write global clamping attributes to files that already exist." alt="" coords="5,104,171,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="219,104,356,145"/>
<area shape="poly" title=" " alt="" coords="171,122,204,122,204,127,171,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="410,71,538,111"/>
<area shape="poly" title=" " alt="" coords="356,109,394,103,395,108,357,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="404,136,544,177"/>
<area shape="poly" title=" " alt="" coords="357,133,389,139,388,144,356,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="595,5,723,46"/>
<area shape="poly" title=" " alt="" coords="533,68,584,49,586,54,535,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="595,71,723,111"/>
<area shape="poly" title=" " alt="" coords="539,88,580,88,580,94,539,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="592,136,726,161"/>
<area shape="poly" title=" " alt="" coords="540,108,601,128,600,133,538,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_icgraph" id="agroup__direct__netcdf__mod_ga9b4b6fd124b574282fccbff0d7c07437_icgraph">
<area shape="rect" title="Write global clamping attributes to files that already exist." alt="" coords="1604,287,1769,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1400,280,1556,335"/>
<area shape="poly" title=" " alt="" coords="1589,310,1556,310,1556,305,1589,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,296,1349,291,1350,285,1385,291"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,324,1353,329,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga14f0ad63f26920f56019fe2036506b71" name="ga14f0ad63f26920f56019fe2036506b71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14f0ad63f26920f56019fe2036506b71">&#9670;&#160;</a></span>nc_write_global_att_clamping()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_global_att_clamping </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>from_scratch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write global clamping attributes for variables that have clamping. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000060">Todo:</a></b></dt><dd>FIXME check to see if this has a performance impact. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01895">1895</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_cgraph" id="agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_cgraph">
<area shape="rect" title="Write global clamping attributes for variables that have clamping." alt="" coords="5,246,142,302"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="206,29,346,70"/>
<area shape="poly" title=" " alt="" coords="83,244,98,208,121,164,151,120,188,81,194,76,197,80,191,85,155,123,126,167,103,210,87,246"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="190,119,362,159"/>
<area shape="poly" title=" " alt="" coords="100,243,140,206,188,170,198,164,201,169,191,175,143,210,103,247"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="192,208,360,249"/>
<area shape="poly" title=" " alt="" coords="141,256,176,248,177,253,142,261"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="206,297,346,338"/>
<area shape="poly" title=" " alt="" coords="142,286,191,297,190,302,141,291"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="206,387,346,427"/>
<area shape="poly" title=" " alt="" coords="119,300,232,375,229,380,116,304"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="207,452,345,493"/>
<area shape="poly" title=" " alt="" coords="90,301,130,369,158,405,191,437,198,441,194,446,188,441,154,409,126,372,86,303"/>
<area shape="poly" title=" " alt="" coords="237,29,235,19,242,10,255,5,276,3,298,5,311,11,309,16,296,10,276,8,257,10,245,15,241,20,243,28"/>
<area shape="poly" title=" " alt="" coords="237,119,235,109,242,100,255,94,276,92,298,94,311,101,309,105,296,100,276,97,257,99,245,104,241,110,243,117"/>
<area shape="poly" title=" " alt="" coords="237,208,235,198,242,189,255,183,276,181,298,184,311,190,309,195,296,189,276,187,257,189,245,193,241,199,243,207"/>
<area shape="poly" title=" " alt="" coords="237,297,235,287,242,278,255,273,276,271,298,273,311,279,309,284,296,278,276,276,257,278,245,283,241,288,243,296"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="410,308,550,349"/>
<area shape="poly" title=" " alt="" coords="347,319,395,321,394,327,346,324"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="598,341,727,382"/>
<area shape="poly" title=" " alt="" coords="551,339,583,345,582,350,550,344"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="778,276,905,317"/>
<area shape="poly" title=" " alt="" coords="719,338,769,320,770,325,721,343"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="778,341,905,382"/>
<area shape="poly" title=" " alt="" coords="727,359,762,359,762,364,727,364"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="775,406,908,432"/>
<area shape="poly" title=" " alt="" coords="728,380,785,398,784,404,726,385"/>
<area shape="poly" title=" " alt="" coords="237,387,235,377,242,368,255,362,276,360,298,362,311,369,309,373,296,368,276,365,257,367,245,372,241,378,243,385"/>
<area shape="poly" title=" " alt="" coords="344,450,583,381,584,387,346,455"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="410,452,550,493"/>
<area shape="poly" title=" " alt="" coords="345,470,395,470,395,475,345,475"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_icgraph" id="agroup__direct__netcdf__mod_ga14f0ad63f26920f56019fe2036506b71_icgraph">
<area shape="rect" title="Write global clamping attributes for variables that have clamping." alt="" coords="1604,278,1740,334"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1400,278,1556,334"/>
<area shape="poly" title=" " alt="" coords="1589,309,1556,309,1556,304,1589,304"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1589,277,1556,269,1503,263,1449,261,1349,265,1349,260,1449,255,1503,257,1556,264,1590,271"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1590,341,1556,349,1504,355,1451,357,1352,353,1352,348,1451,352,1504,350,1556,344,1589,336"/>
<area shape="poly" title=" " alt="" coords="1384,295,1349,290,1350,285,1385,290"/>
<area shape="poly" title=" " alt="" coords="1385,323,1353,328,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga85a4fb44801f712976ce12f96ac367f2" name="ga85a4fb44801f712976ce12f96ac367f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga85a4fb44801f712976ce12f96ac367f2">&#9670;&#160;</a></span>nc_write_missing_value_int()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_missing_value_int </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncvarid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write model integer missing_value/_FillValue attributes if they exist. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01974">1974</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_cgraph" id="agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_cgraph">
<area shape="rect" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="5,104,187,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="235,104,372,145"/>
<area shape="poly" title=" " alt="" coords="187,122,219,122,219,127,187,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="426,71,554,111"/>
<area shape="poly" title=" " alt="" coords="372,109,410,103,411,108,373,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="420,136,560,177"/>
<area shape="poly" title=" " alt="" coords="373,133,405,139,404,144,372,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="611,5,739,46"/>
<area shape="poly" title=" " alt="" coords="549,68,600,49,602,54,551,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="611,71,739,111"/>
<area shape="poly" title=" " alt="" coords="555,88,596,88,596,94,555,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="608,136,742,161"/>
<area shape="poly" title=" " alt="" coords="556,108,617,128,616,133,554,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_icgraph" id="agroup__direct__netcdf__mod_ga85a4fb44801f712976ce12f96ac367f2_icgraph">
<area shape="rect" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="1834,204,2016,245"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="1624,204,1786,245"/>
<area shape="poly" title=" " alt="" coords="1819,227,1787,227,1787,222,1819,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1420,268,1576,324"/>
<area shape="poly" title=" " alt="" coords="1631,253,1577,272,1576,267,1629,248"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1425,139,1571,179"/>
<area shape="poly" title=" " alt="" coords="1624,201,1564,182,1566,177,1625,196"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="1422,204,1574,245"/>
<area shape="poly" title=" " alt="" coords="1608,227,1575,227,1575,222,1608,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1188,337,1369,378"/>
<area shape="poly" title=" " alt="" coords="1406,325,1354,339,1353,334,1405,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1185,272,1372,313"/>
<area shape="poly" title=" " alt="" coords="1404,297,1372,297,1372,291,1404,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="991,305,1127,346"/>
<area shape="poly" title=" " alt="" coords="1172,345,1127,338,1128,333,1173,340"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,305,933,346"/>
<area shape="poly" title=" " alt="" coords="976,328,934,328,934,323,976,323"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,305,743,346"/>
<area shape="poly" title=" " alt="" coords="775,328,743,328,743,323,775,323"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,248,552,289"/>
<area shape="poly" title=" " alt="" coords="585,304,540,292,542,287,586,299"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,97,331,122"/>
<area shape="poly" title=" " alt="" coords="657,292,642,254,619,211,589,170,551,137,498,114,440,102,383,99,332,101,332,96,383,93,441,97,500,109,554,133,593,166,624,208,647,251,662,290"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,311,315,337"/>
<area shape="poly" title=" " alt="" coords="585,328,315,327,315,322,585,323"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,207,306,233"/>
<area shape="poly" title=" " alt="" coords="638,297,599,265,551,239,487,222,421,215,359,214,307,217,306,212,358,209,421,209,488,217,553,234,602,260,642,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,258,137,284"/>
<area shape="poly" title=" " alt="" coords="645,359,605,396,580,413,553,425,451,460,407,471,366,477,324,476,281,468,235,453,183,429,162,415,142,398,111,357,88,317,75,285,79,283,93,314,115,354,146,394,165,411,186,425,237,448,283,463,325,471,365,471,407,466,450,455,551,420,577,408,602,391,642,355"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,515,515,541"/>
<area shape="poly" title=" " alt="" coords="657,361,616,430,588,467,554,498,517,518,514,513,551,494,584,463,612,427,652,359"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,541,323,566"/>
<area shape="poly" title=" " alt="" coords="666,362,654,409,632,463,599,515,578,537,554,556,523,571,490,580,456,585,422,586,357,581,303,570,304,564,358,575,422,581,456,580,489,575,521,566,551,551,575,533,595,512,627,460,648,407,661,361"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,363,524,389"/>
<area shape="poly" title=" " alt="" coords="585,349,521,365,520,360,584,344"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,389,323,414"/>
<area shape="poly" title=" " alt="" coords="637,358,598,384,553,404,493,416,432,421,374,419,323,415,324,409,374,414,432,415,493,411,552,399,596,379,634,353"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,617,545,642"/>
<area shape="poly" title=" " alt="" coords="667,362,654,414,632,477,600,542,579,573,554,600,524,618,521,614,551,596,574,569,595,540,627,475,649,413,661,361"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,46,535,72"/>
<area shape="poly" title=" " alt="" coords="659,291,644,247,622,194,591,140,551,93,520,75,523,70,554,89,595,137,627,191,649,245,664,290"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,147,546,173"/>
<area shape="poly" title=" " alt="" coords="646,294,605,243,579,217,551,195,514,176,516,171,554,190,583,213,609,240,650,291"/>
<area shape="poly" title=" " alt="" coords="424,240,275,125,278,121,427,236"/>
<area shape="poly" title=" " alt="" coords="374,296,309,313,308,308,373,291"/>
<area shape="poly" title=" " alt="" coords="363,247,306,234,307,229,365,242"/>
<area shape="poly" title=" " alt="" coords="363,272,137,273,137,268,363,266"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,97,94,122"/>
<area shape="poly" title=" " alt="" coords="169,112,95,112,95,107,169,107"/>
<area shape="poly" title=" " alt="" coords="195,240,122,260,120,255,194,235"/>
<area shape="poly" title=" " alt="" coords="401,539,324,548,323,543,400,533"/>
<area shape="poly" title=" " alt="" coords="392,388,324,396,323,391,391,383"/>
<area shape="poly" title=" " alt="" coords="1171,311,1128,318,1127,313,1170,306"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="1203,204,1354,245"/>
<area shape="poly" title=" " alt="" coords="1414,187,1350,206,1349,201,1412,182"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="981,63,1137,103"/>
<area shape="poly" title=" " alt="" coords="1409,146,1137,99,1138,94,1410,141"/>
<area shape="poly" title=" " alt="" coords="1188,236,1004,260,791,296,744,308,742,302,790,291,1004,255,1187,231"/>
<area shape="poly" title=" " alt="" coords="973,61,854,34,782,22,705,13,624,9,541,10,459,19,380,36,349,48,320,65,276,98,272,94,317,60,347,44,378,31,458,13,541,5,624,3,705,8,783,17,855,29,974,56"/>
<area shape="poly" title=" " alt="" coords="1406,227,1354,227,1354,222,1406,222"/>
</map>
</div>

</div>
</div>
<a id="ga97512c742d614257d5013e176e85a3a9" name="ga97512c742d614257d5013e176e85a3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga97512c742d614257d5013e176e85a3a9">&#9670;&#160;</a></span>nc_write_missing_value_r4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_missing_value_r4 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncvarid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write model r4 missing_value/_FillValue attributes if they exist. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02002">2002</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_cgraph" id="agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_cgraph">
<area shape="rect" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="5,104,184,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="232,104,369,145"/>
<area shape="poly" title=" " alt="" coords="184,122,216,122,216,127,184,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="423,71,551,111"/>
<area shape="poly" title=" " alt="" coords="369,109,407,103,408,108,370,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="417,136,557,177"/>
<area shape="poly" title=" " alt="" coords="370,133,402,139,401,144,369,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="608,5,736,46"/>
<area shape="poly" title=" " alt="" coords="546,68,597,49,599,54,548,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="608,71,736,111"/>
<area shape="poly" title=" " alt="" coords="552,88,593,88,593,94,552,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="605,136,739,161"/>
<area shape="poly" title=" " alt="" coords="553,108,614,128,613,133,551,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_icgraph" id="agroup__direct__netcdf__mod_ga97512c742d614257d5013e176e85a3a9_icgraph">
<area shape="rect" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="1834,204,2013,245"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="1624,204,1786,245"/>
<area shape="poly" title=" " alt="" coords="1819,227,1787,227,1787,222,1819,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1420,268,1576,324"/>
<area shape="poly" title=" " alt="" coords="1631,253,1577,272,1576,267,1629,248"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1425,139,1571,179"/>
<area shape="poly" title=" " alt="" coords="1624,201,1564,182,1566,177,1625,196"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="1422,204,1574,245"/>
<area shape="poly" title=" " alt="" coords="1608,227,1575,227,1575,222,1608,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1188,337,1369,378"/>
<area shape="poly" title=" " alt="" coords="1406,325,1354,339,1353,334,1405,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1185,272,1372,313"/>
<area shape="poly" title=" " alt="" coords="1404,297,1372,297,1372,291,1404,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="991,305,1127,346"/>
<area shape="poly" title=" " alt="" coords="1172,345,1127,338,1128,333,1173,340"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,305,933,346"/>
<area shape="poly" title=" " alt="" coords="976,328,934,328,934,323,976,323"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,305,743,346"/>
<area shape="poly" title=" " alt="" coords="775,328,743,328,743,323,775,323"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,248,552,289"/>
<area shape="poly" title=" " alt="" coords="585,304,540,292,542,287,586,299"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,97,331,122"/>
<area shape="poly" title=" " alt="" coords="657,292,642,254,619,211,589,170,551,137,498,114,440,102,383,99,332,101,332,96,383,93,441,97,500,109,554,133,593,166,624,208,647,251,662,290"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,311,315,337"/>
<area shape="poly" title=" " alt="" coords="585,328,315,327,315,322,585,323"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,207,306,233"/>
<area shape="poly" title=" " alt="" coords="638,297,599,265,551,239,487,222,421,215,359,214,307,217,306,212,358,209,421,209,488,217,553,234,602,260,642,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,258,137,284"/>
<area shape="poly" title=" " alt="" coords="645,359,605,396,580,413,553,425,451,460,407,471,366,477,324,476,281,468,235,453,183,429,162,415,142,398,111,357,88,317,75,285,79,283,93,314,115,354,146,394,165,411,186,425,237,448,283,463,325,471,365,471,407,466,450,455,551,420,577,408,602,391,642,355"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,515,515,541"/>
<area shape="poly" title=" " alt="" coords="657,361,616,430,588,467,554,498,517,518,514,513,551,494,584,463,612,427,652,359"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,541,323,566"/>
<area shape="poly" title=" " alt="" coords="666,362,654,409,632,463,599,515,578,537,554,556,523,571,490,580,456,585,422,586,357,581,303,570,304,564,358,575,422,581,456,580,489,575,521,566,551,551,575,533,595,512,627,460,648,407,661,361"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,363,524,389"/>
<area shape="poly" title=" " alt="" coords="585,349,521,365,520,360,584,344"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,389,323,414"/>
<area shape="poly" title=" " alt="" coords="637,358,598,384,553,404,493,416,432,421,374,419,323,415,324,409,374,414,432,415,493,411,552,399,596,379,634,353"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,617,545,642"/>
<area shape="poly" title=" " alt="" coords="667,362,654,414,632,477,600,542,579,573,554,600,524,618,521,614,551,596,574,569,595,540,627,475,649,413,661,361"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,46,535,72"/>
<area shape="poly" title=" " alt="" coords="659,291,644,247,622,194,591,140,551,93,520,75,523,70,554,89,595,137,627,191,649,245,664,290"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,147,546,173"/>
<area shape="poly" title=" " alt="" coords="646,294,605,243,579,217,551,195,514,176,516,171,554,190,583,213,609,240,650,291"/>
<area shape="poly" title=" " alt="" coords="424,240,275,125,278,121,427,236"/>
<area shape="poly" title=" " alt="" coords="374,296,309,313,308,308,373,291"/>
<area shape="poly" title=" " alt="" coords="363,247,306,234,307,229,365,242"/>
<area shape="poly" title=" " alt="" coords="363,272,137,273,137,268,363,266"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,97,94,122"/>
<area shape="poly" title=" " alt="" coords="169,112,95,112,95,107,169,107"/>
<area shape="poly" title=" " alt="" coords="195,240,122,260,120,255,194,235"/>
<area shape="poly" title=" " alt="" coords="401,539,324,548,323,543,400,533"/>
<area shape="poly" title=" " alt="" coords="392,388,324,396,323,391,391,383"/>
<area shape="poly" title=" " alt="" coords="1171,311,1128,318,1127,313,1170,306"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="1203,204,1354,245"/>
<area shape="poly" title=" " alt="" coords="1414,187,1350,206,1349,201,1412,182"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="981,63,1137,103"/>
<area shape="poly" title=" " alt="" coords="1409,146,1137,99,1138,94,1410,141"/>
<area shape="poly" title=" " alt="" coords="1188,236,1004,260,791,296,744,308,742,302,790,291,1004,255,1187,231"/>
<area shape="poly" title=" " alt="" coords="973,61,854,34,782,22,705,13,624,9,541,10,459,19,380,36,349,48,320,65,276,98,272,94,317,60,347,44,378,31,458,13,541,5,624,3,705,8,783,17,855,29,974,56"/>
<area shape="poly" title=" " alt="" coords="1406,227,1354,227,1354,222,1406,222"/>
</map>
</div>

</div>
</div>
<a id="gad501af477a3530059fd8cac992d89632" name="gad501af477a3530059fd8cac992d89632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad501af477a3530059fd8cac992d89632">&#9670;&#160;</a></span>nc_write_missing_value_r8()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_missing_value_r8 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncvarid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write model r8 missing_value/_FillValue attributes if they exist. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02030">2030</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_cgraph" id="agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_cgraph">
<area shape="rect" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="5,104,184,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="232,104,369,145"/>
<area shape="poly" title=" " alt="" coords="184,122,216,122,216,127,184,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="423,71,551,111"/>
<area shape="poly" title=" " alt="" coords="369,109,407,103,408,108,370,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="417,136,557,177"/>
<area shape="poly" title=" " alt="" coords="370,133,402,139,401,144,369,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="608,5,736,46"/>
<area shape="poly" title=" " alt="" coords="546,68,597,49,599,54,548,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="608,71,736,111"/>
<area shape="poly" title=" " alt="" coords="552,88,593,88,593,94,552,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="605,136,739,161"/>
<area shape="poly" title=" " alt="" coords="553,108,614,128,613,133,551,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_icgraph" id="agroup__direct__netcdf__mod_gad501af477a3530059fd8cac992d89632_icgraph">
<area shape="rect" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="1834,204,2013,245"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="1624,204,1786,245"/>
<area shape="poly" title=" " alt="" coords="1819,227,1787,227,1787,222,1819,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1420,268,1576,324"/>
<area shape="poly" title=" " alt="" coords="1631,253,1577,272,1576,267,1629,248"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1425,139,1571,179"/>
<area shape="poly" title=" " alt="" coords="1624,201,1564,182,1566,177,1625,196"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="1422,204,1574,245"/>
<area shape="poly" title=" " alt="" coords="1608,227,1575,227,1575,222,1608,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1188,337,1369,378"/>
<area shape="poly" title=" " alt="" coords="1406,325,1354,339,1353,334,1405,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1185,272,1372,313"/>
<area shape="poly" title=" " alt="" coords="1404,297,1372,297,1372,291,1404,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="991,305,1127,346"/>
<area shape="poly" title=" " alt="" coords="1172,345,1127,338,1128,333,1173,340"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,305,933,346"/>
<area shape="poly" title=" " alt="" coords="976,328,934,328,934,323,976,323"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,305,743,346"/>
<area shape="poly" title=" " alt="" coords="775,328,743,328,743,323,775,323"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,248,552,289"/>
<area shape="poly" title=" " alt="" coords="585,304,540,292,542,287,586,299"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,97,331,122"/>
<area shape="poly" title=" " alt="" coords="657,292,642,254,619,211,589,170,551,137,498,114,440,102,383,99,332,101,332,96,383,93,441,97,500,109,554,133,593,166,624,208,647,251,662,290"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,311,315,337"/>
<area shape="poly" title=" " alt="" coords="585,328,315,327,315,322,585,323"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,207,306,233"/>
<area shape="poly" title=" " alt="" coords="638,297,599,265,551,239,487,222,421,215,359,214,307,217,306,212,358,209,421,209,488,217,553,234,602,260,642,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,258,137,284"/>
<area shape="poly" title=" " alt="" coords="645,359,605,396,580,413,553,425,451,460,407,471,366,477,324,476,281,468,235,453,183,429,162,415,142,398,111,357,88,317,75,285,79,283,93,314,115,354,146,394,165,411,186,425,237,448,283,463,325,471,365,471,407,466,450,455,551,420,577,408,602,391,642,355"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,515,515,541"/>
<area shape="poly" title=" " alt="" coords="657,361,616,430,588,467,554,498,517,518,514,513,551,494,584,463,612,427,652,359"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,541,323,566"/>
<area shape="poly" title=" " alt="" coords="666,362,654,409,632,463,599,515,578,537,554,556,523,571,490,580,456,585,422,586,357,581,303,570,304,564,358,575,422,581,456,580,489,575,521,566,551,551,575,533,595,512,627,460,648,407,661,361"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,363,524,389"/>
<area shape="poly" title=" " alt="" coords="585,349,521,365,520,360,584,344"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,389,323,414"/>
<area shape="poly" title=" " alt="" coords="637,358,598,384,553,404,493,416,432,421,374,419,323,415,324,409,374,414,432,415,493,411,552,399,596,379,634,353"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,617,545,642"/>
<area shape="poly" title=" " alt="" coords="667,362,654,414,632,477,600,542,579,573,554,600,524,618,521,614,551,596,574,569,595,540,627,475,649,413,661,361"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,46,535,72"/>
<area shape="poly" title=" " alt="" coords="659,291,644,247,622,194,591,140,551,93,520,75,523,70,554,89,595,137,627,191,649,245,664,290"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,147,546,173"/>
<area shape="poly" title=" " alt="" coords="646,294,605,243,579,217,551,195,514,176,516,171,554,190,583,213,609,240,650,291"/>
<area shape="poly" title=" " alt="" coords="424,240,275,125,278,121,427,236"/>
<area shape="poly" title=" " alt="" coords="374,296,309,313,308,308,373,291"/>
<area shape="poly" title=" " alt="" coords="363,247,306,234,307,229,365,242"/>
<area shape="poly" title=" " alt="" coords="363,272,137,273,137,268,363,266"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,97,94,122"/>
<area shape="poly" title=" " alt="" coords="169,112,95,112,95,107,169,107"/>
<area shape="poly" title=" " alt="" coords="195,240,122,260,120,255,194,235"/>
<area shape="poly" title=" " alt="" coords="401,539,324,548,323,543,400,533"/>
<area shape="poly" title=" " alt="" coords="392,388,324,396,323,391,391,383"/>
<area shape="poly" title=" " alt="" coords="1171,311,1128,318,1127,313,1170,306"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="1203,204,1354,245"/>
<area shape="poly" title=" " alt="" coords="1414,187,1350,206,1349,201,1412,182"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="981,63,1137,103"/>
<area shape="poly" title=" " alt="" coords="1409,146,1137,99,1138,94,1410,141"/>
<area shape="poly" title=" " alt="" coords="1188,236,1004,260,791,296,744,308,742,302,790,291,1004,255,1187,231"/>
<area shape="poly" title=" " alt="" coords="973,61,854,34,782,22,705,13,624,9,541,10,459,19,380,36,349,48,320,65,276,98,272,94,317,60,347,44,378,31,458,13,541,5,624,3,705,8,783,17,855,29,974,56"/>
<area shape="poly" title=" " alt="" coords="1406,227,1354,227,1354,222,1406,222"/>
</map>
</div>

</div>
</div>
<a id="gaf8d438fbf74476572922b31434f3f2e9" name="gaf8d438fbf74476572922b31434f3f2e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf8d438fbf74476572922b31434f3f2e9">&#9670;&#160;</a></span>nc_write_revision_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_revision_info </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write revision information. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000061">Todo:</a></b></dt><dd><p class="startdd">this should only be done for <em>new</em> files that DART creates - performance issue </p>
<p class="enddd">this will change when we move to GIT </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01945">1945</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_cgraph" id="agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_cgraph">
<area shape="rect" title="Write revision information." alt="" coords="5,104,156,145"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="204,104,341,145"/>
<area shape="poly" title=" " alt="" coords="156,122,188,122,188,127,156,127"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="395,71,523,111"/>
<area shape="poly" title=" " alt="" coords="341,109,379,103,380,108,342,115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="389,136,529,177"/>
<area shape="poly" title=" " alt="" coords="342,133,374,139,373,144,341,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="580,5,708,46"/>
<area shape="poly" title=" " alt="" coords="518,68,569,49,571,54,520,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="580,71,708,111"/>
<area shape="poly" title=" " alt="" coords="524,88,565,88,565,94,524,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="577,136,711,161"/>
<area shape="poly" title=" " alt="" coords="525,108,586,128,585,133,523,113"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_icgraph" id="agroup__direct__netcdf__mod_gaf8d438fbf74476572922b31434f3f2e9_icgraph">
<area shape="rect" title="Write revision information." alt="" coords="1604,287,1754,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1400,280,1556,335"/>
<area shape="poly" title=" " alt="" coords="1589,310,1557,310,1557,305,1589,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,296,1349,291,1350,285,1385,291"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,324,1353,329,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga09f849b5b89663f36e43ba4058555515" name="ga09f849b5b89663f36e43ba4058555515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09f849b5b89663f36e43ba4058555515">&#9670;&#160;</a></span>nc_write_variable_att_clamping()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::nc_write_variable_att_clamping </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncvarid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write clamping to variable attributes to files created from scratch. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01860">1860</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_cgraph" id="agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_cgraph">
<area shape="rect" title="Write clamping to variable attributes to files created from scratch." alt="" coords="5,157,150,212"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="214,29,354,70"/>
<area shape="poly" title=" " alt="" coords="105,154,146,117,196,81,207,75,210,79,199,85,150,121,108,158"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="198,119,370,159"/>
<area shape="poly" title=" " alt="" coords="149,166,182,159,183,164,151,171"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="200,208,368,249"/>
<area shape="poly" title=" " alt="" coords="151,197,185,204,184,210,150,202"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="215,273,353,314"/>
<area shape="poly" title=" " alt="" coords="120,210,199,258,212,264,210,269,196,263,118,215"/>
<area shape="poly" title=" " alt="" coords="245,29,243,19,249,10,263,5,284,3,306,5,319,11,317,16,305,10,284,8,264,10,253,15,248,20,250,28"/>
<area shape="poly" title=" " alt="" coords="245,119,243,109,249,100,263,94,284,92,306,94,319,101,317,105,305,100,284,97,264,99,253,104,248,110,250,117"/>
<area shape="poly" title=" " alt="" coords="245,208,243,198,249,189,263,183,284,181,306,184,319,190,317,195,305,189,284,187,264,189,253,193,248,199,250,207"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="424,240,552,281"/>
<area shape="poly" title=" " alt="" coords="352,280,408,271,409,276,353,285"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="418,305,558,346"/>
<area shape="poly" title=" " alt="" coords="353,302,403,310,402,315,352,307"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="609,175,737,215"/>
<area shape="poly" title=" " alt="" coords="547,237,598,218,600,223,549,242"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="609,240,737,281"/>
<area shape="poly" title=" " alt="" coords="553,258,594,258,594,263,553,263"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="606,305,740,331"/>
<area shape="poly" title=" " alt="" coords="554,278,615,297,614,302,552,283"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_icgraph" id="agroup__direct__netcdf__mod_ga09f849b5b89663f36e43ba4058555515_icgraph">
<area shape="rect" title="Write clamping to variable attributes to files created from scratch." alt="" coords="1834,196,1979,252"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="1624,204,1786,245"/>
<area shape="poly" title=" " alt="" coords="1819,227,1787,227,1787,222,1819,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1420,268,1576,324"/>
<area shape="poly" title=" " alt="" coords="1631,253,1577,272,1576,267,1629,248"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1425,139,1571,179"/>
<area shape="poly" title=" " alt="" coords="1624,201,1564,182,1566,177,1625,196"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="1422,204,1574,245"/>
<area shape="poly" title=" " alt="" coords="1608,227,1575,227,1575,222,1608,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1188,337,1369,378"/>
<area shape="poly" title=" " alt="" coords="1406,325,1354,339,1353,334,1405,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1185,272,1372,313"/>
<area shape="poly" title=" " alt="" coords="1404,297,1372,297,1372,291,1404,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="991,305,1127,346"/>
<area shape="poly" title=" " alt="" coords="1172,345,1127,338,1128,333,1173,340"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,305,933,346"/>
<area shape="poly" title=" " alt="" coords="976,328,934,328,934,323,976,323"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,305,743,346"/>
<area shape="poly" title=" " alt="" coords="775,328,743,328,743,323,775,323"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,248,552,289"/>
<area shape="poly" title=" " alt="" coords="585,304,540,292,542,287,586,299"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,97,331,122"/>
<area shape="poly" title=" " alt="" coords="657,292,642,254,619,211,589,170,551,137,498,114,440,102,383,99,332,101,332,96,383,93,441,97,500,109,554,133,593,166,624,208,647,251,662,290"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,311,315,337"/>
<area shape="poly" title=" " alt="" coords="585,328,315,327,315,322,585,323"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,207,306,233"/>
<area shape="poly" title=" " alt="" coords="638,297,599,265,551,239,487,222,421,215,359,214,307,217,306,212,358,209,421,209,488,217,553,234,602,260,642,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,258,137,284"/>
<area shape="poly" title=" " alt="" coords="645,359,605,396,580,413,553,425,451,460,407,471,366,477,324,476,281,468,235,453,183,429,162,415,142,398,111,357,88,317,75,285,79,283,93,314,115,354,146,394,165,411,186,425,237,448,283,463,325,471,365,471,407,466,450,455,551,420,577,408,602,391,642,355"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,515,515,541"/>
<area shape="poly" title=" " alt="" coords="657,361,616,430,588,467,554,498,517,518,514,513,551,494,584,463,612,427,652,359"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,541,323,566"/>
<area shape="poly" title=" " alt="" coords="666,362,654,409,632,463,599,515,578,537,554,556,523,571,490,580,456,585,422,586,357,581,303,570,304,564,358,575,422,581,456,580,489,575,521,566,551,551,575,533,595,512,627,460,648,407,661,361"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,363,524,389"/>
<area shape="poly" title=" " alt="" coords="585,349,521,365,520,360,584,344"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,389,323,414"/>
<area shape="poly" title=" " alt="" coords="637,358,598,384,553,404,493,416,432,421,374,419,323,415,324,409,374,414,432,415,493,411,552,399,596,379,634,353"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,617,545,642"/>
<area shape="poly" title=" " alt="" coords="667,362,654,414,632,477,600,542,579,573,554,600,524,618,521,614,551,596,574,569,595,540,627,475,649,413,661,361"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,46,535,72"/>
<area shape="poly" title=" " alt="" coords="659,291,644,247,622,194,591,140,551,93,520,75,523,70,554,89,595,137,627,191,649,245,664,290"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,147,546,173"/>
<area shape="poly" title=" " alt="" coords="646,294,605,243,579,217,551,195,514,176,516,171,554,190,583,213,609,240,650,291"/>
<area shape="poly" title=" " alt="" coords="424,240,275,125,278,121,427,236"/>
<area shape="poly" title=" " alt="" coords="374,296,309,313,308,308,373,291"/>
<area shape="poly" title=" " alt="" coords="363,247,306,234,307,229,365,242"/>
<area shape="poly" title=" " alt="" coords="363,272,137,273,137,268,363,266"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,97,94,122"/>
<area shape="poly" title=" " alt="" coords="169,112,95,112,95,107,169,107"/>
<area shape="poly" title=" " alt="" coords="195,240,122,260,120,255,194,235"/>
<area shape="poly" title=" " alt="" coords="401,539,324,548,323,543,400,533"/>
<area shape="poly" title=" " alt="" coords="392,388,324,396,323,391,391,383"/>
<area shape="poly" title=" " alt="" coords="1171,311,1128,318,1127,313,1170,306"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="1203,204,1354,245"/>
<area shape="poly" title=" " alt="" coords="1414,187,1350,206,1349,201,1412,182"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="981,63,1137,103"/>
<area shape="poly" title=" " alt="" coords="1409,146,1137,99,1138,94,1410,141"/>
<area shape="poly" title=" " alt="" coords="1188,236,1004,260,791,296,744,308,742,302,790,291,1004,255,1187,231"/>
<area shape="poly" title=" " alt="" coords="973,61,854,34,782,22,705,13,624,9,541,10,459,19,380,36,349,48,320,65,276,98,272,94,317,60,347,44,378,31,458,13,541,5,624,3,705,8,783,17,855,29,974,56"/>
<area shape="poly" title=" " alt="" coords="1406,227,1354,227,1354,222,1406,222"/>
</map>
</div>

</div>
</div>
<a id="ga6de05cb71d2bbee35200331c64f5a4c5" name="ga6de05cb71d2bbee35200331c64f5a4c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6de05cb71d2bbee35200331c64f5a4c5">&#9670;&#160;</a></span>num_elements_on_pe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(i8) function direct_netcdf_mod::num_elements_on_pe </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>block_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sending pe (transpose_write) for a given start_rank and block_size. block_size is the number of elements in a block of variables. There may be 1 variable or all variables depending on buffer_state_io. start_rank is the pe that owns the 1st element of the 1st variable in the variable_block. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000071">Todo:</a></b></dt><dd>FIXME ? This should go in ensemble manager. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l03004">3004</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_cgraph" id="agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_cgraph">
<area shape="rect" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="5,71,154,111"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="202,71,332,111"/>
<area shape="poly" title=" " alt="" coords="154,88,186,88,186,94,154,94"/>
<area shape="poly" title=" " alt="" coords="233,71,231,61,237,52,249,46,267,44,286,46,298,53,295,57,285,52,267,49,250,51,240,56,236,62,238,70"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="380,71,508,111"/>
<area shape="poly" title=" " alt="" coords="332,88,364,88,364,94,332,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="559,5,687,46"/>
<area shape="poly" title=" " alt="" coords="501,68,550,49,552,54,503,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="559,71,687,111"/>
<area shape="poly" title=" " alt="" coords="509,88,544,88,544,94,509,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="556,136,690,161"/>
<area shape="poly" title=" " alt="" coords="509,109,567,128,565,133,508,114"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_icgraph" id="agroup__direct__netcdf__mod_ga6de05cb71d2bbee35200331c64f5a4c5_icgraph">
<area shape="rect" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="1394,367,1542,408"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,367,1117,408"/>
<area shape="poly" title=" " alt="" coords="1378,390,1118,390,1118,385,1378,385"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1167,306,1344,347"/>
<area shape="poly" title=" " alt="" coords="1380,365,1328,350,1329,345,1381,360"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,429,1346,469"/>
<area shape="poly" title=" " alt="" coords="1381,415,1329,430,1328,425,1380,410"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,302,743,343"/>
<area shape="poly" title=" " alt="" coords="965,382,880,372,790,357,742,345,743,340,791,352,881,367,966,377"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,761,552,801"/>
<area shape="poly" title=" " alt="" coords="658,358,555,598,479,761,475,759,550,596,653,356"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,660,331,686"/>
<area shape="poly" title=" " alt="" coords="628,295,574,265,509,240,475,233,441,232,410,239,381,255,372,272,358,313,323,436,265,660,260,659,318,434,353,311,367,270,377,251,408,234,441,227,475,228,510,235,576,260,630,291"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,711,315,736"/>
<area shape="poly" title=" " alt="" coords="609,299,555,282,494,273,463,273,433,278,406,289,381,305,370,318,363,335,354,380,352,436,354,497,355,616,349,664,342,684,333,700,317,713,313,709,329,696,337,682,344,663,350,616,348,497,347,436,349,380,358,334,366,315,377,302,403,284,432,273,462,268,494,267,556,277,611,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,764,306,790"/>
<area shape="poly" title=" " alt="" coords="585,323,525,324,464,329,413,340,394,347,381,356,361,379,348,402,340,425,336,449,340,496,351,545,363,595,369,646,368,672,362,698,350,724,333,751,322,761,308,769,305,764,318,757,329,747,346,722,356,696,362,671,364,646,358,596,346,546,335,497,331,449,335,424,343,400,357,376,377,352,392,342,412,335,464,324,524,319,584,318"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,789,137,815"/>
<area shape="poly" title=" " alt="" coords="661,287,648,241,627,187,595,136,575,114,551,96,506,75,467,69,427,77,380,97,338,120,304,144,278,169,257,196,223,262,187,347,170,398,162,442,159,482,160,521,161,601,154,647,139,699,113,751,85,791,81,787,108,748,134,697,149,646,155,601,155,521,154,482,156,441,165,396,182,345,218,259,252,193,274,165,301,139,335,115,378,92,425,72,467,64,508,70,554,92,578,110,599,133,632,185,654,239,666,286"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,5,538,31"/>
<area shape="poly" title=" " alt="" coords="661,287,649,235,627,172,595,108,574,78,551,52,521,34,524,29,554,48,579,75,600,105,632,170,654,234,667,286"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,107,514,132"/>
<area shape="poly" title=" " alt="" coords="652,289,612,221,584,185,551,154,513,134,516,129,554,149,588,181,616,218,657,286"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,359,323,384"/>
<area shape="poly" title=" " alt="" coords="647,291,607,243,581,221,551,205,504,187,465,180,426,186,380,205,357,219,337,238,304,282,280,325,266,359,261,357,275,323,299,279,333,234,354,215,378,200,424,180,465,175,506,182,553,200,584,217,611,239,651,287"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,927,323,952"/>
<area shape="poly" title=" " alt="" coords="586,348,553,357,500,364,457,364,437,366,418,371,400,382,381,400,363,432,353,478,347,533,345,593,344,712,341,763,334,803,320,840,302,875,271,928,266,925,298,872,315,838,328,801,336,762,339,712,340,593,342,533,347,477,358,431,377,397,397,378,416,366,436,361,456,359,500,358,552,352,585,343"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,411,545,436"/>
<area shape="poly" title=" " alt="" coords="627,353,553,394,508,413,506,408,551,389,624,349"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,460,535,486"/>
<area shape="poly" title=" " alt="" coords="650,357,609,406,583,430,554,451,531,462,529,457,551,447,579,426,605,402,646,354"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,509,546,535"/>
<area shape="poly" title=" " alt="" coords="658,358,641,392,618,430,589,468,554,500,534,511,532,506,551,496,585,465,614,427,637,390,653,356"/>
<area shape="poly" title=" " alt="" coords="421,754,378,726,330,701,301,689,303,684,332,696,380,722,424,749"/>
<area shape="poly" title=" " alt="" coords="375,759,307,740,308,734,376,753"/>
<area shape="poly" title=" " alt="" coords="363,782,307,780,307,775,363,776"/>
<area shape="poly" title=" " alt="" coords="364,801,331,805,229,809,137,808,137,802,229,803,331,800,363,796"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,660,94,686"/>
<area shape="poly" title=" " alt="" coords="169,676,95,676,95,670,169,670"/>
<area shape="poly" title=" " alt="" coords="195,788,138,796,137,791,194,783"/>
<area shape="poly" title=" " alt="" coords="405,138,381,154,357,178,336,205,302,264,279,319,265,359,260,357,274,317,297,262,331,202,353,174,377,149,402,134"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,302,1117,343"/>
<area shape="poly" title=" " alt="" coords="1151,327,1118,326,1118,321,1152,321"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,302,933,343"/>
<area shape="poly" title=" " alt="" coords="966,325,933,325,933,320,966,320"/>
<area shape="poly" title=" " alt="" coords="775,325,743,325,743,320,775,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,487,1117,528"/>
<area shape="poly" title=" " alt="" coords="1168,476,1119,491,1117,486,1167,471"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,543,933,584"/>
<area shape="poly" title=" " alt="" coords="967,535,933,545,931,540,965,530"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,653,743,693"/>
<area shape="poly" title=" " alt="" coords="813,594,710,654,707,650,810,590"/>
<area shape="poly" title=" " alt="" coords="625,704,554,745,517,762,515,757,551,740,623,699"/>
<area shape="poly" title=" " alt="" coords="585,676,331,676,331,670,585,670"/>
<area shape="poly" title=" " alt="" coords="585,686,315,719,314,714,584,681"/>
<area shape="poly" title=" " alt="" coords="655,708,638,736,615,766,587,794,553,815,518,827,481,833,444,833,407,828,339,812,287,793,289,788,341,807,408,823,444,827,481,827,517,822,551,810,583,790,611,763,634,733,651,705"/>
<area shape="poly" title=" " alt="" coords="659,709,643,742,620,778,590,812,554,838,494,861,430,872,366,874,302,869,242,858,188,845,105,818,106,813,189,840,243,853,303,863,366,869,430,867,492,856,551,833,586,808,615,775,638,739,654,706"/>
<area shape="poly" title=" " alt="" coords="584,661,465,634,413,618,377,599,351,574,329,546,294,485,272,427,260,385,265,384,277,425,299,482,333,543,355,571,381,595,415,613,467,629,585,656"/>
<area shape="poly" title=" " alt="" coords="666,709,653,756,631,811,599,866,578,889,554,910,527,925,498,937,437,951,377,954,323,952,324,946,377,949,436,945,496,932,525,921,551,905,574,886,595,862,626,809,648,755,661,708"/>
<area shape="poly" title=" " alt="" coords="659,638,644,594,622,543,591,493,572,470,551,450,533,439,536,435,554,445,576,466,595,490,627,541,649,593,664,636"/>
<area shape="poly" title=" " alt="" coords="653,639,637,605,614,568,585,530,551,499,532,489,534,484,554,495,589,527,618,565,641,603,658,637"/>
<area shape="poly" title=" " alt="" coords="646,641,605,593,579,569,551,548,529,538,531,533,554,544,583,565,609,589,650,638"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,559,515,584"/>
<area shape="poly" title=" " alt="" coords="624,646,551,606,506,587,508,582,553,601,627,642"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,977,524,1003"/>
<area shape="poly" title=" " alt="" coords="667,709,655,763,634,830,601,899,580,931,554,960,524,979,521,975,551,956,575,928,597,897,629,828,650,762,662,708"/>
<area shape="poly" title=" " alt="" coords="400,562,377,550,335,510,302,463,277,419,262,386,267,384,282,417,306,461,339,506,381,545,403,557"/>
<area shape="poly" title=" " alt="" coords="394,976,313,956,314,950,396,970"/>
</map>
</div>

</div>
</div>
<a id="ga1bde9358fa6fadc774d471d0bec36553" name="ga1bde9358fa6fadc774d471d0bec36553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1bde9358fa6fadc774d471d0bec36553">&#9670;&#160;</a></span>read_single_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::read_single_file </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>file_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_time_from_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>pert_from_single_copy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read a single netcdf file containing all of the members and possibly inflation information </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000043">Todo:</a></b></dt><dd>: only a single domain for single file read supported. need <br  />
 to consider case for multiple domains. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000044">Todo:</a></b></dt><dd>Check time consistency across files? This is assuming they are consistent. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000045">Todo:</a></b></dt><dd>FIXME : just reading and distributing one variable at a time. <br  />
 Should probably do this in a block? </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00474">474</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_cgraph" id="agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_cgraph">
<area shape="rect" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="5,645,142,686"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga13ebb0777e5db14d4e6915b13b652b23" title="we&#39;re in read_single_file &#45; there better be multiple members or we can&#39;t read in an ensemble from thi..." alt="" coords="190,146,386,187"/>
<area shape="poly" title=" " alt="" coords="75,644,88,551,113,420,146,291,166,239,188,204,198,194,202,198,192,207,171,242,151,292,118,421,94,552,80,645"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="923,741,1051,782"/>
<area shape="poly" title=" " alt="" coords="73,644,82,536,102,380,117,301,136,229,159,171,173,149,188,133,274,72,317,49,359,31,401,17,443,8,485,3,526,3,568,8,609,17,650,31,692,49,774,97,857,163,872,181,886,205,912,268,933,345,950,430,974,599,986,725,980,726,968,600,945,431,927,346,907,269,882,208,868,184,853,167,771,102,689,53,648,36,608,22,567,13,526,9,485,9,444,13,402,22,361,36,319,54,277,77,191,137,177,152,164,173,141,230,122,302,107,381,87,536,79,645"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="455,204,592,244"/>
<area shape="poly" title=" " alt="" coords="75,644,89,560,113,445,128,387,146,335,166,292,188,263,216,244,246,229,279,218,312,211,379,206,440,208,440,213,379,211,313,216,280,223,248,234,218,248,192,267,170,295,151,337,133,389,118,446,94,561,80,645"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="220,336,356,376"/>
<area shape="poly" title=" " alt="" coords="75,644,85,593,105,524,138,451,161,417,188,387,204,375,208,380,191,391,165,421,143,454,110,526,90,594,80,645"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="459,460,589,500"/>
<area shape="poly" title=" " alt="" coords="76,644,90,566,114,461,147,361,167,323,188,298,214,281,238,270,262,264,285,263,333,274,387,298,430,327,464,366,491,407,510,444,506,447,487,410,460,369,426,331,385,302,331,279,285,269,262,270,240,275,216,286,191,302,171,326,152,363,119,462,95,567,81,645"/>
<area shape="rect" href="group__io__filenames__mod.html#gaa18cdd7babc2d4407b56a32660feb0ba" title="set netcdf file type" alt="" coords="212,1028,364,1068"/>
<area shape="poly" title=" " alt="" coords="80,686,89,743,109,822,142,909,165,951,192,989,225,1017,222,1022,188,992,160,954,137,912,104,824,84,744,75,686"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac25ed7ba0ea54f5ac988274990c2f955" title="helper function to return the netcdf dimension id&#39;s and lengths" alt="" coords="220,1118,356,1159"/>
<area shape="poly" title=" " alt="" coords="78,686,83,757,100,859,115,916,134,973,160,1028,192,1078,207,1095,225,1108,222,1112,204,1099,188,1082,155,1031,129,975,110,918,95,861,78,758,73,686"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="218,645,358,686"/>
<area shape="poly" title=" " alt="" coords="142,663,202,663,202,668,142,668"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="220,401,356,442"/>
<area shape="poly" title=" " alt="" coords="78,644,92,604,114,553,146,499,166,474,188,453,204,441,207,446,191,457,170,478,150,502,119,555,97,606,83,646"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="212,1208,364,1248"/>
<area shape="poly" title=" " alt="" coords="77,686,78,770,91,896,105,967,125,1038,154,1106,192,1169,206,1184,223,1197,220,1201,202,1188,188,1172,149,1109,120,1040,99,968,85,897,72,771,71,686"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693" title="Give the rank of the processor that owns the start of a variable." alt="" coords="220,556,356,596"/>
<area shape="poly" title=" " alt="" coords="114,642,189,607,207,600,209,605,191,612,116,647"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="218,1297,358,1338"/>
<area shape="poly" title=" " alt="" coords="79,685,91,801,113,971,129,1060,147,1142,168,1210,192,1258,205,1274,222,1286,219,1291,202,1278,187,1261,163,1212,142,1143,124,1061,108,972,85,801,74,686"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="218,734,358,775"/>
<area shape="poly" title=" " alt="" coords="125,684,224,725,222,730,123,689"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="693,741,823,782"/>
<area shape="poly" title=" " alt="" coords="89,684,129,738,158,764,191,784,217,789,264,791,395,787,677,766,678,771,395,792,264,796,217,794,189,789,154,768,125,741,85,688"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="214,466,362,507"/>
<area shape="poly" title=" " alt="" coords="84,643,125,581,154,547,188,518,199,511,201,516,191,522,158,551,129,585,88,646"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad4f365fad4bff8aeef537b79fa8c65c6" title="Send elements of variables to a processor. This routine must be called with a corresponding &#39;wait_to_..." alt="" coords="214,849,362,890"/>
<area shape="poly" title=" " alt="" coords="87,685,126,755,156,794,191,829,207,839,204,844,188,833,152,797,122,757,82,687"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga7b0931795ec7b987d9782e4998a62b51" title="Receive data from a reader. Start and finish are the local indicies in the copies array for the data ..." alt="" coords="220,938,356,979"/>
<area shape="poly" title=" " alt="" coords="83,685,97,728,119,784,151,845,192,899,228,928,224,932,188,903,146,847,115,787,92,730,78,687"/>
<area shape="poly" title=" " alt="" coords="386,158,510,154,649,156,715,162,773,171,822,185,856,205,871,221,885,243,910,300,930,371,948,450,972,607,985,726,980,726,967,608,942,451,925,372,905,302,880,245,867,224,853,209,820,190,772,176,714,167,648,162,510,159,387,163"/>
<area shape="poly" title=" " alt="" coords="375,185,441,201,439,206,373,190"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1122,676,1249,716"/>
<area shape="poly" title=" " alt="" coords="1050,738,1107,719,1108,724,1052,743"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1122,741,1249,782"/>
<area shape="poly" title=" " alt="" coords="1051,759,1107,759,1107,764,1051,764"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1119,806,1252,831"/>
<area shape="poly" title=" " alt="" coords="1052,777,1125,798,1123,804,1051,782"/>
<area shape="poly" title=" " alt="" coords="593,206,654,198,724,198,760,204,794,213,827,227,856,247,883,282,907,334,927,399,944,471,970,615,984,725,979,726,965,616,939,472,922,400,902,336,879,285,853,251,824,232,793,218,759,209,724,204,655,203,593,211"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="688,261,828,302"/>
<area shape="poly" title=" " alt="" coords="593,238,673,258,672,263,592,243"/>
<area shape="poly" title=" " alt="" coords="247,336,245,326,252,317,266,311,288,309,311,311,325,318,323,322,310,317,288,314,267,316,255,321,250,327,252,334"/>
<area shape="poly" title=" " alt="" coords="357,374,387,387,439,417,485,448,482,452,436,421,385,392,355,379"/>
<area shape="poly" title=" " alt="" coords="590,497,718,547,789,583,856,624,915,676,962,727,958,730,911,679,853,629,786,587,715,552,588,502"/>
<area shape="poly" title=" " alt="" coords="480,460,477,450,485,441,500,435,524,433,549,435,564,442,562,447,548,441,524,438,501,440,488,445,483,451,485,458"/>
<area shape="poly" title=" " alt="" coords="247,1028,245,1018,252,1009,266,1003,288,1001,311,1003,325,1010,323,1014,310,1009,288,1006,267,1008,255,1013,250,1019,252,1026"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="454,1321,594,1362"/>
<area shape="poly" title=" " alt="" coords="358,1151,388,1170,400,1184,408,1198,414,1226,420,1253,436,1282,468,1310,465,1314,432,1286,415,1255,409,1227,403,1200,396,1187,384,1174,355,1156"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="454,1142,594,1183"/>
<area shape="poly" title=" " alt="" coords="357,1143,438,1151,438,1157,356,1148"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="454,1232,594,1272"/>
<area shape="poly" title=" " alt="" coords="357,1157,387,1170,479,1221,477,1225,385,1174,354,1162"/>
<area shape="poly" title=" " alt="" coords="480,1321,477,1311,485,1302,500,1296,524,1294,549,1297,564,1303,562,1308,548,1302,524,1300,501,1302,488,1306,483,1312,485,1320"/>
<area shape="poly" title=" " alt="" coords="480,1142,477,1132,485,1123,500,1118,524,1116,549,1118,564,1124,562,1129,548,1123,524,1121,501,1123,488,1128,483,1134,485,1141"/>
<area shape="poly" title=" " alt="" coords="480,1232,477,1222,485,1213,500,1207,524,1205,549,1207,564,1214,562,1219,548,1213,524,1210,501,1212,488,1217,483,1223,485,1230"/>
<area shape="poly" title=" " alt="" coords="247,645,245,635,252,626,266,620,288,618,311,621,325,627,323,632,310,626,288,624,267,626,255,630,250,636,252,644"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="454,614,594,655"/>
<area shape="poly" title=" " alt="" coords="358,654,437,643,438,648,359,659"/>
<area shape="poly" title=" " alt="" coords="594,626,652,626,719,629,788,639,856,659,885,673,912,690,957,728,954,732,909,695,882,677,854,664,787,645,718,635,652,631,594,632"/>
<area shape="poly" title=" " alt="" coords="357,436,444,457,442,463,356,441"/>
<area shape="poly" title=" " alt="" coords="247,1208,245,1198,252,1189,266,1183,288,1181,311,1183,325,1190,323,1194,310,1189,288,1186,267,1188,255,1193,250,1199,252,1206"/>
<area shape="poly" title=" " alt="" coords="335,553,433,511,451,504,453,509,435,516,337,558"/>
<area shape="poly" title=" " alt="" coords="247,556,245,546,252,537,266,531,288,529,311,531,325,538,323,542,310,537,288,534,267,536,255,541,250,547,252,554"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="434,549,613,590"/>
<area shape="poly" title=" " alt="" coords="357,571,418,570,418,575,357,577"/>
<area shape="poly" title=" " alt="" coords="480,549,477,539,485,530,500,524,524,522,549,525,564,531,562,536,548,530,524,528,501,530,488,534,483,540,485,548"/>
<area shape="poly" title=" " alt="" coords="247,1297,245,1287,252,1278,266,1272,288,1270,311,1273,325,1279,323,1284,310,1278,288,1276,267,1278,255,1282,250,1288,252,1296"/>
<area shape="poly" title=" " alt="" coords="358,733,456,712,580,695,648,690,718,688,787,693,855,703,897,715,936,731,934,736,895,720,854,708,787,698,718,694,648,695,581,700,457,718,359,739"/>
<area shape="poly" title=" " alt="" coords="322,732,433,671,457,659,460,664,435,676,325,736"/>
<area shape="poly" title=" " alt="" coords="247,734,245,724,252,715,266,710,288,708,311,710,325,716,323,721,310,715,288,713,267,715,255,720,250,725,252,733"/>
<area shape="poly" title=" " alt="" coords="824,759,907,759,907,764,824,764"/>
<area shape="poly" title=" " alt="" coords="715,741,713,731,720,722,735,716,758,714,783,717,797,723,795,728,781,722,758,720,736,722,723,726,718,732,720,740"/>
<area shape="poly" title=" " alt="" coords="362,482,443,480,443,485,362,487"/>
<area shape="poly" title=" " alt="" coords="362,849,434,835,552,820,644,813,737,807,854,791,908,779,909,785,855,796,737,812,645,819,552,825,434,840,363,854"/>
<area shape="poly" title=" " alt="" coords="323,846,356,820,384,785,400,747,406,712,405,678,401,646,398,613,399,581,409,547,432,512,444,501,447,505,436,515,414,549,405,581,403,613,406,645,410,678,411,712,405,749,388,788,359,824,326,850"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="441,938,607,979"/>
<area shape="poly" title=" " alt="" coords="345,888,455,930,453,935,343,893"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="459,849,589,890"/>
<area shape="poly" title=" " alt="" coords="362,867,443,867,443,872,362,872"/>
<area shape="poly" title=" " alt="" coords="480,938,477,928,485,919,500,914,524,912,549,914,564,920,562,925,548,919,524,917,501,919,488,924,483,930,485,937"/>
<area shape="poly" title=" " alt="" coords="589,868,714,862,785,852,854,835,902,814,944,788,947,793,904,819,856,840,786,857,714,868,589,874"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="661,907,855,933"/>
<area shape="poly" title=" " alt="" coords="589,881,681,901,680,906,588,886"/>
<area shape="poly" title=" " alt="" coords="812,904,853,886,883,865,911,840,957,792,961,796,915,844,887,869,856,890,814,909"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="903,984,1071,1024"/>
<area shape="poly" title=" " alt="" coords="797,931,916,975,914,980,795,936"/>
<area shape="poly" title=" " alt="" coords="357,974,434,988,528,992,650,988,711,982,768,973,817,960,853,943,892,911,925,871,950,830,969,794,973,797,955,833,929,874,896,914,856,948,819,965,769,978,712,987,650,993,528,998,434,993,356,979"/>
<area shape="poly" title=" " alt="" coords="357,956,425,956,425,961,357,961"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="459,1053,589,1094"/>
<area shape="poly" title=" " alt="" coords="357,975,387,990,412,1011,436,1032,455,1044,453,1048,432,1037,408,1015,385,994,355,980"/>
<area shape="poly" title=" " alt="" coords="589,1057,747,1021,816,1002,853,987,876,967,897,944,931,892,956,840,973,795,978,797,961,842,935,894,901,947,880,971,856,992,818,1007,748,1026,590,1062"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="661,1083,855,1109"/>
<area shape="poly" title=" " alt="" coords="589,1077,646,1082,646,1088,589,1082"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="729,1132,787,1158"/>
<area shape="poly" title=" " alt="" coords="581,1092,662,1119,715,1133,714,1138,661,1124,579,1097"/>
<area shape="poly" title=" " alt="" coords="791,1080,823,1063,853,1038,882,994,914,927,970,795,975,797,919,930,886,996,857,1042,826,1067,794,1085"/>
<area shape="poly" title=" " alt="" coords="791,1080,919,1028,921,1033,793,1085"/>
<area shape="poly" title=" " alt="" coords="720,1084,713,1075,717,1065,733,1059,758,1056,786,1059,800,1066,798,1071,785,1064,758,1062,734,1064,721,1069,718,1074,724,1081"/>
<area shape="rect" href="bort_8f.html#adc4659c5e9171f22248cf61e054ddd17" title=" " alt="" coords="965,1132,1009,1158"/>
<area shape="poly" title=" " alt="" coords="787,1143,950,1143,950,1148,787,1148"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_icgraph" id="agroup__direct__netcdf__mod_ga1bde9358fa6fadc774d471d0bec36553_icgraph">
<area shape="rect" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="791,287,927,328"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga5e6a92968fe0fa12010bff633ab92549" name="ga5e6a92968fe0fa12010bff633ab92549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e6a92968fe0fa12010bff633ab92549">&#9670;&#160;</a></span>read_transpose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::read_transpose </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>read_single_vars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read and transpose variables in cyclic-cyclic distribution (round robbin) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">state_ens_handle</td><td>Ensemble handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name_handle</td><td>Name handle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">domain</td><td>Which domain to read </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dart_index</td><td>This is for multiple domains </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">read_single_vars</td><td>Read one variable at a time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00166">166</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_cgraph" id="agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_cgraph">
<area shape="rect" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="5,638,142,679"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="193,638,370,679"/>
<area shape="poly" title=" " alt="" coords="142,656,177,656,177,661,142,661"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="660,499,790,540"/>
<area shape="poly" title=" " alt="" coords="84,636,128,565,201,466,248,415,300,366,358,324,420,290,467,272,507,263,527,263,547,267,589,291,608,310,617,330,620,350,620,372,620,415,625,438,637,461,667,488,664,492,633,464,620,440,614,416,615,372,615,351,612,331,603,313,586,295,545,272,526,268,508,268,468,277,422,295,360,328,303,371,251,419,205,470,132,568,88,639"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5bd1c0ced6a496672242e6b11e230b18" title="Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills ..." alt="" coords="190,1005,373,1045"/>
<area shape="poly" title=" " alt="" coords="89,678,263,989,259,992,84,680"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="436,638,572,679"/>
<area shape="poly" title=" " alt="" coords="370,656,420,656,420,661,370,661"/>
<area shape="poly" title=" " alt="" coords="334,677,388,693,453,705,487,707,521,706,555,699,586,688,626,661,660,625,686,587,706,552,710,555,691,590,664,628,630,665,589,693,556,705,522,711,487,713,452,711,387,699,332,682"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="434,777,574,817"/>
<area shape="poly" title=" " alt="" coords="317,677,458,766,455,770,314,681"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="436,483,572,524"/>
<area shape="poly" title=" " alt="" coords="300,635,352,586,420,535,430,529,432,533,422,539,355,590,304,639"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="428,915,580,956"/>
<area shape="poly" title=" " alt="" coords="295,677,345,766,381,820,423,871,460,904,457,908,419,875,377,823,340,769,290,680"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693" title="Give the rank of the processor that owns the start of a variable." alt="" coords="436,418,572,459"/>
<area shape="poly" title=" " alt="" coords="291,636,340,556,376,510,419,469,427,464,430,469,423,474,380,514,344,559,295,639"/>
<area shape="rect" href="group__state__structure__mod.html#ga91113dc7ea473460732b592efbe08eeb" title="Returns the number of elements in range of start_var and end_var." alt="" coords="434,329,574,369"/>
<area shape="poly" title=" " alt="" coords="285,637,300,586,327,518,366,445,391,411,419,380,424,376,428,380,423,384,395,414,370,448,332,520,305,588,290,638"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="656,941,794,981"/>
<area shape="poly" title=" " alt="" coords="296,677,345,751,381,792,423,827,445,839,465,847,504,853,543,858,565,865,589,877,604,889,614,902,623,913,637,925,646,931,643,935,634,930,619,917,609,905,600,893,586,882,563,870,542,863,503,858,464,852,443,844,419,831,377,795,341,754,292,680"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="430,549,578,589"/>
<area shape="poly" title=" " alt="" coords="333,635,436,593,438,598,335,640"/>
<area shape="rect" href="group__io__filenames__mod.html#gadfeeb6444bd6eba53b227209efced814" title="returns true/false depending on whether you should read this copy" alt="" coords="421,1005,587,1045"/>
<area shape="poly" title=" " alt="" coords="290,678,306,733,333,807,372,889,396,929,423,966,454,994,450,997,419,969,392,932,367,892,328,809,301,734,285,680"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5ff418907b25b36edeaf6a7bae9f42a2" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="436,1209,572,1249"/>
<area shape="poly" title=" " alt="" coords="291,678,362,938,401,1076,423,1145,443,1172,466,1196,463,1200,439,1176,419,1147,396,1078,356,939,286,679"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad4f365fad4bff8aeef537b79fa8c65c6" title="Send elements of variables to a processor. This routine must be called with a corresponding &#39;wait_to_..." alt="" coords="431,190,578,231"/>
<area shape="poly" title=" " alt="" coords="285,637,301,575,328,487,367,388,392,338,419,291,440,264,464,239,468,243,444,267,423,294,396,341,372,390,333,489,306,577,290,638"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga7b0931795ec7b987d9782e4998a62b51" title="Receive data from a reader. Start and finish are the local indicies in the copies array for the data ..." alt="" coords="436,125,572,165"/>
<area shape="poly" title=" " alt="" coords="280,637,284,554,291,497,302,432,320,365,344,298,377,234,419,176,422,173,426,177,423,180,381,236,349,300,325,366,308,433,296,497,290,555,285,638"/>
<area shape="poly" title=" " alt="" coords="462,638,460,628,467,619,482,613,504,611,528,614,542,620,540,625,527,619,504,616,483,618,470,623,466,629,468,637"/>
<area shape="poly" title=" " alt="" coords="537,635,676,546,679,551,540,640"/>
<area shape="poly" title=" " alt="" coords="683,499,681,489,688,480,703,475,725,473,749,475,763,481,761,486,748,480,725,478,704,480,691,484,686,490,688,498"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1124,301,1252,341"/>
<area shape="poly" title=" " alt="" coords="774,496,1124,345,1126,350,776,501"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1323,235,1451,276"/>
<area shape="poly" title=" " alt="" coords="1251,297,1308,279,1310,284,1253,303"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1323,301,1451,341"/>
<area shape="poly" title=" " alt="" coords="1253,318,1308,318,1308,324,1253,324"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1320,365,1454,391"/>
<area shape="poly" title=" " alt="" coords="1253,337,1326,358,1325,363,1252,342"/>
<area shape="poly" title=" " alt="" coords="462,776,460,767,467,757,482,752,504,750,528,752,542,758,540,763,527,757,504,755,483,757,470,762,466,768,468,775"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="889,691,1030,732"/>
<area shape="poly" title=" " alt="" coords="532,774,579,746,635,722,696,709,759,703,874,702,874,707,759,708,697,715,636,727,581,750,535,778"/>
<area shape="poly" title=" " alt="" coords="970,690,1165,353,1170,356,975,692"/>
<area shape="poly" title=" " alt="" coords="573,506,644,511,644,516,573,511"/>
<area shape="poly" title=" " alt="" coords="462,915,460,905,467,896,482,891,504,889,528,891,542,897,540,902,527,896,504,894,483,896,470,900,466,906,468,914"/>
<area shape="poly" title=" " alt="" coords="563,457,654,491,653,496,561,462"/>
<area shape="poly" title=" " alt="" coords="462,418,460,408,467,399,482,393,504,391,528,394,542,400,540,405,527,399,504,396,483,398,470,403,466,409,468,417"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="635,410,815,451"/>
<area shape="poly" title=" " alt="" coords="573,433,620,431,620,437,573,438"/>
<area shape="poly" title=" " alt="" coords="683,410,681,400,688,391,703,385,725,383,749,386,763,392,761,397,748,391,725,388,704,390,691,395,686,401,688,409"/>
<area shape="poly" title=" " alt="" coords="462,328,460,319,467,309,482,304,504,302,528,304,542,310,540,315,527,309,504,307,483,309,470,314,466,320,468,327"/>
<area shape="poly" title=" " alt="" coords="793,942,952,900,1019,879,1054,862,1079,824,1101,767,1121,698,1139,622,1165,471,1180,356,1186,357,1170,472,1144,623,1126,700,1106,769,1084,826,1058,865,1021,884,953,906,795,947"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="889,941,1030,981"/>
<area shape="poly" title=" " alt="" coords="794,958,874,958,874,964,794,964"/>
<area shape="poly" title=" " alt="" coords="578,550,644,535,645,540,579,555"/>
<area shape="poly" title=" " alt="" coords="462,1004,460,995,467,985,482,980,504,978,528,980,542,986,540,991,527,985,504,983,483,985,470,990,466,996,468,1003"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="640,737,810,777"/>
<area shape="poly" title=" " alt="" coords="545,1002,567,986,585,966,598,943,604,921,606,880,610,838,618,816,633,794,643,784,647,788,637,797,623,819,615,839,612,880,609,922,603,945,589,969,570,990,548,1006"/>
<area shape="poly" title=" " alt="" coords="565,1206,585,1188,601,1163,608,1139,608,1091,606,1067,608,1043,616,1018,633,992,642,984,645,988,637,996,621,1020,613,1044,612,1067,613,1091,613,1140,606,1166,589,1192,568,1210"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="655,1453,795,1493"/>
<area shape="poly" title=" " alt="" coords="519,1248,566,1326,599,1371,637,1414,673,1442,670,1446,634,1417,595,1375,561,1328,514,1251"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="889,1481,1030,1521"/>
<area shape="poly" title=" " alt="" coords="511,1249,521,1303,542,1374,559,1411,580,1446,606,1477,637,1503,664,1517,694,1527,756,1535,818,1532,875,1523,876,1528,819,1538,756,1540,693,1532,662,1522,634,1507,602,1481,575,1449,554,1414,537,1376,515,1305,505,1250"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="655,1363,795,1404"/>
<area shape="poly" title=" " alt="" coords="534,1247,637,1324,679,1352,676,1357,634,1328,530,1252"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="638,1030,812,1071"/>
<area shape="poly" title=" " alt="" coords="562,1206,585,1188,602,1162,608,1136,614,1109,622,1095,633,1082,639,1077,642,1081,637,1085,626,1098,619,1111,613,1137,607,1164,589,1192,565,1210"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="655,1119,795,1160"/>
<area shape="poly" title=" " alt="" coords="551,1206,634,1170,652,1163,654,1168,636,1175,553,1211"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="655,875,795,916"/>
<area shape="poly" title=" " alt="" coords="531,1206,560,1179,585,1145,598,1114,603,1086,602,1033,602,1007,605,982,614,955,633,927,641,920,644,924,637,931,619,957,610,983,607,1008,607,1033,608,1086,603,1116,590,1147,564,1182,535,1210"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="655,1209,795,1249"/>
<area shape="poly" title=" " alt="" coords="573,1226,639,1226,639,1232,573,1232"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5cfe0a8ae9bd2d3677457afeeb15226e" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="646,1274,804,1315"/>
<area shape="poly" title=" " alt="" coords="574,1246,640,1266,639,1271,572,1252"/>
<area shape="poly" title=" " alt="" coords="683,1452,681,1443,688,1433,703,1428,725,1426,749,1428,763,1434,761,1439,748,1433,725,1431,704,1433,691,1438,686,1444,688,1451"/>
<area shape="poly" title=" " alt="" coords="796,1479,874,1488,873,1493,795,1484"/>
<area shape="poly" title=" " alt="" coords="916,1480,914,1471,921,1461,936,1456,959,1454,984,1456,999,1462,997,1467,983,1461,959,1459,938,1461,924,1466,919,1472,921,1479"/>
<area shape="poly" title=" " alt="" coords="683,1363,681,1353,688,1344,703,1339,725,1337,749,1339,763,1345,761,1350,748,1344,725,1342,704,1344,691,1348,686,1354,688,1362"/>
<area shape="poly" title=" " alt="" coords="683,1030,681,1020,688,1011,703,1005,725,1003,749,1006,763,1012,761,1017,748,1011,725,1008,704,1010,691,1015,686,1021,688,1029"/>
<area shape="poly" title=" " alt="" coords="683,1119,681,1109,688,1100,703,1095,725,1093,749,1095,763,1101,761,1106,748,1100,725,1098,704,1100,691,1104,686,1110,688,1118"/>
<area shape="poly" title=" " alt="" coords="795,879,857,860,927,832,995,793,1026,769,1054,742,1088,696,1116,645,1137,591,1154,536,1174,434,1183,357,1188,357,1180,435,1159,537,1142,592,1120,647,1093,699,1058,745,1030,773,998,798,929,837,859,865,796,884"/>
<area shape="poly" title=" " alt="" coords="759,872,813,831,836,802,861,772,906,738,909,743,865,776,841,805,817,835,762,877"/>
<area shape="poly" title=" " alt="" coords="683,875,681,865,688,856,703,851,725,849,749,851,763,857,761,862,748,856,725,854,704,856,691,860,686,866,688,874"/>
<area shape="poly" title=" " alt="" coords="683,1208,681,1199,688,1189,703,1184,725,1182,749,1184,763,1190,761,1195,748,1189,725,1187,704,1189,691,1194,686,1200,688,1207"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="889,1185,1030,1225"/>
<area shape="poly" title=" " alt="" coords="783,1271,814,1258,862,1236,880,1229,882,1234,864,1241,816,1263,785,1276"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="877,1274,1042,1315"/>
<area shape="poly" title=" " alt="" coords="805,1292,861,1292,861,1297,805,1297"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="889,1363,1030,1404"/>
<area shape="poly" title=" " alt="" coords="783,1313,816,1325,892,1355,890,1360,814,1330,781,1318"/>
<area shape="poly" title=" " alt="" coords="916,1184,914,1175,921,1165,936,1160,959,1158,984,1160,999,1166,997,1171,983,1165,959,1163,938,1165,924,1170,919,1176,921,1183"/>
<area shape="poly" title=" " alt="" coords="916,1274,914,1264,921,1255,936,1249,959,1247,984,1250,999,1256,997,1261,983,1255,959,1252,938,1254,924,1259,919,1265,921,1273"/>
<area shape="poly" title=" " alt="" coords="916,1363,914,1353,921,1344,936,1339,959,1337,984,1339,999,1345,997,1350,983,1344,959,1342,938,1344,924,1348,919,1354,921,1362"/>
<area shape="poly" title=" " alt="" coords="568,229,589,247,607,275,615,302,617,329,616,354,616,406,622,432,637,461,666,488,663,492,633,464,617,434,610,406,611,354,612,329,610,303,602,278,585,251,565,233"/>
<area shape="poly" title=" " alt="" coords="562,229,589,247,605,268,612,288,620,306,637,321,695,347,758,363,822,371,886,372,949,369,1008,361,1108,341,1109,346,1009,366,949,374,886,378,821,376,757,368,693,352,634,326,615,309,607,290,600,270,586,251,559,233"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="642,206,808,247"/>
<area shape="poly" title=" " alt="" coords="578,213,627,216,627,222,578,218"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="660,271,790,312"/>
<area shape="poly" title=" " alt="" coords="563,229,654,263,653,268,561,234"/>
<area shape="poly" title=" " alt="" coords="683,206,681,196,688,187,703,181,725,179,749,182,763,188,761,193,748,187,725,184,704,186,691,191,686,197,688,205"/>
<area shape="poly" title=" " alt="" coords="791,293,1109,313,1108,318,790,298"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="863,128,1056,154"/>
<area shape="poly" title=" " alt="" coords="788,268,813,256,880,209,932,162,936,166,883,213,816,260,790,273"/>
<area shape="poly" title=" " alt="" coords="1018,152,1057,171,1091,197,1121,227,1168,286,1163,289,1117,231,1088,201,1055,175,1016,157"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="1104,97,1272,137"/>
<area shape="poly" title=" " alt="" coords="1056,128,1088,125,1089,130,1057,133"/>
<area shape="poly" title=" " alt="" coords="572,134,627,132,690,135,754,146,816,168,832,180,842,194,850,208,864,221,898,235,961,255,1110,297,1108,302,960,260,897,240,861,226,846,212,837,197,828,184,813,173,753,151,689,140,627,137,573,139"/>
<area shape="poly" title=" " alt="" coords="563,163,654,198,653,203,561,168"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="660,67,790,108"/>
<area shape="poly" title=" " alt="" coords="572,125,644,106,645,111,573,130"/>
<area shape="poly" title=" " alt="" coords="782,106,816,124,840,145,864,164,916,185,959,193,1004,201,1057,221,1110,253,1155,288,1151,292,1107,258,1055,226,1002,206,958,198,914,190,861,168,837,149,813,128,780,111"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="863,79,1056,104"/>
<area shape="poly" title=" " alt="" coords="790,86,847,87,847,92,790,91"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="931,5,988,31"/>
<area shape="poly" title=" " alt="" coords="785,64,862,40,915,25,917,31,863,45,787,69"/>
<area shape="poly" title=" " alt="" coords="1038,103,1058,113,1099,152,1133,198,1159,245,1177,285,1172,287,1154,247,1129,201,1095,156,1054,118,1036,107"/>
<area shape="poly" title=" " alt="" coords="1057,100,1089,103,1088,108,1056,105"/>
<area shape="poly" title=" " alt="" coords="921,80,914,70,918,60,934,54,959,52,987,55,1002,62,999,66,986,60,959,57,935,59,922,64,919,69,926,77"/>
<area shape="rect" href="bort_8f.html#adc4659c5e9171f22248cf61e054ddd17" title=" " alt="" coords="1167,5,1210,31"/>
<area shape="poly" title=" " alt="" coords="988,16,1151,16,1151,21,988,21"/>
<area shape="poly" title=" " alt="" coords="300,1002,419,878,469,826,473,830,423,881,304,1006"/>
<area shape="poly" title=" " alt="" coords="333,1001,436,960,438,965,335,1006"/>
<area shape="poly" title=" " alt="" coords="300,1044,350,1097,384,1124,422,1144,469,1161,508,1170,526,1170,545,1166,586,1144,602,1128,610,1111,612,1074,613,1033,619,1013,633,992,642,985,645,989,637,996,624,1015,618,1034,617,1074,615,1113,606,1131,589,1148,547,1171,527,1175,507,1175,467,1166,420,1149,381,1128,346,1101,296,1048"/>
<area shape="poly" title=" " alt="" coords="373,1022,405,1022,405,1028,373,1028"/>
<area shape="poly" title=" " alt="" coords="298,1044,348,1113,383,1153,423,1188,438,1199,435,1203,419,1192,379,1156,344,1116,294,1047"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="434,1094,574,1135"/>
<area shape="poly" title=" " alt="" coords="335,1043,438,1085,436,1090,333,1048"/>
<area shape="poly" title=" " alt="" coords="546,1091,567,1075,585,1055,600,1026,606,998,604,944,602,918,604,892,614,865,633,838,655,819,676,808,696,803,717,801,762,799,787,795,814,786,864,763,910,738,912,743,866,768,816,791,788,800,763,804,718,806,697,808,678,813,658,824,637,841,618,867,610,893,607,918,609,944,611,999,605,1028,590,1058,571,1079,549,1096"/>
<area shape="poly" title=" " alt="" coords="462,1094,460,1084,467,1075,482,1069,504,1067,528,1070,542,1076,540,1081,527,1075,504,1072,483,1074,470,1079,466,1085,468,1093"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_icgraph" id="agroup__direct__netcdf__mod_ga5e6a92968fe0fa12010bff633ab92549_icgraph">
<area shape="rect" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,287,1117,328"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga4ddfc9953eb0e009c773f60a75a61f78" name="ga4ddfc9953eb0e009c773f60a75a61f78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4ddfc9953eb0e009c773f60a75a61f78">&#9670;&#160;</a></span>read_transpose_multi_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::read_transpose_multi_task </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>read_var_by_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read in variables from model restart file and transpose so that every processor has all copies of a subset of state variables (fill state_ens_handlecopies) Read and transpose data according to the memory limit imposed by read_var_by_var. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dart_index</td><td>This is for multiple domains </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">read_var_by_var</td><td>Read one variable at a time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01078">1078</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_cgraph" id="agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_cgraph">
<area shape="rect" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="5,417,183,458"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="246,67,382,107"/>
<area shape="poly" title=" " alt="" coords="96,416,108,358,133,279,150,236,172,194,198,154,229,118,233,114,237,118,233,122,202,157,176,197,155,239,138,281,113,360,101,417"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="470,67,600,107"/>
<area shape="poly" title=" " alt="" coords="92,417,95,340,100,289,111,232,128,175,152,120,185,70,229,29,260,12,294,4,329,3,364,8,432,29,488,56,486,61,430,34,363,13,329,9,295,10,262,17,232,33,190,73,157,122,133,177,116,234,106,289,100,341,97,417"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="244,507,384,547"/>
<area shape="poly" title=" " alt="" coords="147,456,249,498,247,503,145,461"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="246,132,382,173"/>
<area shape="poly" title=" " alt="" coords="99,416,114,369,141,307,179,242,202,211,229,184,234,179,237,183,232,187,206,214,183,245,146,310,119,371,104,418"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="238,891,390,931"/>
<area shape="poly" title=" " alt="" coords="100,458,110,529,133,631,151,688,173,745,200,801,233,852,262,880,258,883,229,855,195,803,168,747,146,689,128,632,105,529,95,459"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693" title="Give the rank of the processor that owns the start of a variable." alt="" coords="246,287,382,327"/>
<area shape="poly" title=" " alt="" coords="119,414,169,377,229,338,241,332,244,336,232,343,172,381,122,419"/>
<area shape="rect" href="group__state__structure__mod.html#ga91113dc7ea473460732b592efbe08eeb" title="Returns the number of elements in range of start_var and end_var." alt="" coords="244,980,384,1021"/>
<area shape="poly" title=" " alt="" coords="99,458,105,542,125,667,142,737,165,809,195,878,233,941,261,969,257,973,229,945,190,880,160,810,137,739,120,668,100,543,93,459"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="466,680,603,721"/>
<area shape="poly" title=" " alt="" coords="117,456,167,505,232,557,289,593,335,617,446,664,463,671,460,676,444,669,333,622,286,597,229,561,164,509,113,460"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="240,197,388,238"/>
<area shape="poly" title=" " alt="" coords="103,415,151,336,186,290,229,249,236,244,239,248,232,253,190,293,155,339,108,418"/>
<area shape="rect" href="group__io__filenames__mod.html#gadfeeb6444bd6eba53b227209efced814" title="returns true/false depending on whether you should read this copy" alt="" coords="231,1204,397,1245"/>
<area shape="poly" title=" " alt="" coords="101,458,145,691,184,860,233,1031,266,1117,298,1189,293,1191,261,1119,228,1033,179,861,140,693,96,459"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5ff418907b25b36edeaf6a7bae9f42a2" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="246,801,382,842"/>
<area shape="poly" title=" " alt="" coords="109,457,296,786,291,789,105,459"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad4f365fad4bff8aeef537b79fa8c65c6" title="Send elements of variables to a processor. This routine must be called with a corresponding &#39;wait_to_..." alt="" coords="240,352,388,393"/>
<area shape="poly" title=" " alt="" coords="164,414,228,395,229,400,165,419"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga7b0931795ec7b987d9782e4998a62b51" title="Receive data from a reader. Start and finish are the local indicies in the copies array for the data ..." alt="" coords="246,417,382,458"/>
<area shape="poly" title=" " alt="" coords="183,435,230,435,230,440,183,440"/>
<area shape="poly" title=" " alt="" coords="272,66,270,57,277,48,292,42,314,40,338,42,352,48,350,53,336,47,314,45,293,47,280,52,275,58,277,65"/>
<area shape="poly" title=" " alt="" coords="382,84,454,84,454,90,382,90"/>
<area shape="poly" title=" " alt="" coords="493,66,491,57,498,48,512,42,535,40,559,42,573,48,571,53,557,47,535,45,514,47,501,52,496,58,498,65"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="934,401,1062,442"/>
<area shape="poly" title=" " alt="" coords="601,97,662,112,731,136,802,169,867,213,907,254,941,300,967,346,985,386,980,388,962,349,936,303,903,257,864,217,800,174,729,141,660,118,600,102"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1133,336,1260,377"/>
<area shape="poly" title=" " alt="" coords="1061,398,1118,379,1119,384,1063,403"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1133,401,1260,442"/>
<area shape="poly" title=" " alt="" coords="1062,419,1118,419,1118,424,1062,424"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1130,466,1263,492"/>
<area shape="poly" title=" " alt="" coords="1063,437,1136,459,1134,464,1062,443"/>
<area shape="poly" title=" " alt="" coords="272,506,270,497,277,488,292,482,314,480,338,482,352,488,350,493,336,487,314,485,293,487,280,492,275,498,277,505"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="699,429,839,470"/>
<area shape="poly" title=" " alt="" coords="384,512,683,461,684,467,385,518"/>
<area shape="poly" title=" " alt="" coords="839,438,918,429,918,434,840,444"/>
<area shape="poly" title=" " alt="" coords="382,130,454,108,455,113,383,135"/>
<area shape="poly" title=" " alt="" coords="272,890,270,881,277,872,292,866,314,864,338,866,352,872,350,877,336,871,314,869,293,871,280,876,275,882,277,889"/>
<area shape="poly" title=" " alt="" coords="353,284,376,268,395,248,406,231,412,214,416,183,422,151,430,135,443,118,454,109,458,113,447,122,434,138,427,153,421,183,417,216,410,233,399,251,379,272,357,288"/>
<area shape="poly" title=" " alt="" coords="272,286,270,277,277,268,292,262,314,260,338,262,352,268,350,273,336,267,314,265,293,267,280,272,275,278,277,285"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="445,156,624,197"/>
<area shape="poly" title=" " alt="" coords="344,284,395,247,419,229,444,213,466,201,468,206,446,217,422,234,399,252,347,288"/>
<area shape="poly" title=" " alt="" coords="493,156,491,146,498,137,512,131,535,129,559,132,573,138,571,143,557,137,535,135,514,136,501,141,496,147,498,155"/>
<area shape="poly" title=" " alt="" coords="272,980,270,970,277,961,292,955,314,953,338,956,352,962,350,967,336,961,314,959,293,960,280,965,275,971,277,979"/>
<area shape="poly" title=" " alt="" coords="604,697,675,694,751,687,819,674,846,666,864,655,878,642,887,628,894,598,898,565,911,527,938,487,966,452,970,455,942,490,916,529,903,566,899,599,892,630,882,645,867,660,848,671,821,680,752,692,675,699,604,702"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="699,771,839,811"/>
<area shape="poly" title=" " alt="" coords="595,719,625,731,673,756,688,762,686,767,671,761,623,736,593,724"/>
<area shape="poly" title=" " alt="" coords="376,194,395,182,410,166,419,151,427,135,443,118,454,111,457,115,447,122,432,138,423,153,415,170,399,186,378,199"/>
<area shape="poly" title=" " alt="" coords="272,1204,270,1194,277,1185,292,1179,314,1177,338,1180,352,1186,350,1191,336,1185,314,1183,293,1184,280,1189,275,1195,277,1203"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="450,1307,620,1347"/>
<area shape="poly" title=" " alt="" coords="352,1243,446,1291,462,1298,459,1303,444,1296,350,1247"/>
<area shape="poly" title=" " alt="" coords="340,799,387,765,444,731,457,725,459,729,446,736,390,769,343,803"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="465,973,605,1014"/>
<area shape="poly" title=" " alt="" coords="380,840,399,853,416,872,425,891,433,909,447,929,487,962,483,966,443,933,428,912,420,893,411,875,395,857,377,845"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="699,1128,839,1169"/>
<area shape="poly" title=" " alt="" coords="372,840,398,853,422,869,446,884,473,894,497,899,541,901,583,908,604,918,626,936,642,955,650,974,654,1012,656,1050,662,1069,674,1089,689,1105,707,1118,704,1122,686,1109,670,1092,657,1071,651,1051,648,1012,645,975,637,957,622,939,601,922,581,913,540,906,496,904,471,899,444,889,419,874,396,857,370,845"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="465,1063,605,1103"/>
<area shape="poly" title=" " alt="" coords="384,840,399,853,415,875,423,897,426,938,428,980,434,1001,447,1024,477,1052,473,1056,443,1027,429,1003,423,981,421,939,417,898,410,878,395,857,380,844"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="448,1152,621,1193"/>
<area shape="poly" title=" " alt="" coords="384,840,399,853,420,887,429,920,430,952,427,983,423,1014,423,1046,430,1079,447,1113,460,1128,475,1141,472,1145,456,1132,443,1116,425,1080,418,1046,418,1014,422,982,425,951,424,921,415,889,395,857,381,844"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="465,1241,605,1282"/>
<area shape="poly" title=" " alt="" coords="384,840,399,853,426,899,436,943,435,985,428,1027,421,1068,418,1111,425,1155,447,1203,460,1218,475,1231,472,1235,456,1222,443,1206,420,1157,413,1111,416,1068,423,1026,430,985,431,943,421,901,395,857,381,844"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="465,549,605,590"/>
<area shape="poly" title=" " alt="" coords="320,800,336,759,362,705,398,650,419,624,443,601,450,596,453,600,447,605,423,627,402,653,367,708,341,761,325,802"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="465,769,605,810"/>
<area shape="poly" title=" " alt="" coords="382,809,449,799,449,805,383,814"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5cfe0a8ae9bd2d3677457afeeb15226e" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="456,835,614,875"/>
<area shape="poly" title=" " alt="" coords="383,829,441,838,440,843,382,834"/>
<area shape="poly" title=" " alt="" coords="493,973,491,963,498,954,512,949,535,947,559,949,573,955,571,960,557,954,535,952,514,954,501,958,496,964,498,972"/>
<area shape="poly" title=" " alt="" coords="605,1012,626,1025,642,1041,651,1057,660,1072,674,1089,714,1118,711,1122,671,1093,656,1075,647,1059,638,1044,623,1029,602,1017"/>
<area shape="poly" title=" " alt="" coords="726,1128,724,1118,731,1109,746,1103,769,1101,794,1104,808,1110,806,1115,792,1109,769,1107,747,1108,734,1113,729,1119,731,1127"/>
<area shape="poly" title=" " alt="" coords="493,1062,491,1053,498,1044,512,1038,535,1036,559,1038,573,1044,571,1049,557,1043,535,1041,514,1043,501,1048,496,1054,498,1061"/>
<area shape="poly" title=" " alt="" coords="493,1152,491,1142,498,1133,512,1127,535,1125,559,1128,573,1134,571,1139,557,1133,535,1131,514,1132,501,1137,496,1143,498,1151"/>
<area shape="poly" title=" " alt="" coords="493,1241,491,1231,498,1222,512,1217,535,1215,559,1217,573,1223,571,1228,557,1222,535,1220,514,1222,501,1226,496,1232,498,1240"/>
<area shape="poly" title=" " alt="" coords="605,552,727,522,865,479,941,446,943,451,867,484,728,527,606,557"/>
<area shape="poly" title=" " alt="" coords="566,546,671,486,697,474,699,479,674,491,569,551"/>
<area shape="poly" title=" " alt="" coords="493,549,491,539,498,530,512,525,535,523,559,525,573,531,571,536,557,530,535,528,514,530,501,534,496,540,498,548"/>
<area shape="poly" title=" " alt="" coords="493,769,491,759,498,750,512,745,535,743,559,745,573,751,571,756,557,750,535,748,514,750,501,754,496,760,498,768"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="699,860,839,901"/>
<area shape="poly" title=" " alt="" coords="615,861,683,868,683,874,614,866"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="686,949,852,990"/>
<area shape="poly" title=" " alt="" coords="586,873,626,891,718,939,716,944,623,896,584,878"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="699,1039,839,1079"/>
<area shape="poly" title=" " alt="" coords="601,874,626,892,645,919,652,946,658,972,674,1000,709,1028,705,1032,670,1003,653,974,647,947,640,922,622,895,598,878"/>
<area shape="poly" title=" " alt="" coords="726,860,724,850,731,841,746,835,769,833,794,836,808,842,806,847,792,841,769,839,747,840,734,845,729,851,731,859"/>
<area shape="poly" title=" " alt="" coords="726,949,724,939,731,930,746,925,769,923,794,925,808,931,806,936,792,930,769,928,747,930,734,935,729,940,731,948"/>
<area shape="poly" title=" " alt="" coords="726,1039,724,1029,731,1019,746,1014,769,1012,794,1014,808,1020,806,1025,792,1019,769,1017,747,1019,734,1024,729,1030,731,1037"/>
<area shape="poly" title=" " alt="" coords="381,349,395,337,412,310,420,283,421,256,418,229,415,202,416,175,424,147,443,118,454,108,458,112,447,122,429,149,422,176,421,202,423,229,426,256,425,284,417,312,399,341,385,353"/>
<area shape="poly" title=" " alt="" coords="377,349,395,337,410,317,417,296,424,275,443,257,468,245,491,239,531,240,573,249,625,256,694,256,749,255,803,261,833,270,867,285,901,306,931,333,977,387,973,390,927,336,898,310,864,289,831,275,802,266,749,260,694,262,624,262,572,254,531,245,491,244,470,250,447,261,429,278,422,297,415,319,399,341,380,353"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="452,360,618,401"/>
<area shape="poly" title=" " alt="" coords="388,372,436,374,436,379,388,378"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="470,271,600,311"/>
<area shape="poly" title=" " alt="" coords="370,349,462,315,464,320,372,354"/>
<area shape="poly" title=" " alt="" coords="493,360,491,350,498,341,512,335,535,333,559,336,573,342,571,347,557,341,535,339,514,340,501,345,496,351,498,359"/>
<area shape="poly" title=" " alt="" coords="600,284,658,284,726,289,798,300,867,320,895,334,922,352,967,388,964,392,919,356,893,339,865,325,796,305,726,294,658,290,600,290"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="672,379,866,405"/>
<area shape="poly" title=" " alt="" coords="594,309,625,322,729,370,726,375,623,327,592,314"/>
<area shape="poly" title=" " alt="" coords="867,402,919,409,918,414,866,407"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="914,540,1082,581"/>
<area shape="poly" title=" " alt="" coords="841,403,867,415,901,440,931,469,977,525,972,528,927,472,897,444,864,420,839,408"/>
<area shape="poly" title=" " alt="" coords="382,442,436,443,498,440,562,430,623,410,637,400,646,388,655,375,671,364,724,348,767,346,812,353,866,364,907,376,945,391,943,396,905,381,865,369,811,358,767,351,725,354,673,369,659,379,650,391,641,403,626,415,563,435,499,445,437,449,382,447"/>
<area shape="poly" title=" " alt="" coords="382,417,439,402,440,408,383,422"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="470,615,600,655"/>
<area shape="poly" title=" " alt="" coords="383,456,399,469,412,486,419,503,423,536,428,568,434,584,447,600,458,609,454,613,443,603,430,586,423,570,418,537,414,505,407,489,395,473,380,461"/>
<area shape="poly" title=" " alt="" coords="591,611,623,599,672,580,727,568,771,564,814,557,864,536,894,518,922,496,968,452,971,455,926,500,897,523,867,541,815,562,772,569,728,573,673,585,625,604,593,616"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="672,619,866,645"/>
<area shape="poly" title=" " alt="" coords="600,631,657,631,657,636,600,637"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="740,721,798,746"/>
<area shape="poly" title=" " alt="" coords="594,653,625,666,727,711,725,716,623,671,592,658"/>
<area shape="poly" title=" " alt="" coords="797,616,830,598,864,574,913,521,969,452,973,456,917,524,867,578,833,602,800,621"/>
<area shape="poly" title=" " alt="" coords="812,616,916,583,917,588,813,621"/>
<area shape="poly" title=" " alt="" coords="731,621,724,611,728,601,744,595,769,593,797,595,811,602,809,607,796,601,769,598,745,600,732,605,729,610,735,617"/>
<area shape="rect" href="bort_8f.html#adc4659c5e9171f22248cf61e054ddd17" title=" " alt="" coords="976,721,1020,746"/>
<area shape="poly" title=" " alt="" coords="798,731,961,731,961,736,798,736"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_icgraph" id="agroup__direct__netcdf__mod_ga4ddfc9953eb0e009c773f60a75a61f78_icgraph">
<area shape="rect" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1165,287,1343,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1150,310,1117,310,1117,305,1150,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga5bd1c0ced6a496672242e6b11e230b18" name="ga5bd1c0ced6a496672242e6b11e230b18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bd1c0ced6a496672242e6b11e230b18">&#9670;&#160;</a></span>read_transpose_single_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::read_transpose_single_task </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills up a row of copies for each file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dart_index</td><td>This is for multiple domains </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00910">910</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_cgraph" id="agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_cgraph">
<area shape="rect" title="Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills ..." alt="" coords="5,313,189,354"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="250,29,390,70"/>
<area shape="poly" title=" " alt="" coords="105,312,153,217,191,158,235,104,267,77,270,81,239,108,195,161,158,219,110,314"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="250,141,390,182"/>
<area shape="poly" title=" " alt="" coords="123,311,278,190,282,194,127,315"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="244,431,396,471"/>
<area shape="poly" title=" " alt="" coords="139,352,267,421,265,425,136,357"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="469,203,606,243"/>
<area shape="poly" title=" " alt="" coords="181,310,453,241,455,246,182,315"/>
<area shape="rect" href="group__io__filenames__mod.html#gadfeeb6444bd6eba53b227209efced814" title="returns true/false depending on whether you should read this copy" alt="" coords="237,675,403,715"/>
<area shape="poly" title=" " alt="" coords="113,353,300,660,296,663,109,356"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5ff418907b25b36edeaf6a7bae9f42a2" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="252,341,388,382"/>
<area shape="poly" title=" " alt="" coords="189,343,236,349,236,354,189,348"/>
<area shape="poly" title=" " alt="" coords="279,29,277,19,283,10,298,5,320,3,343,5,357,11,355,16,342,10,320,8,299,10,287,15,282,21,284,28"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="685,63,825,103"/>
<area shape="poly" title=" " alt="" coords="391,46,501,47,625,55,670,62,669,67,624,60,501,52,391,51"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="886,132,1014,173"/>
<area shape="poly" title=" " alt="" coords="815,101,878,124,876,129,814,106"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1065,67,1192,107"/>
<area shape="poly" title=" " alt="" coords="1006,129,1056,111,1058,116,1008,134"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1065,132,1192,173"/>
<area shape="poly" title=" " alt="" coords="1014,150,1049,150,1049,155,1014,155"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1062,197,1195,223"/>
<area shape="poly" title=" " alt="" coords="1015,170,1073,189,1071,194,1013,175"/>
<area shape="poly" title=" " alt="" coords="356,138,400,117,450,99,507,88,564,81,669,77,670,83,565,87,507,93,452,104,402,122,358,143"/>
<area shape="poly" title=" " alt="" coords="279,141,277,131,283,122,298,117,320,115,343,117,357,123,355,128,342,122,320,120,299,122,287,127,282,133,284,140"/>
<area shape="poly" title=" " alt="" coords="279,431,277,421,283,412,298,406,320,404,343,406,357,413,355,417,342,412,320,409,299,411,287,416,282,422,284,429"/>
<area shape="poly" title=" " alt="" coords="606,209,870,163,871,168,607,214"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="685,240,825,281"/>
<area shape="poly" title=" " alt="" coords="607,232,670,243,669,248,606,237"/>
<area shape="poly" title=" " alt="" coords="279,675,277,665,283,656,298,650,320,648,343,650,357,657,355,661,342,656,320,653,299,655,287,660,282,666,284,673"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="453,829,623,870"/>
<area shape="poly" title=" " alt="" coords="341,714,388,763,419,790,452,814,462,820,460,824,450,819,416,794,385,767,337,717"/>
<area shape="poly" title=" " alt="" coords="343,339,391,300,450,259,470,248,473,253,452,264,394,304,347,343"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="468,341,608,382"/>
<area shape="poly" title=" " alt="" coords="389,359,452,359,452,364,389,364"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="685,339,825,379"/>
<area shape="poly" title=" " alt="" coords="357,338,401,318,450,303,499,294,538,292,576,295,625,303,665,314,702,329,700,334,663,319,624,308,576,300,538,297,500,300,452,308,403,323,360,343"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="468,431,608,471"/>
<area shape="poly" title=" " alt="" coords="374,380,404,393,474,422,472,427,402,397,372,385"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="451,520,624,561"/>
<area shape="poly" title=" " alt="" coords="387,380,405,393,423,415,431,437,438,458,453,481,486,509,483,513,449,485,433,461,426,439,418,418,401,397,383,385"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="468,609,608,650"/>
<area shape="poly" title=" " alt="" coords="390,380,405,393,421,416,429,439,432,482,434,525,440,547,453,571,482,599,478,602,449,574,435,549,428,526,427,482,424,440,416,419,401,397,386,385"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="468,137,608,178"/>
<area shape="poly" title=" " alt="" coords="330,339,376,267,410,225,449,189,457,184,460,188,453,193,413,229,380,270,334,342"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="468,699,608,739"/>
<area shape="poly" title=" " alt="" coords="390,380,405,393,427,428,436,462,437,494,433,526,430,558,429,590,436,624,453,660,481,688,477,692,449,663,431,626,424,591,424,557,428,525,431,494,431,462,422,430,401,397,387,384"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5cfe0a8ae9bd2d3677457afeeb15226e" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="459,764,617,805"/>
<area shape="poly" title=" " alt="" coords="390,380,405,393,421,417,432,441,441,486,438,530,429,574,421,617,418,660,427,704,438,726,453,749,455,752,451,755,449,753,433,729,422,706,413,660,416,616,424,573,432,530,435,486,427,442,416,420,401,397,387,384"/>
<area shape="poly" title=" " alt="" coords="497,341,495,331,501,322,516,317,538,315,561,317,575,323,573,328,560,322,538,320,517,322,504,327,500,333,502,340"/>
<area shape="poly" title=" " alt="" coords="608,358,669,357,669,363,608,363"/>
<area shape="poly" title=" " alt="" coords="718,339,716,329,722,320,735,314,755,312,776,314,789,321,786,325,775,320,755,317,737,319,726,324,721,330,723,337"/>
<area shape="poly" title=" " alt="" coords="497,431,495,421,501,412,516,406,538,404,561,406,575,413,573,417,560,412,538,409,517,411,504,416,500,422,502,429"/>
<area shape="poly" title=" " alt="" coords="497,520,495,510,501,501,516,495,538,493,561,496,575,502,573,507,560,501,538,499,517,501,504,505,500,511,502,519"/>
<area shape="poly" title=" " alt="" coords="497,609,495,599,501,590,516,585,538,583,561,585,575,591,573,596,560,590,538,588,517,590,504,595,500,601,502,608"/>
<area shape="poly" title=" " alt="" coords="598,134,678,106,680,111,600,139"/>
<area shape="poly" title=" " alt="" coords="608,154,870,151,870,156,609,159"/>
<area shape="poly" title=" " alt="" coords="497,137,495,127,501,118,516,113,538,111,561,113,575,119,573,124,560,118,538,116,517,118,504,123,500,129,502,136"/>
<area shape="poly" title=" " alt="" coords="497,699,495,689,501,680,516,674,538,672,561,674,575,681,573,685,560,680,538,677,517,679,504,684,500,690,502,697"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="685,675,825,715"/>
<area shape="poly" title=" " alt="" coords="593,761,623,749,671,726,687,719,689,724,673,731,625,753,595,766"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="672,764,838,805"/>
<area shape="poly" title=" " alt="" coords="617,782,657,782,657,787,617,787"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="685,853,825,894"/>
<area shape="poly" title=" " alt="" coords="594,803,625,815,694,844,692,849,623,820,592,808"/>
<area shape="poly" title=" " alt="" coords="718,675,716,665,722,656,735,650,755,648,776,650,789,657,786,661,775,656,755,653,737,655,726,660,721,666,723,673"/>
<area shape="poly" title=" " alt="" coords="718,764,716,754,722,745,735,739,755,737,776,740,789,746,786,751,775,745,755,743,737,745,726,749,721,755,723,763"/>
<area shape="poly" title=" " alt="" coords="718,853,716,843,722,834,735,829,755,827,776,829,789,835,786,840,775,834,755,832,737,834,726,839,721,844,723,852"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_icgraph" id="agroup__direct__netcdf__mod_ga5bd1c0ced6a496672242e6b11e230b18_icgraph">
<area shape="rect" title="Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills ..." alt="" coords="1165,287,1349,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1150,310,1118,310,1118,305,1150,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
</map>
</div>

</div>
</div>
<a id="ga5ff418907b25b36edeaf6a7bae9f42a2" name="ga5ff418907b25b36edeaf6a7bae9f42a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5ff418907b25b36edeaf6a7bae9f42a2">&#9670;&#160;</a></span>read_variables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::read_variables </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfile_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>var_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>end_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read in variables from start_var to end_var Read the latest time slice in the file. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00828">828</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_cgraph" id="agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_cgraph">
<area shape="rect" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="5,347,142,387"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="206,29,347,70"/>
<area shape="poly" title=" " alt="" coords="75,346,86,295,107,226,140,153,162,118,188,86,199,77,203,81,192,90,166,121,145,155,112,228,91,296,81,347"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="424,59,564,99"/>
<area shape="poly" title=" " alt="" coords="76,345,87,300,108,241,141,181,163,153,188,130,226,113,282,99,408,83,408,88,283,105,228,118,191,135,166,157,145,184,113,243,92,301,81,347"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="206,168,347,209"/>
<area shape="poly" title=" " alt="" coords="84,345,125,284,154,250,188,220,196,214,199,219,191,224,158,253,129,287,88,348"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="190,257,363,298"/>
<area shape="poly" title=" " alt="" coords="114,344,189,309,204,302,206,307,191,313,117,349"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="206,347,347,387"/>
<area shape="poly" title=" " alt="" coords="142,364,190,364,190,370,142,370"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="206,436,347,477"/>
<area shape="poly" title=" " alt="" coords="123,386,215,427,213,432,121,390"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="206,525,347,566"/>
<area shape="poly" title=" " alt="" coords="94,386,137,434,191,486,229,514,226,518,188,490,133,437,90,389"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="208,591,345,631"/>
<area shape="poly" title=" " alt="" coords="83,387,97,426,119,477,151,529,192,576,197,580,193,584,188,580,146,533,115,479,92,428,78,388"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5cfe0a8ae9bd2d3677457afeeb15226e" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="197,724,356,765"/>
<area shape="poly" title=" " alt="" coords="84,387,123,499,154,571,192,642,218,679,246,711,242,714,214,682,187,644,150,573,118,501,79,389"/>
<area shape="poly" title=" " alt="" coords="238,29,236,19,242,10,256,5,276,3,298,5,312,11,309,16,297,10,276,8,257,10,246,15,241,20,243,28"/>
<area shape="poly" title=" " alt="" coords="347,56,408,65,407,70,346,62"/>
<area shape="poly" title=" " alt="" coords="457,59,455,49,461,40,474,34,494,32,515,34,528,41,525,45,513,40,494,37,475,39,464,44,460,50,462,57"/>
<area shape="poly" title=" " alt="" coords="238,168,236,158,242,149,256,143,276,141,298,144,312,150,309,155,297,149,276,147,257,149,246,153,241,159,243,167"/>
<area shape="poly" title=" " alt="" coords="238,257,236,247,242,238,256,233,276,231,298,233,312,239,309,244,297,238,276,236,257,238,246,243,241,248,243,256"/>
<area shape="poly" title=" " alt="" coords="238,347,236,337,242,328,256,322,276,320,298,322,312,329,309,333,297,328,276,325,257,327,246,332,241,338,243,345"/>
<area shape="poly" title=" " alt="" coords="238,436,236,426,242,417,256,411,276,409,298,412,312,418,309,423,297,417,276,415,257,417,246,421,241,427,243,435"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="424,425,564,466"/>
<area shape="poly" title=" " alt="" coords="347,450,408,447,408,453,347,456"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="624,483,753,523"/>
<area shape="poly" title=" " alt="" coords="347,466,411,475,609,495,609,500,411,480,347,471"/>
<area shape="poly" title=" " alt="" coords="565,464,610,477,609,482,564,469"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="804,417,931,458"/>
<area shape="poly" title=" " alt="" coords="745,480,795,461,796,466,747,485"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="804,483,931,523"/>
<area shape="poly" title=" " alt="" coords="753,500,788,500,788,506,753,506"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="801,548,934,573"/>
<area shape="poly" title=" " alt="" coords="754,521,811,540,810,545,752,526"/>
<area shape="poly" title=" " alt="" coords="238,525,236,515,242,506,256,501,276,499,298,501,312,507,309,512,297,506,276,504,257,506,246,511,241,516,243,524"/>
<area shape="poly" title=" " alt="" coords="345,591,609,521,610,526,346,596"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="424,591,564,631"/>
<area shape="poly" title=" " alt="" coords="346,608,408,608,408,614,346,614"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="424,680,564,721"/>
<area shape="poly" title=" " alt="" coords="355,726,408,715,409,720,356,731"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="411,769,576,810"/>
<area shape="poly" title=" " alt="" coords="356,758,396,767,395,772,355,763"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="424,859,564,899"/>
<area shape="poly" title=" " alt="" coords="312,763,448,848,445,852,309,767"/>
<area shape="poly" title=" " alt="" coords="457,680,455,670,461,661,474,655,494,653,515,656,528,662,525,667,513,661,494,659,475,661,464,665,460,671,462,679"/>
<area shape="poly" title=" " alt="" coords="457,769,455,759,461,750,474,745,494,743,515,745,528,751,525,756,513,750,494,748,475,750,464,755,460,760,462,768"/>
<area shape="poly" title=" " alt="" coords="457,859,455,849,461,840,474,834,494,832,515,834,528,841,525,845,513,840,494,837,475,839,464,844,460,850,462,857"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_icgraph" id="agroup__direct__netcdf__mod_ga5ff418907b25b36edeaf6a7bae9f42a2_icgraph">
<area shape="rect" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="1397,287,1533,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1168,254,1346,295"/>
<area shape="poly" title=" " alt="" coords="1381,297,1346,291,1347,286,1382,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5bd1c0ced6a496672242e6b11e230b18" title="Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills ..." alt="" coords="1165,319,1349,360"/>
<area shape="poly" title=" " alt="" coords="1382,323,1350,328,1349,323,1381,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,293,1118,299,1118,294,1153,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
<area shape="poly" title=" " alt="" coords="1150,326,1117,321,1118,315,1151,320"/>
</map>
</div>

</div>
</div>
<a id="gab53c53011a55614fac307142233b83d4" name="gab53c53011a55614fac307142233b83d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab53c53011a55614fac307142233b83d4">&#9670;&#160;</a></span>recv_variables_to_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::recv_variables_to_write </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sending_pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>elm_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>block_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(block_size), intent(inout)&#160;</td>
          <td class="paramname"><em>variable_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive data to write/collect. The data is put non-contiguously into variable_block. Variable_block is the block of data writen to a netcdf file. It may be 1 or more variables. start and elm_count depend on the sending pe. These are calculated in the calling code. The stride is task_count() since we are assuming a round robin distribution of state vector onto processors. This routine must be called with a corresponding 'send_variables_to_write'. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02214">2214</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_cgraph" id="agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_cgraph">
<area shape="rect" title="Receive data to write/collect. The data is put non&#45;contiguously into variable_block...." alt="" coords="5,198,164,239"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="687,154,816,195"/>
<area shape="poly" title=" " alt="" coords="164,210,672,177,672,182,164,216"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="212,305,378,345"/>
<area shape="poly" title=" " alt="" coords="128,237,240,295,238,299,125,241"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="230,94,360,135"/>
<area shape="poly" title=" " alt="" coords="126,195,237,139,240,144,129,200"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="458,254,588,295"/>
<area shape="poly" title=" " alt="" coords="165,226,442,261,442,267,164,231"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="887,89,1014,129"/>
<area shape="poly" title=" " alt="" coords="815,151,871,132,873,137,816,156"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="887,154,1014,195"/>
<area shape="poly" title=" " alt="" coords="816,172,871,172,871,177,816,177"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="884,219,1017,244"/>
<area shape="poly" title=" " alt="" coords="817,190,890,211,888,216,815,195"/>
<area shape="poly" title=" " alt="" coords="255,304,253,295,260,286,274,280,295,278,318,280,331,286,329,291,316,285,295,283,275,285,263,290,258,296,260,303"/>
<area shape="poly" title=" " alt="" coords="361,120,672,161,672,166,360,125"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="426,79,619,104"/>
<area shape="poly" title=" " alt="" coords="360,105,410,100,411,105,360,110"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="494,5,551,31"/>
<area shape="poly" title=" " alt="" coords="327,91,372,65,425,40,478,24,480,29,427,45,375,69,329,96"/>
<area shape="poly" title=" " alt="" coords="566,102,620,121,685,145,683,150,618,126,565,107"/>
<area shape="poly" title=" " alt="" coords="485,80,477,70,482,60,497,54,523,52,550,55,565,62,562,66,549,60,523,57,499,59,486,64,483,69,489,77"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="667,71,836,112"/>
<area shape="poly" title=" " alt="" coords="620,89,652,89,652,94,620,94"/>
<area shape="rect" href="bort_8f.html#adc4659c5e9171f22248cf61e054ddd17" title=" " alt="" coords="730,5,773,31"/>
<area shape="poly" title=" " alt="" coords="552,16,715,16,715,21,552,21"/>
<area shape="poly" title=" " alt="" coords="570,251,688,199,690,204,572,256"/>
<area shape="poly" title=" " alt="" coords="480,254,478,244,485,235,500,229,523,227,547,230,562,236,560,241,546,235,523,232,501,234,488,239,483,245,485,253"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_icgraph" id="agroup__direct__netcdf__mod_gab53c53011a55614fac307142233b83d4_icgraph">
<area shape="rect" title="Receive data to write/collect. The data is put non&#45;contiguously into variable_block...." alt="" coords="1394,287,1552,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,287,1346,328"/>
<area shape="poly" title=" " alt="" coords="1378,310,1346,310,1346,305,1378,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1150,310,1118,310,1118,305,1150,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="gad4f365fad4bff8aeef537b79fa8c65c6" name="gad4f365fad4bff8aeef537b79fa8c65c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4f365fad4bff8aeef537b79fa8c65c6">&#9670;&#160;</a></span>send_to_waiting_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::send_to_waiting_task </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recv_pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>elm_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>block_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(block_size), intent(in)&#160;</td>
          <td class="paramname"><em>variable_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send elements of variables to a processor. This routine must be called with a corresponding 'wait_to_receive'. The data on the sender are non-contiguous with a stride of task_count. The start is different depending on which pe is the recv and which variables are being sent (these are calculated in the calling routine). The data on the receiver are contiguous (it is the copies array) </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000062">Todo:</a></b></dt><dd>MPI vector data type or packing could/should be used here? </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02096">2096</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_cgraph" id="agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_cgraph">
<area shape="rect" title="Send elements of variables to a processor. This routine must be called with a corresponding &#39;wait_to_..." alt="" coords="5,99,153,139"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="676,145,805,186"/>
<area shape="poly" title=" " alt="" coords="153,121,661,157,661,163,153,127"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="201,69,367,110"/>
<area shape="poly" title=" " alt="" coords="153,106,185,101,185,106,154,111"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="219,184,349,225"/>
<area shape="poly" title=" " alt="" coords="131,137,220,175,218,180,129,142"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="447,29,577,70"/>
<area shape="poly" title=" " alt="" coords="99,96,143,61,170,44,200,31,259,19,321,16,380,20,432,28,431,33,379,25,321,21,260,24,201,36,173,48,146,65,103,100"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="876,80,1003,121"/>
<area shape="poly" title=" " alt="" coords="804,142,860,123,862,128,805,147"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="876,145,1003,186"/>
<area shape="poly" title=" " alt="" coords="805,163,860,163,860,168,805,168"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="873,210,1006,236"/>
<area shape="poly" title=" " alt="" coords="806,182,879,203,877,208,804,187"/>
<area shape="poly" title=" " alt="" coords="245,69,243,59,249,50,263,45,284,43,306,45,319,51,317,56,305,50,284,48,264,50,253,55,248,60,250,68"/>
<area shape="poly" title=" " alt="" coords="349,196,660,170,661,175,349,202"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="415,236,608,261"/>
<area shape="poly" title=" " alt="" coords="350,214,427,229,426,235,349,219"/>
<area shape="poly" title=" " alt="" coords="554,232,607,214,672,189,674,194,609,219,555,237"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="656,228,825,269"/>
<area shape="poly" title=" " alt="" coords="609,246,641,246,641,251,609,251"/>
<area shape="poly" title=" " alt="" coords="555,68,686,136,684,140,552,73"/>
<area shape="poly" title=" " alt="" coords="469,29,467,19,474,10,489,5,512,3,536,5,551,11,549,16,535,10,512,8,490,10,477,15,472,21,474,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_icgraph" id="agroup__direct__netcdf__mod_gad4f365fad4bff8aeef537b79fa8c65c6_icgraph">
<area shape="rect" title="Send elements of variables to a processor. This routine must be called with a corresponding &#39;wait_to_..." alt="" coords="1391,287,1538,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,254,1117,295"/>
<area shape="poly" title=" " alt="" coords="1375,303,1118,282,1118,277,1375,298"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1165,315,1343,356"/>
<area shape="poly" title=" " alt="" coords="1376,322,1344,326,1343,321,1375,317"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="966,284,743,304,743,299,965,279"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,319,1117,360"/>
<area shape="poly" title=" " alt="" coords="1150,340,1117,341,1117,336,1150,335"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,315,933,356"/>
<area shape="poly" title=" " alt="" coords="965,340,933,340,933,334,966,335"/>
<area shape="poly" title=" " alt="" coords="775,325,743,321,743,315,775,320"/>
</map>
</div>

</div>
</div>
<a id="gadcb9423c2f193aec26e71a63aa6496d3" name="gadcb9423c2f193aec26e71a63aa6496d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadcb9423c2f193aec26e71a63aa6496d3">&#9670;&#160;</a></span>send_variables_to_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::send_variables_to_write </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recv_pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ensemble_member</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>finish</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in copies on the sending pe. Finish is the last index in copies to send. If all variables are transposed at once, start = 1, finish = ens_handlemy_num_vars (on sending pe) This routine must be called with a corresponding 'recv_variables_to_write.' The data on the sender is non-contiguous since it is a ROW of copies. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02138">2138</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_cgraph" id="agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_cgraph">
<area shape="rect" title="Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in..." alt="" coords="5,64,167,105"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="690,71,819,111"/>
<area shape="poly" title=" " alt="" coords="123,61,166,41,214,26,276,16,340,13,404,15,467,21,583,41,676,64,675,69,582,46,466,26,404,20,340,18,277,22,215,31,167,46,125,66"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="215,64,381,105"/>
<area shape="poly" title=" " alt="" coords="167,82,199,82,199,87,167,87"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="233,129,363,170"/>
<area shape="poly" title=" " alt="" coords="155,103,219,123,217,128,153,108"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="890,5,1017,46"/>
<area shape="poly" title=" " alt="" coords="818,68,874,49,876,54,819,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="890,71,1017,111"/>
<area shape="poly" title=" " alt="" coords="819,88,874,88,874,94,819,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="887,136,1020,161"/>
<area shape="poly" title=" " alt="" coords="820,107,893,128,891,133,818,112"/>
<area shape="poly" title=" " alt="" coords="258,64,256,54,262,45,276,39,298,37,321,40,334,46,332,51,319,45,298,43,278,45,266,49,261,55,263,63"/>
<area shape="poly" title=" " alt="" coords="363,133,429,122,558,105,675,94,675,100,559,111,429,127,363,139"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="429,137,622,163"/>
<area shape="poly" title=" " alt="" coords="363,147,414,147,414,152,363,152"/>
<area shape="poly" title=" " alt="" coords="578,134,674,109,676,114,580,139"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="670,136,839,177"/>
<area shape="poly" title=" " alt="" coords="623,150,655,151,655,156,623,155"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_icgraph" id="agroup__direct__netcdf__mod_gadcb9423c2f193aec26e71a63aa6496d3_icgraph">
<area shape="rect" title="Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in..." alt="" coords="1394,287,1555,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,287,1346,328"/>
<area shape="poly" title=" " alt="" coords="1378,310,1346,310,1346,305,1378,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1150,310,1118,310,1118,305,1150,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga5cfe0a8ae9bd2d3677457afeeb15226e" name="ga5cfe0a8ae9bd2d3677457afeeb15226e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5cfe0a8ae9bd2d3677457afeeb15226e">&#9670;&#160;</a></span>set_dart_missing_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::set_dart_missing_value </td>
          <td>(</td>
          <td class="paramtype">real(r8), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>replace the netCDF missing_value or _FillValue with the DART missing value. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l03065">3065</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_cgraph" id="agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_cgraph">
<area shape="rect" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="5,119,164,159"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="224,29,365,70"/>
<area shape="poly" title=" " alt="" coords="131,116,211,81,226,74,228,79,213,85,133,121"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="212,119,377,159"/>
<area shape="poly" title=" " alt="" coords="164,136,196,136,196,142,164,142"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="224,208,365,249"/>
<area shape="poly" title=" " alt="" coords="135,157,232,199,230,204,133,162"/>
<area shape="poly" title=" " alt="" coords="255,29,253,19,259,10,273,5,294,3,317,5,331,11,328,16,316,10,294,8,274,10,262,15,258,20,260,28"/>
<area shape="poly" title=" " alt="" coords="255,119,253,109,259,100,273,94,294,92,317,94,331,101,328,105,316,100,294,97,274,99,262,104,258,110,260,117"/>
<area shape="poly" title=" " alt="" coords="255,208,253,198,259,189,273,183,294,181,317,184,331,190,328,195,316,189,294,187,274,189,262,193,258,199,260,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_icgraph" id="agroup__direct__netcdf__mod_ga5cfe0a8ae9bd2d3677457afeeb15226e_icgraph">
<area shape="rect" title="replace the netCDF missing_value or _FillValue with the DART missing value." alt="" coords="1581,287,1739,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5ff418907b25b36edeaf6a7bae9f42a2" title="Read in variables from start_var to end_var Read the latest time slice in the file." alt="" coords="1397,287,1533,328"/>
<area shape="poly" title=" " alt="" coords="1565,310,1533,310,1533,305,1565,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1168,254,1346,295"/>
<area shape="poly" title=" " alt="" coords="1381,297,1346,291,1347,286,1382,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5bd1c0ced6a496672242e6b11e230b18" title="Single processor version of read_transpose. Reads ens_size whole vectors from netcdf files and fills ..." alt="" coords="1165,319,1349,360"/>
<area shape="poly" title=" " alt="" coords="1382,323,1350,328,1349,323,1381,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,293,1118,299,1118,294,1153,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
<area shape="poly" title=" " alt="" coords="1150,326,1117,321,1118,315,1151,320"/>
</map>
</div>

</div>
</div>
<a id="ga31a5d51284ae8bd115186ab8e168a574" name="ga31a5d51284ae8bd115186ab8e168a574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31a5d51284ae8bd115186ab8e168a574">&#9670;&#160;</a></span>set_model_missing_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::set_model_missing_value </td>
          <td>(</td>
          <td class="paramtype">real(r8), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>variable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>replace the DART missing value code with the original netCDF missing_value (or _FillValue) value. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l03114">3114</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_cgraph" id="agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_cgraph">
<area shape="rect" title="replace the DART missing value code with the original netCDF missing_value (or _FillValue) value." alt="" coords="5,119,177,159"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="237,29,378,70"/>
<area shape="poly" title=" " alt="" coords="140,116,224,81,240,74,242,79,226,85,142,121"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="225,119,390,159"/>
<area shape="poly" title=" " alt="" coords="177,136,209,136,209,142,177,142"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="237,208,378,249"/>
<area shape="poly" title=" " alt="" coords="143,157,243,199,241,204,141,162"/>
<area shape="poly" title=" " alt="" coords="266,29,264,19,271,10,286,5,307,3,331,5,345,11,343,16,329,10,307,8,287,10,274,15,270,21,272,28"/>
<area shape="poly" title=" " alt="" coords="266,119,264,109,271,100,286,94,307,92,331,94,345,101,343,105,329,100,307,97,287,99,274,104,270,110,272,117"/>
<area shape="poly" title=" " alt="" coords="266,208,264,198,271,189,286,183,307,181,331,184,345,190,343,195,329,189,307,187,287,189,274,193,270,199,272,207"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_icgraph" id="agroup__direct__netcdf__mod_ga31a5d51284ae8bd115186ab8e168a574_icgraph">
<area shape="rect" title="replace the DART missing value code with the original netCDF missing_value (or _FillValue) value." alt="" coords="1584,287,1755,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a" title="Write variables from start_var to end_var no clamping." alt="" coords="1400,287,1536,328"/>
<area shape="poly" title=" " alt="" coords="1569,310,1536,310,1536,305,1569,305"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,297,1349,291,1350,286,1385,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,323,1353,328,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<a id="ga8ca56c81dfed34ffca506790ad794e1c" name="ga8ca56c81dfed34ffca506790ad794e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ca56c81dfed34ffca506790ad794e1c">&#9670;&#160;</a></span>transpose_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::transpose_write </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_single_vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_single_precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This code transposes and writes out the state vector copies This can either be done on a single task or with multiple tasks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">write_single_vars</td><td>write one variable at a time </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00187">187</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_cgraph" id="agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_cgraph">
<area shape="rect" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="5,736,142,777"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="663,208,793,249"/>
<area shape="poly" title=" " alt="" coords="76,735,104,621,130,540,166,451,212,359,270,271,303,230,339,193,379,159,423,130,466,111,505,107,544,115,591,130,621,142,650,159,697,195,693,200,647,163,619,147,589,135,543,120,505,113,468,116,425,135,382,163,343,197,307,234,274,274,217,362,171,453,135,542,109,623,81,736"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="193,736,373,777"/>
<area shape="poly" title=" " alt="" coords="142,754,177,754,177,759,142,759"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="190,1316,376,1357"/>
<area shape="poly" title=" " alt="" coords="85,776,271,1300,266,1302,80,778"/>
<area shape="poly" title=" " alt="" coords="686,208,684,198,691,189,706,183,728,181,752,184,766,190,764,195,751,189,728,187,707,189,694,193,689,199,691,207"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1283,567,1412,607"/>
<area shape="poly" title=" " alt="" coords="793,217,889,211,945,212,1006,217,1067,228,1127,245,1185,270,1237,304,1264,330,1286,360,1304,393,1318,428,1337,495,1346,551,1341,552,1332,496,1313,430,1299,396,1282,363,1260,333,1234,308,1182,274,1126,250,1066,233,1005,222,945,217,889,216,794,222"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1463,501,1590,542"/>
<area shape="poly" title=" " alt="" coords="1404,564,1454,545,1455,550,1406,569"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1463,567,1590,607"/>
<area shape="poly" title=" " alt="" coords="1412,584,1447,584,1447,590,1412,590"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1460,632,1593,657"/>
<area shape="poly" title=" " alt="" coords="1413,605,1470,624,1469,629,1411,610"/>
<area shape="poly" title=" " alt="" coords="284,735,299,631,327,482,346,406,368,337,393,282,407,260,422,245,447,228,475,216,533,203,593,202,647,207,647,213,593,207,534,208,476,221,450,233,426,249,412,264,398,284,373,339,351,408,332,483,304,632,289,736"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="871,709,1033,750"/>
<area shape="poly" title=" " alt="" coords="309,733,360,699,423,668,508,647,620,632,732,627,780,630,818,638,847,649,874,664,919,697,916,701,871,668,844,654,817,643,780,636,732,633,621,638,509,653,425,674,363,704,312,738"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="429,1346,585,1402"/>
<area shape="poly" title=" " alt="" coords="294,776,493,1330,488,1332,289,778"/>
<area shape="rect" href="group__io__filenames__mod.html#ga931e77da21e002703282c7662cb77f47" title=" " alt="" coords="646,791,810,831"/>
<area shape="poly" title=" " alt="" coords="374,765,631,797,631,802,373,770"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="882,2309,1022,2350"/>
<area shape="poly" title=" " alt="" coords="291,777,332,990,357,1144,379,1304,384,1471,390,1749,401,2025,412,2127,419,2162,426,2185,467,2249,488,2272,511,2291,566,2320,639,2347,697,2360,756,2363,814,2358,866,2349,867,2355,815,2363,756,2368,696,2365,638,2352,564,2325,508,2295,485,2276,463,2252,422,2187,413,2163,407,2127,396,2025,384,1749,379,1471,373,1305,352,1145,327,991,286,778"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="652,880,804,921"/>
<area shape="poly" title=" " alt="" coords="293,776,310,818,337,870,375,921,399,943,425,961,468,977,505,980,543,972,589,960,614,950,637,937,663,925,665,930,640,941,616,955,591,966,544,978,505,985,467,983,423,965,396,947,371,925,332,873,305,820,288,778"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="883,1476,1021,1517"/>
<area shape="poly" title=" " alt="" coords="294,776,312,819,340,875,378,934,401,962,426,986,478,1023,528,1044,577,1055,626,1061,673,1068,722,1081,770,1106,820,1146,850,1183,876,1224,897,1267,914,1311,937,1395,949,1460,944,1461,932,1396,909,1313,892,1269,871,1227,846,1186,816,1150,767,1110,720,1086,672,1073,625,1066,576,1060,527,1049,475,1027,422,990,397,965,374,938,335,878,307,821,289,778"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga14f0ad63f26920f56019fe2036506b71" title="Write global clamping attributes for variables that have clamping." alt="" coords="660,1979,796,2035"/>
<area shape="poly" title=" " alt="" coords="290,777,312,914,348,1116,389,1308,408,1376,426,1412,445,1427,466,1435,508,1435,530,1434,552,1437,573,1445,592,1463,604,1482,613,1507,621,1568,622,1640,618,1717,615,1795,615,1867,622,1928,630,1952,640,1971,649,1980,645,1984,636,1974,625,1954,617,1929,609,1867,609,1795,613,1717,616,1640,616,1568,608,1508,600,1485,588,1466,570,1450,550,1442,530,1440,508,1441,465,1440,443,1432,422,1415,403,1378,383,1309,342,1118,307,915,285,778"/>
<area shape="rect" href="namespaceutilities__mod.html#adc9c6ca8c4039bd52d9a72f806a9dcd2" title=" " alt="" coords="448,707,567,747"/>
<area shape="poly" title=" " alt="" coords="373,742,432,734,433,739,373,747"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="439,283,575,323"/>
<area shape="poly" title=" " alt="" coords="283,735,290,661,312,555,329,497,353,439,384,384,422,335,426,331,429,335,426,338,388,387,358,441,334,498,317,556,296,662,288,736"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a77071efdef7cc8ea113667122f8a86ef" title=" " alt="" coords="424,1476,590,1517"/>
<area shape="poly" title=" " alt="" coords="290,777,348,1138,389,1343,409,1416,426,1456,434,1464,430,1468,422,1459,404,1418,384,1344,343,1139,285,778"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a1500b736b8e9992f705b2c5af3870172" title=" " alt="" coords="424,821,590,862"/>
<area shape="poly" title=" " alt="" coords="339,775,438,813,436,818,337,780"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="439,348,575,389"/>
<area shape="poly" title=" " alt="" coords="284,735,295,672,319,582,337,534,360,486,388,440,422,400,426,396,430,400,426,404,393,444,365,488,342,536,324,584,300,673,289,736"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693" title="Give the rank of the processor that owns the start of a variable." alt="" coords="439,29,575,70"/>
<area shape="poly" title=" " alt="" coords="282,735,289,637,309,483,327,395,351,305,382,215,422,131,442,103,465,79,469,83,446,106,426,134,387,217,356,306,332,396,314,484,294,637,287,736"/>
<area shape="rect" href="group__state__structure__mod.html#ga91113dc7ea473460732b592efbe08eeb" title="Returns the number of elements in range of start_var and end_var." alt="" coords="437,568,577,609"/>
<area shape="poly" title=" " alt="" coords="301,734,353,681,422,625,440,614,443,619,426,629,357,685,305,737"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="433,144,581,185"/>
<area shape="poly" title=" " alt="" coords="281,735,283,642,288,576,299,502,316,424,341,345,376,269,422,201,431,192,435,196,426,205,381,272,346,347,321,425,304,503,293,577,288,643,286,736"/>
<area shape="rect" href="group__io__filenames__mod.html#ga7ebfd4014ae90d598ce884095b473263" title="returns true/false depending on whether you should write this copy" alt="" coords="424,911,590,951"/>
<area shape="poly" title=" " alt="" coords="310,775,426,872,464,899,461,904,422,876,306,779"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gab53c53011a55614fac307142233b83d4" title="Receive data to write/collect. The data is put non&#45;contiguously into variable_block...." alt="" coords="428,413,586,454"/>
<area shape="poly" title=" " alt="" coords="286,735,301,682,327,610,367,533,393,497,422,465,427,461,430,465,426,469,397,500,372,536,332,612,306,683,291,736"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gadcb9423c2f193aec26e71a63aa6496d3" title="Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in..." alt="" coords="427,479,588,519"/>
<area shape="poly" title=" " alt="" coords="290,734,308,692,336,638,375,581,422,530,428,526,432,530,426,534,379,584,341,641,313,695,294,736"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a" title="Write variables from start_var to end_var no clamping." alt="" coords="439,2133,575,2174"/>
<area shape="poly" title=" " alt="" coords="290,777,379,1304,503,2118,498,2119,373,1305,285,778"/>
<area shape="poly" title=" " alt="" coords="912,709,910,699,917,690,931,685,952,683,975,685,988,691,986,696,973,690,952,688,932,690,920,695,916,700,917,708"/>
<area shape="poly" title=" " alt="" coords="574,1400,592,1419,606,1443,615,1467,621,1514,616,1559,606,1603,597,1645,597,1686,601,1705,609,1724,622,1743,640,1762,678,1788,718,1804,761,1811,805,1810,850,1801,895,1787,940,1767,985,1743,1068,1686,1140,1625,1197,1568,1233,1523,1251,1490,1266,1447,1292,1340,1312,1212,1325,1074,1340,807,1343,623,1349,623,1345,807,1331,1074,1317,1213,1298,1341,1271,1449,1256,1492,1238,1526,1201,1572,1144,1629,1071,1691,987,1747,943,1772,897,1792,851,1807,805,1815,760,1817,717,1810,675,1793,637,1766,617,1747,604,1727,596,1707,591,1686,592,1644,601,1602,610,1558,615,1514,610,1468,601,1445,588,1422,571,1404"/>
<area shape="rect" href="group__state__structure__mod.html#ga1afde1c8dca54decec4036a12a074a95" title="Returns whether a variable should be updated or not." alt="" coords="658,2133,798,2174"/>
<area shape="poly" title=" " alt="" coords="545,1400,571,1429,593,1463,602,1491,608,1523,614,1599,612,1780,610,1873,612,1960,621,2034,630,2064,641,2090,654,2107,672,2122,668,2126,650,2111,636,2092,625,2066,616,2035,607,1960,605,1873,607,1780,609,1599,603,1523,597,1492,588,1465,567,1432,541,1404"/>
<area shape="poly" title=" " alt="" coords="521,1345,555,1274,588,1188,598,1136,599,1089,591,1006,589,967,594,927,608,886,636,843,639,840,643,843,640,846,613,889,599,929,595,967,597,1006,605,1089,603,1136,593,1189,560,1277,526,1347"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="658,1623,798,1663"/>
<area shape="poly" title=" " alt="" coords="573,1400,592,1419,607,1441,614,1462,618,1502,621,1542,628,1562,640,1584,671,1612,667,1616,636,1587,623,1564,616,1543,612,1503,609,1463,602,1443,588,1422,569,1404"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="876,949,1028,990"/>
<area shape="poly" title=" " alt="" coords="538,1344,565,1313,588,1277,602,1234,605,1193,595,1119,592,1083,594,1049,608,1015,637,981,661,963,687,951,745,937,805,936,861,943,860,949,805,942,746,943,689,956,663,968,640,985,612,1017,599,1050,597,1083,601,1118,610,1193,607,1235,593,1279,569,1316,542,1347"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="658,2223,798,2263"/>
<area shape="poly" title=" " alt="" coords="545,1400,572,1428,593,1463,603,1495,610,1532,615,1620,614,1721,610,1829,607,1936,608,2035,618,2120,628,2155,641,2184,652,2199,667,2212,663,2216,648,2203,636,2187,623,2157,613,2121,603,2035,601,1936,605,1828,609,1721,610,1620,604,1532,598,1496,588,1465,567,1432,541,1404"/>
<area shape="rect" href="group__state__structure__mod.html#ga9785cd791c2c595b03f4d91943b8160a" title="Return the number of unique dimensions." alt="" coords="640,1712,816,1753"/>
<area shape="poly" title=" " alt="" coords="574,1400,592,1419,611,1453,620,1486,621,1517,618,1547,615,1577,616,1608,623,1640,641,1674,653,1689,669,1701,666,1706,650,1692,636,1676,618,1641,611,1608,610,1577,613,1547,615,1517,614,1487,606,1455,588,1422,570,1404"/>
<area shape="rect" href="group__state__structure__mod.html#ga68f57b50ab4c6a2e004bb260ed3304e5" title="Return the unique dimension lengths." alt="" coords="658,1185,798,1240"/>
<area shape="poly" title=" " alt="" coords="532,1343,578,1297,637,1250,643,1246,646,1250,640,1255,582,1301,536,1347"/>
<area shape="rect" href="group__state__structure__mod.html#gada93d6e8d8cfe4b22c20d5710d451f90" title="Return the unique dimension names." alt="" coords="640,1288,816,1329"/>
<area shape="poly" title=" " alt="" coords="585,1348,641,1331,643,1336,586,1353"/>
<area shape="poly" title=" " alt="" coords="545,1400,571,1429,593,1463,601,1489,606,1519,611,1592,605,1763,603,1850,606,1930,617,1997,627,2024,640,2045,660,2063,681,2071,702,2073,725,2072,772,2072,796,2079,819,2096,834,2113,843,2130,850,2164,853,2199,858,2218,868,2238,891,2269,917,2296,913,2300,887,2272,863,2240,853,2219,848,2200,844,2165,838,2132,830,2116,816,2100,794,2084,771,2077,725,2078,702,2079,679,2076,657,2067,636,2049,622,2026,612,1999,601,1931,598,1850,600,1763,605,1592,601,1520,596,1490,588,1465,567,1432,541,1404"/>
<area shape="poly" title=" " alt="" coords="538,1343,565,1313,588,1277,604,1228,609,1183,606,1142,601,1102,597,1063,598,1023,610,982,636,937,645,928,649,932,640,941,615,984,603,1024,602,1063,606,1101,611,1141,614,1183,609,1229,593,1279,570,1316,542,1347"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="882,2080,1022,2121"/>
<area shape="poly" title=" " alt="" coords="575,1400,592,1419,610,1449,622,1479,628,1507,631,1535,628,1588,618,1640,608,1691,604,1744,607,1771,613,1799,624,1828,641,1858,660,1882,680,1898,701,1908,723,1915,770,1931,794,1945,820,1965,836,1985,844,2004,853,2022,868,2041,901,2069,898,2073,864,2045,848,2024,840,2006,831,1988,816,1969,791,1949,768,1936,721,1921,699,1913,677,1902,656,1885,636,1860,619,1830,608,1800,601,1772,599,1744,602,1690,612,1639,622,1587,626,1535,623,1508,616,1480,605,1452,588,1422,571,1404"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="882,1045,1022,1086"/>
<area shape="poly" title=" " alt="" coords="535,1344,563,1312,588,1276,602,1240,606,1208,614,1178,622,1162,637,1146,662,1127,689,1110,749,1086,809,1072,866,1065,866,1070,810,1077,750,1091,692,1115,665,1131,640,1150,627,1165,619,1179,612,1209,607,1242,593,1279,567,1316,539,1347"/>
<area shape="poly" title=" " alt="" coords="565,1400,592,1418,606,1433,615,1446,624,1458,640,1469,696,1489,756,1500,814,1504,868,1503,868,1508,814,1509,755,1505,695,1494,637,1473,621,1462,611,1449,602,1436,589,1422,562,1404"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga9b4b6fd124b574282fccbff0d7c07437" title="Write global clamping attributes to files that already exist." alt="" coords="645,1533,811,1574"/>
<area shape="poly" title=" " alt="" coords="570,1400,592,1419,609,1444,616,1468,623,1490,640,1513,653,1523,649,1527,636,1517,619,1493,611,1469,604,1446,588,1422,566,1404"/>
<area shape="poly" title=" " alt="" coords="575,1400,592,1419,612,1453,625,1485,634,1516,638,1546,637,1603,628,1659,618,1716,613,1775,618,1838,627,1872,641,1909,659,1939,683,1966,679,1970,655,1943,636,1911,622,1874,613,1839,608,1775,613,1715,623,1658,632,1603,633,1546,629,1517,620,1487,607,1455,588,1422,571,1404"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaf8d438fbf74476572922b31434f3f2e9" title="Write revision information." alt="" coords="653,1419,803,1459"/>
<area shape="poly" title=" " alt="" coords="586,1394,643,1411,641,1416,585,1399"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="658,1353,798,1394"/>
<area shape="poly" title=" " alt="" coords="585,1371,643,1371,643,1376,585,1376"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="647,995,809,1035"/>
<area shape="poly" title=" " alt="" coords="537,1344,565,1313,588,1276,600,1244,605,1215,604,1161,604,1135,607,1108,617,1081,636,1052,646,1043,649,1046,640,1055,622,1083,613,1110,609,1135,610,1161,610,1215,605,1246,593,1279,569,1316,541,1347"/>
<area shape="poly" title=" " alt="" coords="686,2133,684,2123,691,2114,706,2109,728,2107,752,2109,766,2115,764,2120,751,2114,728,2112,707,2114,694,2119,689,2125,691,2132"/>
<area shape="poly" title=" " alt="" coords="686,791,684,781,691,772,706,766,728,764,752,766,766,773,764,778,751,772,728,769,707,771,694,776,689,782,691,789"/>
<area shape="poly" title=" " alt="" coords="686,1623,684,1613,691,1604,706,1598,728,1596,752,1598,766,1605,764,1610,751,1604,728,1601,707,1603,694,1608,689,1614,691,1621"/>
<area shape="poly" title=" " alt="" coords="912,949,910,939,917,930,931,925,952,923,975,925,988,931,986,936,973,930,952,928,932,930,920,935,916,940,917,948"/>
<area shape="poly" title=" " alt="" coords="686,2223,684,2213,691,2204,706,2198,728,2196,752,2198,766,2205,764,2210,751,2204,728,2201,707,2203,694,2208,689,2214,691,2221"/>
<area shape="poly" title=" " alt="" coords="686,1712,684,1702,691,1693,706,1687,728,1685,752,1688,766,1694,764,1699,751,1693,728,1691,707,1693,694,1697,689,1703,691,1711"/>
<area shape="poly" title=" " alt="" coords="685,1184,685,1174,693,1165,707,1160,728,1158,751,1160,766,1167,763,1172,750,1166,728,1163,709,1165,696,1170,690,1176,690,1184"/>
<area shape="poly" title=" " alt="" coords="686,1288,684,1278,691,1269,706,1263,728,1261,752,1264,766,1270,764,1275,751,1269,728,1267,707,1269,694,1273,689,1279,691,1287"/>
<area shape="poly" title=" " alt="" coords="912,2309,910,2299,917,2290,931,2285,952,2283,975,2285,988,2291,986,2296,973,2290,952,2288,932,2290,920,2295,916,2300,917,2308"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="1091,2309,1231,2350"/>
<area shape="poly" title=" " alt="" coords="1022,2327,1075,2327,1075,2332,1022,2332"/>
<area shape="poly" title=" " alt="" coords="1163,2309,1194,2125,1233,1859,1273,1481,1306,1114,1341,622,1347,623,1311,1114,1279,1481,1238,1859,1200,2125,1168,2310"/>
<area shape="poly" title=" " alt="" coords="686,880,684,870,691,861,706,855,728,853,752,856,766,862,764,867,751,861,728,859,707,861,694,865,689,871,691,879"/>
<area shape="poly" title=" " alt="" coords="912,2080,910,2070,917,2061,931,2055,952,2053,975,2056,988,2062,986,2067,973,2061,952,2059,932,2061,920,2065,916,2071,917,2079"/>
<area shape="poly" title=" " alt="" coords="912,1045,910,1035,917,1026,931,1021,952,1019,975,1021,988,1027,986,1032,973,1026,952,1024,932,1026,920,1031,916,1036,917,1044"/>
<area shape="poly" title=" " alt="" coords="1021,1509,1074,1515,1131,1513,1159,1508,1186,1499,1211,1486,1233,1469,1244,1452,1255,1423,1275,1335,1292,1217,1307,1083,1330,813,1342,622,1347,623,1335,813,1313,1084,1298,1218,1280,1336,1260,1424,1249,1454,1237,1473,1214,1491,1188,1504,1160,1513,1131,1518,1074,1520,1021,1514"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="1091,1419,1231,1459"/>
<area shape="poly" title=" " alt="" coords="1020,1475,1075,1460,1076,1465,1021,1480"/>
<area shape="poly" title=" " alt="" coords="809,1530,868,1515,869,1520,810,1535"/>
<area shape="poly" title=" " alt="" coords="798,2033,820,2052,836,2077,844,2100,849,2143,851,2188,857,2212,868,2238,890,2269,916,2297,912,2300,886,2273,863,2240,851,2213,846,2188,843,2144,839,2101,831,2079,816,2055,795,2037"/>
<area shape="poly" title=" " alt="" coords="797,2033,888,2071,886,2076,795,2038"/>
<area shape="poly" title=" " alt="" coords="795,1977,816,1959,836,1925,856,1878,892,1756,922,1630,941,1532,947,1533,927,1631,897,1758,861,1879,840,1928,820,1962,798,1981"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="882,2187,1022,2227"/>
<area shape="poly" title=" " alt="" coords="795,2033,820,2052,836,2072,845,2091,854,2109,868,2131,913,2175,909,2178,864,2134,849,2112,841,2093,832,2075,816,2056,792,2038"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="866,1901,1038,1942"/>
<area shape="poly" title=" " alt="" coords="795,1979,881,1946,883,1951,797,1984"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="868,1991,1036,2031"/>
<area shape="poly" title=" " alt="" coords="796,2006,852,2007,852,2012,796,2011"/>
<area shape="poly" title=" " alt="" coords="912,2187,910,2177,917,2168,931,2162,952,2160,975,2162,988,2169,986,2173,973,2168,952,2165,932,2167,920,2172,916,2178,917,2185"/>
<area shape="poly" title=" " alt="" coords="912,1901,910,1891,917,1882,931,1877,952,1875,975,1877,988,1883,986,1888,973,1882,952,1880,932,1882,920,1887,916,1892,917,1900"/>
<area shape="poly" title=" " alt="" coords="912,1991,910,1981,917,1972,931,1966,952,1964,975,1966,988,1973,986,1977,973,1972,952,1969,932,1971,920,1976,916,1982,917,1989"/>
<area shape="poly" title=" " alt="" coords="804,1456,869,1472,868,1478,803,1461"/>
<area shape="poly" title=" " alt="" coords="753,992,784,964,816,931,881,841,930,762,934,765,885,844,820,934,788,968,756,996"/>
<area shape="poly" title=" " alt="" coords="809,996,860,985,861,991,810,1001"/>
<area shape="poly" title=" " alt="" coords="810,1031,867,1044,866,1049,809,1036"/>
<area shape="poly" title=" " alt="" coords="758,1034,790,1065,820,1103,846,1150,869,1199,906,1299,931,1390,947,1460,941,1461,926,1392,901,1301,864,1201,841,1152,815,1106,786,1068,754,1038"/>
<area shape="poly" title=" " alt="" coords="465,707,463,697,470,688,485,682,507,680,531,682,545,689,543,694,530,688,507,685,486,687,473,692,469,698,471,705"/>
<area shape="rect" href="namespaceutilities__mod.html#a3f63425c321a0636992b51e9c79fcac7" title=" " alt="" coords="1086,537,1235,578"/>
<area shape="poly" title=" " alt="" coords="520,704,566,647,599,617,637,594,692,573,749,557,808,547,867,541,978,538,1071,543,1071,549,978,543,867,546,809,552,751,562,694,578,640,599,602,622,570,651,524,708"/>
<area shape="poly" title=" " alt="" coords="1236,567,1269,572,1268,577,1235,572"/>
<area shape="poly" title=" " alt="" coords="569,279,650,252,652,257,571,285"/>
<area shape="poly" title=" " alt="" coords="465,283,463,273,470,264,485,258,507,256,531,258,545,265,543,270,530,264,507,261,486,263,473,268,469,274,471,281"/>
<area shape="poly" title=" " alt="" coords="532,819,561,791,588,758,602,724,606,694,613,665,622,651,637,638,665,631,722,623,895,609,1268,588,1268,593,896,615,722,629,666,636,640,643,626,655,618,667,611,695,607,726,593,760,565,795,536,823"/>
<area shape="poly" title=" " alt="" coords="565,345,589,333,644,295,691,257,695,261,648,300,592,337,567,350"/>
<area shape="poly" title=" " alt="" coords="561,68,592,86,654,140,703,194,699,198,650,144,589,90,559,73"/>
<area shape="poly" title=" " alt="" coords="465,29,463,19,470,10,485,5,507,3,531,5,545,11,543,16,530,10,507,8,486,10,473,15,469,21,471,28"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="638,29,818,70"/>
<area shape="poly" title=" " alt="" coords="576,47,623,47,623,52,576,52"/>
<area shape="poly" title=" " alt="" coords="686,29,684,19,691,10,706,5,728,3,752,5,766,11,764,16,751,10,728,8,707,10,694,15,689,21,691,28"/>
<area shape="poly" title=" " alt="" coords="465,568,463,558,470,549,485,543,507,541,531,544,545,550,543,555,530,549,507,547,486,549,473,553,469,559,471,567"/>
<area shape="poly" title=" " alt="" coords="581,183,649,203,647,208,579,188"/>
<area shape="poly" title=" " alt="" coords="465,911,463,901,470,892,485,886,507,884,531,886,545,893,543,898,530,892,507,889,486,891,473,896,469,902,471,909"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="643,652,813,693"/>
<area shape="poly" title=" " alt="" coords="548,908,570,892,588,872,601,850,607,830,609,790,613,751,621,730,636,709,647,700,650,703,640,713,626,733,619,752,615,791,612,831,605,852,592,875,573,896,551,912"/>
<area shape="poly" title=" " alt="" coords="571,411,588,398,606,376,614,354,621,331,636,304,659,279,684,257,687,261,663,283,640,307,626,333,619,356,611,379,592,402,574,415"/>
<area shape="poly" title=" " alt="" coords="567,410,589,398,603,385,611,372,621,358,637,347,686,332,726,330,818,347,941,370,1036,395,1126,432,1237,491,1280,521,1317,554,1314,558,1277,526,1234,496,1124,437,1034,400,940,375,817,352,726,336,687,337,639,352,624,362,615,375,607,388,592,402,570,415"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="645,385,811,426"/>
<area shape="poly" title=" " alt="" coords="586,421,629,415,630,421,587,426"/>
<area shape="poly" title=" " alt="" coords="686,385,684,375,691,366,706,361,728,359,752,361,766,367,764,372,751,366,728,364,707,366,694,371,689,377,691,384"/>
<area shape="poly" title=" " alt="" coords="588,487,715,479,877,477,966,481,1058,489,1148,503,1236,523,1273,537,1306,556,1304,560,1271,542,1235,528,1147,508,1057,494,966,486,877,482,715,484,588,493"/>
<area shape="poly" title=" " alt="" coords="560,476,589,463,637,442,664,430,666,435,639,447,591,468,562,481"/>
<area shape="poly" title=" " alt="" coords="576,2151,642,2151,642,2156,576,2156"/>
<area shape="poly" title=" " alt="" coords="561,2172,662,2214,660,2219,559,2177"/>
<area shape="poly" title=" " alt="" coords="525,2173,571,2226,603,2253,639,2273,689,2291,731,2300,751,2300,771,2296,816,2273,830,2260,838,2247,843,2217,846,2184,852,2167,864,2149,889,2127,892,2131,868,2153,857,2169,852,2185,848,2218,843,2249,834,2264,819,2277,773,2301,752,2305,731,2306,688,2296,637,2277,600,2257,567,2230,521,2176"/>
<area shape="poly" title=" " alt="" coords="518,2131,567,2056,600,2010,636,1965,686,1919,730,1888,772,1856,793,1835,815,1807,859,1735,895,1658,921,1587,938,1531,944,1533,926,1589,899,1660,864,1737,820,1810,797,1838,775,1860,733,1892,689,1923,640,1969,604,2013,571,2059,523,2134"/>
<area shape="poly" title=" " alt="" coords="520,2173,537,2207,563,2248,597,2287,617,2303,640,2317,687,2335,727,2340,768,2334,817,2317,832,2308,842,2298,864,2272,909,2235,912,2239,868,2276,846,2301,835,2312,819,2321,769,2339,727,2346,686,2340,637,2321,614,2308,593,2291,559,2251,532,2210,515,2176"/>
<area shape="poly" title=" " alt="" coords="297,1314,422,1152,471,1099,513,1061,551,1021,588,962,599,932,603,903,601,851,600,826,604,801,615,777,637,753,660,736,686,723,743,708,801,704,855,708,855,713,801,709,743,713,688,728,663,741,640,757,620,780,609,803,606,826,606,850,609,904,604,933,593,964,555,1024,517,1065,475,1103,426,1155,301,1317"/>
<area shape="poly" title=" " alt="" coords="377,1349,414,1356,413,1361,376,1354"/>
<area shape="poly" title=" " alt="" coords="307,1314,423,1223,472,1195,515,1178,552,1156,570,1140,588,1116,606,1079,613,1045,612,1011,608,978,604,946,605,912,614,878,636,843,639,840,643,843,640,846,619,880,610,913,609,945,613,978,617,1011,618,1045,611,1081,593,1119,574,1143,555,1160,517,1182,475,1200,425,1228,311,1318"/>
<area shape="poly" title=" " alt="" coords="288,1357,301,1573,329,1915,348,2089,371,2243,397,2359,411,2397,426,2418,457,2435,502,2446,555,2450,614,2449,730,2437,817,2418,845,2407,871,2392,916,2358,919,2362,874,2396,847,2411,818,2423,731,2442,614,2454,555,2455,501,2451,455,2440,422,2422,406,2399,392,2360,366,2244,343,2090,323,1915,296,1573,283,1357"/>
<area shape="poly" title=" " alt="" coords="376,1313,431,1294,488,1267,543,1232,567,1211,588,1187,607,1155,614,1125,615,1095,612,1066,609,1036,609,1006,617,974,636,941,650,928,654,931,640,945,622,976,614,1006,614,1036,617,1065,620,1095,620,1126,612,1157,592,1190,571,1214,546,1236,491,1272,433,1299,377,1318"/>
<area shape="poly" title=" " alt="" coords="295,1356,336,1439,368,1495,408,1555,456,1616,510,1673,571,1723,639,1762,688,1781,730,1790,771,1784,816,1762,845,1740,869,1713,889,1683,906,1651,929,1586,942,1532,947,1533,934,1588,910,1653,894,1686,873,1717,848,1744,819,1767,772,1789,730,1795,687,1786,637,1767,568,1728,506,1677,452,1619,404,1558,364,1498,331,1441,291,1358"/>
<area shape="poly" title=" " alt="" coords="288,1357,296,1436,318,1553,336,1618,359,1684,389,1748,426,1807,475,1860,532,1905,591,1942,647,1971,644,1976,589,1947,529,1910,471,1864,422,1810,384,1751,354,1686,331,1620,313,1554,291,1437,283,1357"/>
<area shape="poly" title=" " alt="" coords="283,1315,293,1230,317,1101,335,1028,358,953,387,878,422,808,442,780,466,756,469,760,446,784,426,811,391,881,363,954,340,1029,322,1103,299,1231,288,1316"/>
<area shape="poly" title=" " alt="" coords="306,1355,358,1404,425,1455,444,1466,441,1471,423,1460,355,1408,303,1359"/>
<area shape="poly" title=" " alt="" coords="282,1315,287,1235,295,1179,307,1118,324,1053,349,989,381,928,422,873,425,870,429,874,426,877,385,931,354,991,330,1055,312,1119,300,1180,293,1235,287,1316"/>
<area shape="poly" title=" " alt="" coords="293,1314,422,1079,485,964,490,966,426,1082,298,1317"/>
<area shape="poly" title=" " alt="" coords="290,1356,338,1593,378,1766,427,1941,461,2038,493,2118,488,2120,456,2040,421,1942,373,1767,333,1595,285,1358"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="882,2465,1022,2506"/>
<area shape="poly" title=" " alt="" coords="288,1357,301,1580,328,1933,348,2113,370,2273,397,2393,411,2433,426,2456,474,2491,528,2514,587,2528,647,2534,708,2533,766,2527,867,2508,868,2513,766,2532,708,2538,647,2539,586,2533,527,2519,471,2495,422,2460,406,2435,392,2395,365,2274,342,2114,323,1933,295,1580,283,1357"/>
<area shape="poly" title=" " alt="" coords="979,2463,1118,2357,1122,2362,982,2467"/>
<area shape="poly" title=" " alt="" coords="912,2465,910,2455,917,2446,931,2441,952,2439,975,2441,988,2447,986,2452,973,2446,952,2444,932,2446,920,2451,916,2456,917,2464"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_icgraph" id="agroup__direct__netcdf__mod_ga8ca56c81dfed34ffca506790ad794e1c_icgraph">
<area shape="rect" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="gaac697410acb3e6e9c9483c6865694799" name="gaac697410acb3e6e9c9483c6865694799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaac697410acb3e6e9c9483c6865694799">&#9670;&#160;</a></span>transpose_write_multi_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::transpose_write_multi_task </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_var_by_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_single_precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_var_by_var. </p>
<p>This is assuming round-robin layout of state on procesors (distribution type 1 in the ensemble handle). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">write_var_by_var</td><td>Write a single variable, one at a time </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000049">Todo:</a></b></dt><dd>This is grabbing the time assuming the ensemble is var complete. Should we instead have all copies time in the ensemble handle? </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01260">1260</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_cgraph" id="agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_cgraph">
<area shape="rect" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="5,1893,186,1934"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="681,29,843,70"/>
<area shape="poly" title=" " alt="" coords="95,1893,106,1643,131,1222,149,994,172,778,199,592,215,516,231,454,267,335,283,285,301,240,323,199,354,160,394,122,447,83,499,58,555,43,612,37,665,37,665,42,612,42,556,49,500,63,449,88,397,126,358,164,328,202,305,243,288,287,272,336,236,456,220,517,204,593,177,779,155,995,136,1223,111,1643,100,1893"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="239,806,395,862"/>
<area shape="poly" title=" " alt="" coords="97,1893,141,1581,181,1347,231,1106,265,980,298,876,303,877,270,981,236,1108,186,1348,146,1582,102,1893"/>
<area shape="rect" href="group__io__filenames__mod.html#ga931e77da21e002703282c7662cb77f47" title=" " alt="" coords="456,1087,619,1127"/>
<area shape="poly" title=" " alt="" coords="94,1893,99,1797,117,1649,134,1565,158,1479,190,1395,231,1316,278,1253,323,1211,377,1177,447,1138,458,1132,461,1136,449,1143,380,1182,327,1215,281,1256,236,1319,195,1397,163,1481,140,1566,123,1650,104,1797,100,1893"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="692,1352,832,1393"/>
<area shape="poly" title=" " alt="" coords="97,1892,109,1833,134,1752,152,1707,173,1664,200,1622,232,1585,265,1560,311,1534,429,1481,561,1433,676,1395,678,1400,562,1438,431,1486,313,1538,267,1564,236,1589,204,1625,178,1666,156,1710,139,1753,115,1835,103,1894"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="462,1176,614,1217"/>
<area shape="poly" title=" " alt="" coords="96,1893,104,1810,126,1687,144,1618,167,1547,196,1477,231,1412,278,1347,324,1304,377,1268,447,1227,458,1221,460,1226,449,1232,380,1273,327,1308,282,1351,236,1415,201,1480,172,1549,149,1619,132,1688,110,1811,101,1893"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="693,753,831,794"/>
<area shape="poly" title=" " alt="" coords="95,1893,111,1586,131,1342,163,1072,183,935,208,800,236,672,268,553,305,446,347,355,394,283,419,255,447,233,494,206,517,199,539,197,561,198,584,205,629,233,654,258,668,284,674,310,675,337,672,396,672,429,678,465,718,617,753,738,748,739,713,619,673,466,667,429,666,396,670,337,669,311,663,286,650,261,626,237,581,210,560,204,539,202,518,205,496,211,449,237,423,259,398,286,352,358,310,448,273,554,241,673,213,801,189,935,168,1073,137,1343,116,1587,100,1893"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga14f0ad63f26920f56019fe2036506b71" title="Write global clamping attributes for variables that have clamping." alt="" coords="470,1521,606,1576"/>
<area shape="poly" title=" " alt="" coords="99,1892,114,1841,139,1774,178,1704,203,1671,232,1642,284,1607,341,1582,400,1565,453,1554,454,1560,401,1570,343,1587,286,1612,235,1646,207,1674,183,1707,144,1777,119,1843,104,1893"/>
<area shape="rect" href="namespaceutilities__mod.html#adc9c6ca8c4039bd52d9a72f806a9dcd2" title=" " alt="" coords="257,1759,377,1799"/>
<area shape="poly" title=" " alt="" coords="119,1891,170,1851,232,1810,244,1804,246,1809,235,1815,173,1855,122,1895"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga806acc05ff4f8aaa9db2906f9df08c47" title="Find i, the start point in var_block for a given recv_pe This is assuming round robin...." alt="" coords="249,1937,385,1978"/>
<area shape="poly" title=" " alt="" coords="186,1929,234,1939,233,1944,185,1934"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae8ccd09884b18c6d167291247089bd27" title="Return the total number of MPI tasks. e.g. if the number of tasks is 4, it returns 4...." alt="" coords="473,2119,603,2159"/>
<area shape="poly" title=" " alt="" coords="106,1933,122,1974,149,2026,186,2078,209,2100,235,2118,289,2140,347,2151,404,2153,457,2150,457,2155,404,2159,346,2156,287,2145,232,2123,206,2104,182,2081,144,2029,117,1977,101,1935"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a77071efdef7cc8ea113667122f8a86ef" title=" " alt="" coords="234,2364,400,2405"/>
<area shape="poly" title=" " alt="" coords="100,1934,106,2011,126,2121,143,2181,166,2241,197,2298,236,2349,239,2352,235,2356,232,2353,193,2301,162,2244,138,2183,121,2122,101,2011,95,1935"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a1500b736b8e9992f705b2c5af3870172" title=" " alt="" coords="897,2155,1063,2195"/>
<area shape="poly" title=" " alt="" coords="104,1934,118,1983,143,2045,160,2078,181,2108,206,2136,235,2158,285,2178,355,2192,439,2199,531,2201,721,2195,881,2182,882,2188,721,2200,531,2206,438,2204,354,2197,284,2183,232,2163,202,2140,177,2112,156,2080,138,2047,112,1984,99,1935"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga637259129bab7191a953fc685b83b23f" title="Find pes for loop indices if you have M tasks and N ensemble members, only the first N + extra copy t..." alt="" coords="249,2003,385,2043"/>
<area shape="poly" title=" " alt="" coords="133,1932,235,1987,248,1994,246,1998,232,1992,130,1937"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gac406bea6ff4528072fe75da92c522693" title="Give the rank of the processor that owns the start of a variable." alt="" coords="249,1848,385,1889"/>
<area shape="poly" title=" " alt="" coords="185,1893,233,1883,234,1888,186,1898"/>
<area shape="rect" href="group__state__structure__mod.html#ga91113dc7ea473460732b592efbe08eeb" title="Returns the number of elements in range of start_var and end_var." alt="" coords="247,2453,387,2494"/>
<area shape="poly" title=" " alt="" coords="100,1934,107,2018,127,2142,145,2212,168,2283,198,2351,236,2415,264,2442,260,2446,232,2418,193,2354,163,2285,139,2213,122,2143,102,2018,95,1935"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga6de05cb71d2bbee35200331c64f5a4c5" title="Calculate number of elements going to the receiving pe (read_transpose) Or being sent from the sendin..." alt="" coords="243,2068,391,2109"/>
<area shape="poly" title=" " alt="" coords="114,1933,165,1991,198,2024,235,2053,244,2058,241,2063,232,2057,195,2028,161,1995,110,1936"/>
<area shape="rect" href="group__io__filenames__mod.html#ga7ebfd4014ae90d598ce884095b473263" title="returns true/false depending on whether you should write this copy" alt="" coords="234,2543,400,2583"/>
<area shape="poly" title=" " alt="" coords="99,1935,102,2031,108,2100,119,2178,136,2261,160,2346,193,2428,236,2504,263,2532,260,2536,232,2507,188,2430,155,2348,131,2263,114,2179,103,2101,97,2031,94,1935"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gab53c53011a55614fac307142233b83d4" title="Receive data to write/collect. The data is put non&#45;contiguously into variable_block...." alt="" coords="238,2233,396,2274"/>
<area shape="poly" title=" " alt="" coords="104,1934,118,1988,143,2062,182,2142,207,2179,236,2213,247,2223,243,2227,232,2217,203,2183,177,2144,138,2064,113,1990,98,1935"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gadcb9423c2f193aec26e71a63aa6496d3" title="Send the data from a pe to a writer. Note this may be 1 variable or many. Start is the start index in..." alt="" coords="236,2299,398,2339"/>
<area shape="poly" title=" " alt="" coords="101,1934,111,2000,133,2093,151,2144,173,2194,201,2242,236,2284,239,2287,235,2291,232,2287,197,2245,169,2197,146,2146,128,2095,106,2001,96,1935"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a" title="Write variables from start_var to end_var no clamping." alt="" coords="249,1656,385,1697"/>
<area shape="poly" title=" " alt="" coords="105,1892,154,1812,190,1765,232,1721,256,1703,260,1707,235,1725,194,1768,159,1815,110,1895"/>
<area shape="poly" title=" " alt="" coords="721,29,719,19,726,10,740,5,762,3,786,5,800,11,797,16,784,10,762,8,741,10,729,15,724,21,726,28"/>
<area shape="rect" href="group__state__structure__mod.html#ga1afde1c8dca54decec4036a12a074a95" title="Returns whether a variable should be updated or not." alt="" coords="468,1265,608,1306"/>
<area shape="poly" title=" " alt="" coords="324,862,334,932,357,1027,373,1079,394,1131,419,1181,450,1227,481,1254,477,1258,446,1230,415,1183,389,1133,368,1080,351,1028,329,933,318,862"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1111,2127,1239,2167"/>
<area shape="poly" title=" " alt="" coords="371,860,449,897,500,912,542,918,583,928,605,938,629,954,722,1029,796,1099,854,1167,901,1238,942,1313,980,1397,1065,1605,1092,1675,1113,1748,1145,1892,1165,2020,1174,2111,1169,2112,1159,2020,1140,1893,1108,1749,1087,1676,1061,1607,975,1399,937,1316,897,1240,850,1171,792,1103,719,1033,626,958,602,943,581,933,541,923,499,917,447,901,369,864"/>
<area shape="poly" title=" " alt="" coords="333,861,379,946,412,996,450,1042,490,1076,486,1080,446,1046,408,999,375,949,329,863"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="468,271,608,311"/>
<area shape="poly" title=" " alt="" coords="319,805,335,699,363,556,380,483,400,416,422,361,446,323,453,316,456,320,450,326,427,363,405,418,385,484,368,557,341,700,325,806"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="686,413,838,454"/>
<area shape="poly" title=" " alt="" coords="329,804,347,769,374,729,407,688,446,653,471,639,494,631,537,627,579,622,602,615,626,602,663,572,694,536,741,466,745,469,699,539,666,575,629,607,604,620,580,628,538,632,496,636,473,644,450,657,411,691,378,732,352,772,333,807"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="468,1355,608,1395"/>
<area shape="poly" title=" " alt="" coords="322,862,328,945,347,1064,364,1129,386,1195,414,1258,450,1316,480,1344,476,1348,446,1319,410,1260,381,1197,358,1130,342,1065,323,946,316,862"/>
<area shape="rect" href="group__state__structure__mod.html#ga9785cd791c2c595b03f4d91943b8160a" title="Return the number of unique dimensions." alt="" coords="450,360,626,401"/>
<area shape="poly" title=" " alt="" coords="316,805,322,728,341,623,357,566,380,510,409,458,446,411,448,409,452,412,450,414,413,460,385,513,362,568,346,624,327,729,321,806"/>
<area shape="rect" href="group__state__structure__mod.html#ga68f57b50ab4c6a2e004bb260ed3304e5" title="Return the unique dimension lengths." alt="" coords="468,449,608,504"/>
<area shape="poly" title=" " alt="" coords="320,805,333,746,356,669,393,587,417,549,446,514,453,508,457,512,450,518,422,552,398,590,361,671,338,747,325,806"/>
<area shape="rect" href="group__state__structure__mod.html#gada93d6e8d8cfe4b22c20d5710d451f90" title="Return the unique dimension names." alt="" coords="450,552,626,593"/>
<area shape="poly" title=" " alt="" coords="326,804,343,762,369,710,403,657,446,609,460,599,463,603,450,613,408,660,374,713,348,764,331,806"/>
<area shape="poly" title=" " alt="" coords="348,860,393,901,449,941,475,953,499,960,543,966,585,975,607,987,629,1005,662,1043,688,1086,710,1132,727,1179,750,1267,760,1336,755,1337,744,1268,722,1180,705,1134,684,1089,657,1047,625,1009,604,991,583,980,542,971,498,965,473,958,447,945,390,905,344,864"/>
<area shape="poly" title=" " alt="" coords="327,861,342,917,366,989,402,1066,425,1103,450,1137,482,1165,479,1169,446,1141,420,1106,398,1069,362,991,337,918,322,863"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="692,1441,832,1482"/>
<area shape="poly" title=" " alt="" coords="334,861,352,894,378,934,411,972,449,1005,474,1017,497,1022,543,1020,565,1020,586,1022,608,1031,629,1049,647,1071,659,1093,670,1137,670,1179,662,1222,654,1265,650,1309,656,1355,665,1378,678,1403,689,1418,704,1430,701,1435,686,1421,673,1406,660,1381,651,1356,645,1309,649,1264,657,1221,664,1179,665,1137,654,1095,642,1074,625,1053,605,1036,585,1027,564,1025,543,1026,497,1027,472,1022,447,1009,407,976,374,937,348,897,329,863"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="692,128,832,169"/>
<area shape="poly" title=" " alt="" coords="316,805,322,659,341,451,358,344,380,247,409,169,427,140,446,118,476,100,508,89,542,84,577,85,646,98,705,119,703,124,645,104,577,91,543,90,509,94,478,104,450,122,431,143,414,172,385,249,363,345,347,451,328,660,321,805"/>
<area shape="poly" title=" " alt="" coords="361,803,402,783,447,767,507,757,568,754,678,759,678,765,568,759,508,763,449,772,404,788,364,808"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga9b4b6fd124b574282fccbff0d7c07437" title="Write global clamping attributes to files that already exist." alt="" coords="455,781,620,822"/>
<area shape="poly" title=" " alt="" coords="395,820,439,813,440,818,395,825"/>
<area shape="poly" title=" " alt="" coords="324,862,336,955,360,1091,398,1249,422,1329,450,1406,478,1460,508,1507,504,1509,473,1462,446,1408,417,1331,392,1251,355,1092,331,956,319,862"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaf8d438fbf74476572922b31434f3f2e9" title="Write revision information." alt="" coords="463,667,613,707"/>
<area shape="poly" title=" " alt="" coords="346,803,391,763,447,723,467,712,470,717,449,728,395,767,349,807"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="468,847,608,887"/>
<area shape="poly" title=" " alt="" coords="395,843,453,852,452,857,395,848"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="457,132,619,173"/>
<area shape="poly" title=" " alt="" coords="316,805,321,706,339,560,356,478,378,394,408,311,446,234,467,205,492,181,496,185,471,208,450,236,413,313,383,395,361,479,345,561,327,706,321,805"/>
<area shape="poly" title=" " alt="" coords="496,1265,494,1255,501,1246,515,1241,538,1239,562,1241,576,1247,574,1252,560,1246,538,1244,517,1246,504,1251,499,1257,501,1264"/>
<area shape="poly" title=" " alt="" coords="496,1087,494,1077,501,1068,515,1062,538,1060,562,1062,576,1069,574,1074,560,1068,538,1065,517,1067,504,1072,499,1078,501,1085"/>
<area shape="poly" title=" " alt="" coords="496,271,494,261,501,252,515,246,538,244,562,246,576,253,574,258,560,252,538,249,517,251,504,256,499,262,501,269"/>
<area shape="poly" title=" " alt="" coords="721,413,719,403,726,394,740,389,762,387,786,389,800,395,797,400,784,394,762,392,741,394,729,399,724,405,726,412"/>
<area shape="poly" title=" " alt="" coords="496,1355,494,1345,501,1336,515,1330,538,1328,562,1330,576,1337,574,1342,560,1336,538,1333,517,1335,504,1340,499,1346,501,1353"/>
<area shape="poly" title=" " alt="" coords="496,360,494,350,501,341,515,335,538,333,562,336,576,342,574,347,560,341,538,339,517,341,504,345,499,351,501,359"/>
<area shape="poly" title=" " alt="" coords="494,448,495,438,503,429,517,424,538,422,561,424,575,431,573,436,559,430,538,427,518,429,506,434,500,440,500,448"/>
<area shape="poly" title=" " alt="" coords="496,552,494,542,501,533,515,527,538,525,562,528,576,534,574,539,560,533,538,531,517,533,504,537,499,543,501,551"/>
<area shape="poly" title=" " alt="" coords="721,1352,719,1342,726,1333,740,1327,762,1325,786,1328,800,1334,797,1339,784,1333,762,1331,741,1333,729,1337,724,1343,726,1351"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="910,1617,1050,1658"/>
<area shape="poly" title=" " alt="" coords="832,1391,850,1404,893,1451,927,1505,953,1557,970,1602,965,1604,948,1560,923,1507,889,1454,847,1408,829,1395"/>
<area shape="poly" title=" " alt="" coords="991,1657,1163,2111,1158,2113,986,1659"/>
<area shape="poly" title=" " alt="" coords="496,1176,494,1166,501,1157,515,1151,538,1149,562,1152,576,1158,574,1163,560,1157,538,1155,517,1157,504,1161,499,1167,501,1175"/>
<area shape="poly" title=" " alt="" coords="721,1441,719,1431,726,1422,740,1417,762,1415,786,1417,800,1423,797,1428,784,1422,762,1420,741,1422,729,1427,724,1433,726,1440"/>
<area shape="poly" title=" " alt="" coords="721,128,719,118,726,109,740,103,762,101,786,104,800,110,797,115,784,109,762,107,741,109,729,113,724,119,726,127"/>
<area shape="poly" title=" " alt="" coords="832,792,898,815,967,843,1027,873,1050,889,1065,904,1079,933,1091,978,1112,1109,1131,1280,1145,1474,1166,1856,1175,2111,1170,2112,1161,1856,1140,1474,1125,1281,1107,1110,1086,979,1074,935,1061,907,1046,893,1025,878,965,847,896,820,830,797"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="910,753,1050,794"/>
<area shape="poly" title=" " alt="" coords="831,771,894,771,894,776,831,776"/>
<area shape="poly" title=" " alt="" coords="621,789,678,781,679,787,621,794"/>
<area shape="poly" title=" " alt="" coords="602,1518,625,1500,642,1476,648,1452,655,1428,673,1404,679,1399,682,1403,677,1407,660,1431,653,1454,646,1478,629,1503,606,1522"/>
<area shape="poly" title=" " alt="" coords="605,1520,674,1493,692,1486,694,1491,676,1497,607,1524"/>
<area shape="poly" title=" " alt="" coords="605,1519,625,1500,635,1469,650,1401,688,1198,752,809,758,810,693,1199,656,1402,640,1470,630,1503,608,1523"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="692,1531,832,1571"/>
<area shape="poly" title=" " alt="" coords="606,1546,677,1547,676,1553,606,1552"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="676,1709,848,1750"/>
<area shape="poly" title=" " alt="" coords="570,1575,619,1621,677,1670,716,1698,713,1703,674,1674,615,1625,566,1579"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="678,1620,846,1661"/>
<area shape="poly" title=" " alt="" coords="607,1574,697,1611,695,1616,605,1579"/>
<area shape="poly" title=" " alt="" coords="721,1531,719,1521,726,1512,740,1506,762,1504,786,1506,800,1513,797,1517,784,1512,762,1509,741,1511,729,1516,724,1522,726,1529"/>
<area shape="poly" title=" " alt="" coords="721,1709,719,1699,726,1690,740,1685,762,1683,786,1685,800,1691,797,1696,784,1690,762,1688,741,1690,729,1695,724,1701,726,1708"/>
<area shape="poly" title=" " alt="" coords="721,1620,719,1610,726,1601,740,1595,762,1593,786,1596,800,1602,797,1607,784,1601,762,1599,741,1601,729,1605,724,1611,726,1619"/>
<area shape="poly" title=" " alt="" coords="594,705,694,745,692,750,592,710"/>
<area shape="poly" title=" " alt="" coords="583,129,701,74,703,79,585,134"/>
<area shape="poly" title=" " alt="" coords="603,171,629,189,673,239,708,296,734,351,752,397,747,399,729,353,703,298,669,242,626,193,600,175"/>
<area shape="poly" title=" " alt="" coords="619,148,676,147,677,153,619,154"/>
<area shape="poly" title=" " alt="" coords="609,171,629,189,653,225,666,257,672,289,672,320,670,385,671,423,678,465,717,618,752,738,747,739,712,619,673,466,666,423,664,385,667,320,666,289,661,259,648,227,625,193,605,175"/>
<area shape="poly" title=" " alt="" coords="275,1759,273,1749,280,1740,295,1734,317,1732,341,1734,355,1741,353,1746,339,1740,317,1737,296,1739,283,1744,278,1750,280,1757"/>
<area shape="rect" href="namespaceutilities__mod.html#a3f63425c321a0636992b51e9c79fcac7" title=" " alt="" coords="905,1993,1055,2034"/>
<area shape="poly" title=" " alt="" coords="379,1794,402,1810,415,1828,421,1845,425,1880,429,1912,436,1927,450,1941,472,1951,512,1960,629,1978,890,2004,890,2010,628,1983,511,1965,470,1956,446,1945,432,1930,424,1913,419,1880,416,1847,410,1830,398,1814,375,1798"/>
<area shape="poly" title=" " alt="" coords="1013,2032,1133,2116,1130,2120,1010,2037"/>
<area shape="poly" title=" " alt="" coords="275,1937,273,1927,280,1918,295,1913,317,1911,341,1913,355,1919,353,1924,339,1918,317,1916,296,1918,283,1923,278,1929,280,1936"/>
<area shape="poly" title=" " alt="" coords="384,1976,402,1989,420,2012,428,2034,435,2056,450,2080,484,2108,480,2112,446,2083,430,2059,423,2036,415,2015,398,1993,381,1981"/>
<area shape="poly" title=" " alt="" coords="603,2136,1063,2140,1095,2141,1095,2147,1063,2146,603,2142"/>
<area shape="poly" title=" " alt="" coords="496,2119,494,2109,501,2100,515,2094,538,2092,562,2094,576,2101,574,2106,560,2100,538,2097,517,2099,504,2104,499,2110,501,2117"/>
<area shape="poly" title=" " alt="" coords="1063,2160,1095,2156,1096,2161,1064,2166"/>
<area shape="poly" title=" " alt="" coords="374,2041,401,2054,494,2108,491,2112,399,2059,372,2046"/>
<area shape="poly" title=" " alt="" coords="387,1887,402,1900,418,1923,426,1946,429,1990,430,2034,437,2056,450,2080,480,2108,476,2112,446,2083,432,2058,425,2034,424,1990,421,1947,413,1926,398,1903,383,1891"/>
<area shape="poly" title=" " alt="" coords="275,1848,273,1838,280,1829,295,1823,317,1821,341,1824,355,1830,353,1835,339,1829,317,1827,296,1829,283,1833,278,1839,280,1847"/>
<area shape="rect" href="group__state__structure__mod.html#ga261df8f47257ac984382557390f0aa45" title="Returns the number of variables below start_var." alt="" coords="448,2029,627,2070"/>
<area shape="poly" title=" " alt="" coords="383,1887,402,1900,419,1921,428,1942,435,1963,450,1985,489,2018,485,2023,446,1989,430,1965,423,1944,415,1924,398,1904,380,1891"/>
<area shape="poly" title=" " alt="" coords="496,2029,494,2019,501,2010,515,2005,538,2003,562,2005,576,2011,574,2016,560,2010,538,2008,517,2010,504,2015,499,2021,501,2028"/>
<area shape="poly" title=" " alt="" coords="275,2453,273,2443,280,2434,295,2429,317,2427,341,2429,355,2435,353,2440,339,2434,317,2432,296,2434,283,2439,278,2445,280,2452"/>
<area shape="poly" title=" " alt="" coords="392,2103,458,2118,457,2123,391,2108"/>
<area shape="poly" title=" " alt="" coords="275,2543,273,2533,280,2524,295,2518,317,2516,341,2518,355,2525,353,2530,339,2524,317,2521,296,2523,283,2528,278,2534,280,2541"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="453,2543,623,2583"/>
<area shape="poly" title=" " alt="" coords="401,2560,437,2560,437,2566,401,2566"/>
<area shape="poly" title=" " alt="" coords="388,2272,519,2302,601,2315,691,2323,785,2325,880,2319,973,2301,1018,2287,1062,2270,1091,2252,1116,2229,1153,2179,1157,2182,1120,2233,1094,2257,1064,2275,1020,2292,975,2306,881,2324,785,2331,691,2329,601,2320,518,2307,387,2277"/>
<area shape="poly" title=" " alt="" coords="356,2231,482,2165,485,2169,359,2235"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="455,2359,621,2399"/>
<area shape="poly" title=" " alt="" coords="375,2272,401,2285,496,2347,493,2352,399,2289,373,2277"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="915,2220,1045,2261"/>
<area shape="poly" title=" " alt="" coords="396,2249,899,2239,899,2245,397,2255"/>
<area shape="poly" title=" " alt="" coords="496,2359,494,2349,501,2340,515,2334,538,2332,562,2334,576,2341,574,2346,560,2340,538,2337,517,2339,504,2344,499,2350,501,2357"/>
<area shape="poly" title=" " alt="" coords="1034,2217,1062,2205,1123,2173,1126,2177,1064,2209,1036,2222"/>
<area shape="poly" title=" " alt="" coords="381,2338,402,2350,417,2366,425,2382,433,2397,449,2409,496,2424,535,2424,576,2417,627,2408,755,2402,858,2399,905,2392,953,2379,1004,2356,1061,2321,1095,2290,1123,2253,1144,2215,1159,2181,1164,2183,1149,2217,1127,2256,1099,2294,1065,2325,1007,2361,955,2384,906,2398,858,2404,756,2407,628,2414,576,2422,535,2429,495,2429,447,2413,429,2400,420,2385,412,2369,398,2354,378,2342"/>
<area shape="poly" title=" " alt="" coords="395,2337,446,2351,445,2357,394,2343"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="915,2473,1045,2514"/>
<area shape="poly" title=" " alt="" coords="385,2338,402,2350,413,2364,420,2378,425,2405,431,2431,438,2442,450,2453,503,2483,561,2503,621,2516,683,2523,743,2524,801,2521,899,2508,899,2514,801,2526,743,2529,683,2528,621,2522,559,2508,501,2487,446,2457,433,2446,426,2433,420,2407,415,2380,409,2367,398,2354,382,2342"/>
<area shape="poly" title=" " alt="" coords="1038,2471,1061,2453,1086,2422,1107,2387,1138,2312,1157,2240,1167,2182,1173,2183,1162,2241,1143,2313,1111,2389,1090,2425,1065,2457,1042,2475"/>
<area shape="poly" title=" " alt="" coords="317,1655,326,1591,347,1501,364,1452,385,1403,413,1358,446,1317,453,1311,456,1315,450,1321,417,1361,390,1406,369,1454,352,1502,331,1592,322,1656"/>
<area shape="poly" title=" " alt="" coords="327,1654,375,1568,409,1515,446,1463,500,1404,504,1408,450,1466,413,1518,379,1571,331,1657"/>
<area shape="poly" title=" " alt="" coords="381,1653,447,1632,500,1623,543,1620,582,1612,603,1602,626,1586,643,1565,649,1542,656,1518,673,1493,679,1489,682,1493,677,1497,661,1520,655,1543,648,1567,629,1590,606,1606,584,1617,544,1625,501,1628,449,1638,382,1658"/>
<area shape="poly" title=" " alt="" coords="328,1654,375,1584,409,1544,446,1506,472,1488,497,1475,542,1460,585,1443,605,1428,625,1405,650,1357,673,1288,694,1206,712,1115,739,938,754,809,760,809,744,939,717,1116,699,1207,679,1290,655,1359,630,1409,609,1432,588,1448,544,1465,499,1480,475,1492,450,1510,413,1547,380,1588,333,1657"/>
<area shape="poly" title=" " alt="" coords="385,1676,439,1674,501,1667,565,1653,626,1630,641,1620,650,1608,659,1595,674,1582,683,1576,686,1581,677,1586,663,1599,654,1611,645,1623,629,1635,567,1658,502,1672,440,1679,385,1681"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga285ec6a4e531cbba343a349a20deea76" title="Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits,..." alt="" coords="470,1701,606,1742"/>
<area shape="poly" title=" " alt="" coords="386,1688,455,1702,454,1707,385,1693"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="675,1799,849,1839"/>
<area shape="poly" title=" " alt="" coords="357,1695,401,1721,425,1737,449,1751,502,1770,557,1785,660,1805,659,1810,555,1790,500,1775,447,1756,422,1742,399,1725,355,1700"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="468,1891,608,1931"/>
<area shape="poly" title=" " alt="" coords="369,1695,402,1721,414,1738,421,1754,427,1784,433,1814,450,1847,467,1864,486,1880,483,1884,463,1868,446,1850,428,1816,422,1785,416,1756,409,1741,398,1725,366,1699"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="692,1889,832,1930"/>
<area shape="poly" title=" " alt="" coords="366,1695,402,1721,418,1744,425,1765,433,1785,450,1804,473,1819,493,1828,533,1837,576,1840,628,1852,701,1881,699,1886,627,1858,575,1846,532,1842,492,1833,470,1824,446,1808,428,1787,420,1767,413,1746,398,1725,363,1699"/>
<area shape="poly" title=" " alt="" coords="563,1699,595,1669,625,1631,635,1612,640,1594,645,1560,651,1528,660,1511,673,1493,677,1490,681,1493,677,1497,664,1513,656,1529,650,1561,646,1595,640,1614,630,1634,599,1672,567,1703"/>
<area shape="poly" title=" " alt="" coords="606,1721,660,1723,660,1729,606,1727"/>
<area shape="poly" title=" " alt="" coords="595,1698,688,1664,690,1669,597,1703"/>
<area shape="poly" title=" " alt="" coords="588,1740,628,1758,701,1790,698,1795,626,1763,586,1745"/>
<area shape="poly" title=" " alt="" coords="721,1799,719,1789,726,1780,740,1774,762,1772,786,1774,800,1781,797,1785,784,1780,762,1777,741,1779,729,1784,724,1790,726,1797"/>
<area shape="poly" title=" " alt="" coords="496,1891,494,1881,501,1872,515,1866,538,1864,562,1866,576,1873,574,1878,560,1872,538,1869,517,1871,504,1876,499,1882,501,1889"/>
<area shape="poly" title=" " alt="" coords="608,1908,676,1908,676,1913,608,1913"/>
<area shape="poly" title=" " alt="" coords="721,1889,719,1879,726,1870,740,1865,762,1863,786,1865,800,1871,797,1876,784,1870,762,1868,741,1870,729,1875,724,1881,726,1888"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_icgraph" id="agroup__direct__netcdf__mod_gaac697410acb3e6e9c9483c6865694799_icgraph">
<area shape="rect" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1165,287,1346,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1150,310,1118,310,1118,305,1150,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga5a0dc19e06b1c54e04d3bd0921f674a1" name="ga5a0dc19e06b1c54e04d3bd0921f674a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a0dc19e06b1c54e04d3bd0921f674a1">&#9670;&#160;</a></span>transpose_write_single_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::transpose_write_single_task </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(inout)&#160;</td>
          <td class="paramname"><em>dart_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>write_single_precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Single processor version of transpose write. Takes copies array one row at a time and writes copy to a netcdf file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000047">Todo:</a></b></dt><dd>This is grabbing the time assuming the ensemble is var complete. Should we instead have all copies time in the ensemble handle? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000048">Todo:</a></b></dt><dd>if multiple domains exist in the same file, only the variables from the first domain are created by <a class="el" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members.">create_and_open_state_output()</a> and since the file exists, the variables for the additional domains never get defined in the netCDF file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00971">971</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_cgraph" id="agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_cgraph">
<area shape="rect" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="5,1421,192,1462"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="684,168,846,209"/>
<area shape="poly" title=" " alt="" coords="97,1421,102,1289,121,1072,138,945,163,812,195,678,237,550,276,440,311,353,334,315,363,280,402,246,453,211,504,188,560,176,616,171,668,172,668,178,616,177,561,181,506,193,455,216,405,250,367,284,338,318,316,356,281,442,242,552,201,680,168,813,144,945,126,1073,108,1289,103,1421"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="245,979,401,1035"/>
<area shape="poly" title=" " alt="" coords="108,1419,298,1048,303,1050,113,1422"/>
<area shape="rect" href="group__io__filenames__mod.html#ga931e77da21e002703282c7662cb77f47" title=" " alt="" coords="461,1332,624,1373"/>
<area shape="poly" title=" " alt="" coords="192,1420,445,1369,446,1374,193,1426"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="695,1480,835,1521"/>
<area shape="poly" title=" " alt="" coords="193,1447,454,1471,679,1490,679,1496,454,1476,192,1453"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="466,1421,618,1462"/>
<area shape="poly" title=" " alt="" coords="192,1439,450,1439,450,1444,192,1444"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="696,859,834,899"/>
<area shape="poly" title=" " alt="" coords="96,1421,96,1353,101,1248,114,1116,139,968,158,892,182,815,211,740,246,667,287,597,335,533,390,476,453,426,500,400,522,393,544,390,566,391,588,398,610,409,632,426,644,441,653,460,662,509,664,568,662,633,659,758,665,808,672,828,680,844,686,850,682,853,676,847,667,831,660,810,654,758,656,632,658,568,657,510,648,462,639,444,628,430,607,414,586,403,565,396,545,395,523,398,502,405,455,431,393,480,339,537,291,600,251,669,216,742,187,817,164,893,145,969,119,1117,106,1248,102,1353,102,1421"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga14f0ad63f26920f56019fe2036506b71" title="Write global clamping attributes for variables that have clamping." alt="" coords="474,1537,610,1592"/>
<area shape="poly" title=" " alt="" coords="132,1460,182,1489,241,1515,296,1531,353,1543,459,1557,458,1562,352,1548,295,1536,239,1520,179,1494,129,1465"/>
<area shape="rect" href="namespaceutilities__mod.html#adc9c6ca8c4039bd52d9a72f806a9dcd2" title=" " alt="" coords="263,29,383,70"/>
<area shape="poly" title=" " alt="" coords="98,1421,112,1160,140,736,160,517,182,321,208,171,222,119,237,87,248,75,252,79,242,90,227,121,213,172,188,322,165,517,145,737,117,1160,103,1421"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a77071efdef7cc8ea113667122f8a86ef" title=" " alt="" coords="240,1981,406,2022"/>
<area shape="poly" title=" " alt="" coords="102,1462,104,1552,110,1615,120,1685,137,1760,162,1834,197,1904,242,1967,245,1970,241,1973,238,1970,192,1907,157,1836,132,1761,115,1686,104,1616,99,1552,96,1462"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="253,1916,393,1957"/>
<area shape="poly" title=" " alt="" coords="104,1462,115,1536,138,1644,156,1704,179,1764,207,1823,242,1877,270,1905,267,1909,238,1881,203,1826,174,1767,151,1705,133,1645,110,1537,99,1463"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a1500b736b8e9992f705b2c5af3870172" title=" " alt="" coords="900,444,1066,485"/>
<area shape="poly" title=" " alt="" coords="98,1421,108,1230,133,924,152,760,175,606,203,475,220,423,237,380,280,307,323,256,378,215,453,174,490,158,538,143,654,117,714,111,770,110,817,116,853,130,869,143,879,157,888,186,893,218,902,256,970,429,965,431,897,257,887,219,883,187,874,159,865,147,850,135,816,121,770,115,715,116,655,123,540,148,492,163,455,179,381,220,327,260,284,310,242,383,225,424,209,477,180,607,157,761,138,924,114,1230,103,1421"/>
<area shape="rect" href="group__io__filenames__mod.html#ga7ebfd4014ae90d598ce884095b473263" title="returns true/false depending on whether you should write this copy" alt="" coords="240,2224,406,2265"/>
<area shape="poly" title=" " alt="" coords="106,1462,154,1694,194,1862,242,2033,276,2129,309,2209,304,2211,271,2131,237,2034,189,1863,149,1695,101,1463"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4797f5013f67a845fdd1ac9aee5bdd9a" title="Write variables from start_var to end_var no clamping." alt="" coords="255,1827,391,1867"/>
<area shape="poly" title=" " alt="" coords="113,1461,305,1812,301,1814,109,1464"/>
<area shape="poly" title=" " alt="" coords="724,168,722,158,729,149,743,143,765,141,789,144,803,150,800,155,787,149,765,147,744,149,732,153,727,159,729,167"/>
<area shape="rect" href="group__state__structure__mod.html#ga1afde1c8dca54decec4036a12a074a95" title="Returns whether a variable should be updated or not." alt="" coords="472,1640,612,1681"/>
<area shape="poly" title=" " alt="" coords="330,1035,346,1155,373,1323,391,1409,411,1489,433,1556,456,1603,484,1629,480,1633,452,1606,428,1558,406,1491,386,1411,368,1324,341,1155,325,1036"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1114,1033,1242,1074"/>
<area shape="poly" title=" " alt="" coords="364,1033,407,1058,455,1076,542,1094,632,1104,723,1107,811,1104,973,1089,1098,1068,1099,1073,974,1094,812,1109,723,1112,632,1109,541,1099,453,1082,404,1062,362,1038"/>
<area shape="poly" title=" " alt="" coords="334,1034,351,1086,376,1151,412,1222,456,1288,493,1321,489,1325,452,1291,407,1225,372,1154,346,1087,329,1036"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="472,464,612,505"/>
<area shape="poly" title=" " alt="" coords="321,978,323,891,329,832,339,768,356,701,379,635,411,572,452,516,458,510,461,514,456,519,415,575,384,637,361,703,345,769,334,833,329,891,326,979"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="689,257,841,298"/>
<area shape="poly" title=" " alt="" coords="322,978,327,825,333,717,344,602,361,488,383,385,397,340,413,301,432,269,452,246,481,228,513,217,548,213,582,214,650,227,709,248,707,253,649,233,582,219,548,218,515,222,484,232,456,250,436,273,418,303,402,342,388,386,366,489,350,603,339,718,332,825,327,979"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="472,1729,612,1770"/>
<area shape="poly" title=" " alt="" coords="329,1035,343,1170,369,1365,386,1465,407,1558,430,1636,456,1691,484,1718,480,1722,452,1694,425,1638,402,1559,381,1466,364,1365,338,1171,324,1036"/>
<area shape="rect" href="group__state__structure__mod.html#ga9785cd791c2c595b03f4d91943b8160a" title="Return the number of unique dimensions." alt="" coords="454,553,630,594"/>
<area shape="poly" title=" " alt="" coords="323,978,332,907,352,809,369,757,391,705,418,655,452,611,462,601,466,605,456,614,423,658,395,707,374,759,357,811,337,908,328,979"/>
<area shape="rect" href="group__state__structure__mod.html#ga68f57b50ab4c6a2e004bb260ed3304e5" title="Return the unique dimension lengths." alt="" coords="472,822,612,878"/>
<area shape="poly" title=" " alt="" coords="349,977,395,932,452,887,459,883,462,888,456,892,399,936,352,981"/>
<area shape="rect" href="group__state__structure__mod.html#gada93d6e8d8cfe4b22c20d5710d451f90" title="Return the unique dimension names." alt="" coords="454,925,630,966"/>
<area shape="poly" title=" " alt="" coords="400,983,452,968,453,973,402,988"/>
<area shape="poly" title=" " alt="" coords="340,1034,385,1109,417,1150,456,1186,479,1201,501,1209,544,1216,586,1224,609,1234,632,1250,656,1274,678,1301,713,1359,739,1416,756,1464,751,1466,734,1418,709,1362,673,1304,652,1278,629,1254,606,1238,585,1229,543,1221,500,1214,477,1206,452,1190,413,1154,380,1112,335,1036"/>
<area shape="poly" title=" " alt="" coords="330,1035,342,1102,365,1192,381,1242,402,1291,427,1339,456,1383,486,1410,483,1414,452,1386,422,1342,397,1294,376,1244,359,1194,337,1103,325,1035"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="695,1572,835,1613"/>
<area shape="poly" title=" " alt="" coords="334,1035,348,1082,373,1141,408,1200,430,1227,456,1250,479,1264,501,1269,545,1268,567,1267,589,1269,611,1277,632,1294,654,1324,663,1353,665,1381,663,1410,660,1439,659,1468,665,1499,681,1531,694,1547,710,1561,707,1565,690,1551,676,1534,660,1500,654,1469,654,1439,657,1409,660,1381,658,1354,649,1326,628,1298,608,1282,588,1274,567,1273,545,1274,500,1275,477,1269,452,1254,427,1231,404,1203,368,1143,343,1084,328,1036"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="695,793,835,834"/>
<area shape="poly" title=" " alt="" coords="381,1033,438,1054,504,1069,537,1070,570,1067,601,1058,629,1041,648,1020,657,998,658,974,656,950,653,924,653,898,660,871,676,845,681,841,684,845,680,849,665,874,658,899,658,924,661,949,664,974,662,999,652,1023,632,1045,603,1062,571,1072,537,1076,503,1074,437,1060,379,1038"/>
<area shape="poly" title=" " alt="" coords="322,979,328,910,347,819,364,772,386,728,415,687,452,654,499,628,521,621,543,619,565,621,587,627,632,654,652,676,661,699,663,723,661,747,659,796,665,820,680,844,686,849,682,853,676,847,660,822,654,796,656,746,658,723,656,700,647,679,629,658,585,632,564,626,543,624,522,627,501,633,456,659,419,691,391,730,368,774,352,821,333,910,327,979"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga9b4b6fd124b574282fccbff0d7c07437" title="Write global clamping attributes to files that already exist." alt="" coords="460,668,625,709"/>
<area shape="poly" title=" " alt="" coords="327,978,341,924,365,855,401,783,425,750,452,720,457,716,460,720,456,724,429,753,406,786,370,857,346,925,332,979"/>
<area shape="poly" title=" " alt="" coords="330,1035,341,1114,364,1225,402,1351,427,1413,456,1472,475,1500,498,1524,494,1528,471,1503,452,1475,422,1416,397,1353,359,1227,336,1115,325,1036"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaf8d438fbf74476572922b31434f3f2e9" title="Write revision information." alt="" coords="467,733,617,774"/>
<area shape="poly" title=" " alt="" coords="331,978,348,935,374,883,409,830,452,784,456,781,460,785,456,788,413,833,379,886,353,937,336,980"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="472,260,612,301"/>
<area shape="poly" title=" " alt="" coords="323,978,334,840,357,641,375,539,396,444,421,366,436,336,452,312,457,306,461,310,456,315,441,338,426,368,401,446,380,540,363,642,339,840,329,979"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="461,325,623,366"/>
<area shape="poly" title=" " alt="" coords="322,979,328,883,347,742,364,663,386,582,415,502,452,427,473,398,498,374,501,378,477,402,456,430,420,504,391,583,369,664,353,743,334,883,327,979"/>
<area shape="poly" title=" " alt="" coords="501,1640,499,1630,505,1621,520,1615,542,1613,566,1616,580,1622,578,1627,565,1621,542,1619,521,1621,509,1625,504,1631,506,1639"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1293,968,1421,1009"/>
<area shape="poly" title=" " alt="" coords="1235,1030,1284,1012,1286,1017,1237,1035"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1293,1033,1421,1074"/>
<area shape="poly" title=" " alt="" coords="1243,1051,1278,1051,1278,1056,1243,1056"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1290,1098,1424,1124"/>
<area shape="poly" title=" " alt="" coords="1243,1072,1301,1090,1299,1096,1242,1077"/>
<area shape="poly" title=" " alt="" coords="501,1332,499,1322,505,1313,520,1307,542,1305,566,1308,580,1314,578,1319,565,1313,542,1311,521,1313,509,1317,504,1323,506,1331"/>
<area shape="poly" title=" " alt="" coords="501,464,499,454,505,445,520,439,542,437,566,440,580,446,578,451,565,445,542,443,521,445,509,449,504,455,506,463"/>
<area shape="poly" title=" " alt="" coords="724,257,722,247,729,238,743,233,765,231,789,233,803,239,800,244,787,238,765,236,744,238,732,243,727,249,729,256"/>
<area shape="poly" title=" " alt="" coords="501,1729,499,1719,505,1710,520,1705,542,1703,566,1705,580,1711,578,1716,565,1710,542,1708,521,1710,509,1715,504,1721,506,1728"/>
<area shape="poly" title=" " alt="" coords="501,553,499,543,505,534,520,529,542,527,566,529,580,535,578,540,565,534,542,532,521,534,509,539,504,545,506,552"/>
<area shape="poly" title=" " alt="" coords="499,821,500,811,507,803,522,797,542,795,565,798,579,805,577,809,564,803,542,800,523,802,510,807,505,813,504,822"/>
<area shape="poly" title=" " alt="" coords="501,925,499,915,505,906,520,901,542,899,566,901,580,907,578,912,565,906,542,904,521,906,509,911,504,917,506,924"/>
<area shape="poly" title=" " alt="" coords="724,1480,722,1470,729,1461,743,1455,765,1453,789,1456,803,1462,800,1467,787,1461,765,1459,744,1461,732,1465,727,1471,729,1479"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="913,1803,1053,1843"/>
<area shape="poly" title=" " alt="" coords="832,1519,853,1534,880,1564,902,1596,938,1665,962,1732,977,1787,972,1788,957,1734,933,1668,898,1599,875,1567,850,1538,829,1523"/>
<area shape="poly" title=" " alt="" coords="987,1801,1165,1089,1171,1090,992,1803"/>
<area shape="poly" title=" " alt="" coords="501,1421,499,1411,505,1402,520,1397,542,1395,566,1397,580,1403,578,1408,565,1402,542,1400,521,1402,509,1407,504,1413,506,1420"/>
<area shape="poly" title=" " alt="" coords="724,1572,722,1562,729,1553,743,1547,765,1545,789,1548,803,1554,800,1559,787,1553,765,1551,744,1553,732,1557,727,1563,729,1571"/>
<area shape="poly" title=" " alt="" coords="724,793,722,783,729,774,743,769,765,767,789,769,803,775,800,780,787,774,765,772,744,774,732,779,727,785,729,792"/>
<area shape="poly" title=" " alt="" coords="816,897,1115,1024,1113,1029,814,902"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="913,859,1053,899"/>
<area shape="poly" title=" " alt="" coords="834,876,897,876,897,882,834,882"/>
<area shape="poly" title=" " alt="" coords="616,707,632,720,645,736,652,752,657,783,662,814,668,829,680,844,685,848,682,852,676,847,664,831,657,815,652,784,647,754,640,739,628,724,612,711"/>
<area shape="poly" title=" " alt="" coords="610,1542,679,1522,681,1527,611,1547"/>
<area shape="poly" title=" " alt="" coords="611,1570,680,1579,679,1584,610,1576"/>
<area shape="poly" title=" " alt="" coords="577,1534,604,1506,628,1472,663,1397,691,1318,714,1237,731,1157,751,1015,760,915,765,915,757,1016,736,1158,719,1238,696,1319,668,1399,633,1475,609,1509,581,1538"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="695,1877,835,1918"/>
<area shape="poly" title=" " alt="" coords="612,1585,632,1603,650,1631,659,1657,662,1683,662,1708,662,1760,667,1788,681,1818,700,1843,723,1865,719,1869,696,1847,676,1820,662,1789,656,1761,656,1708,657,1683,654,1659,646,1633,628,1606,609,1589"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="679,1667,851,1707"/>
<area shape="poly" title=" " alt="" coords="609,1590,632,1602,721,1656,718,1660,629,1607,606,1595"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="681,1767,849,1807"/>
<area shape="poly" title=" " alt="" coords="613,1587,632,1603,652,1632,659,1659,665,1687,681,1717,699,1738,720,1755,716,1759,695,1741,676,1721,660,1689,654,1661,647,1634,628,1606,609,1591"/>
<area shape="poly" title=" " alt="" coords="724,1877,722,1867,729,1858,743,1853,765,1851,789,1853,803,1859,800,1864,787,1858,765,1856,744,1858,732,1863,727,1869,729,1876"/>
<area shape="poly" title=" " alt="" coords="724,1667,722,1657,729,1648,743,1642,765,1640,789,1642,803,1649,800,1653,787,1648,765,1645,744,1647,732,1652,727,1658,729,1665"/>
<area shape="poly" title=" " alt="" coords="724,1767,722,1757,729,1748,743,1742,765,1740,789,1742,803,1749,800,1753,787,1748,765,1745,744,1747,732,1752,727,1758,729,1765"/>
<area shape="poly" title=" " alt="" coords="613,772,632,784,648,799,657,814,665,829,680,844,687,849,684,853,677,848,661,832,652,817,644,802,629,788,610,777"/>
<area shape="poly" title=" " alt="" coords="611,323,628,310,645,288,652,266,659,243,676,220,682,215,685,219,680,224,664,246,657,268,650,291,632,314,614,327"/>
<area shape="poly" title=" " alt="" coords="611,322,681,300,683,305,612,327"/>
<area shape="poly" title=" " alt="" coords="612,365,632,383,649,408,660,432,670,479,669,524,661,568,654,612,651,657,658,704,667,729,681,755,692,770,707,782,704,787,689,773,676,758,662,731,653,706,645,657,648,611,656,567,664,523,665,479,655,434,644,410,628,386,609,369"/>
<area shape="poly" title=" " alt="" coords="612,364,632,383,652,414,665,445,672,474,674,504,668,561,655,617,643,672,638,728,641,756,648,785,661,814,680,844,686,850,682,853,676,847,656,817,643,786,635,757,632,728,638,671,650,615,663,560,669,504,666,475,659,446,647,416,628,386,609,368"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="695,436,835,477"/>
<area shape="poly" title=" " alt="" coords="593,364,632,382,715,426,712,430,629,387,591,369"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="695,704,835,745"/>
<area shape="poly" title=" " alt="" coords="611,364,632,383,654,420,664,456,664,490,660,524,656,557,655,592,662,627,681,665,708,693,704,697,676,669,657,629,650,592,651,557,655,523,659,490,658,456,650,422,628,386,608,369"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="682,615,848,655"/>
<area shape="poly" title=" " alt="" coords="611,365,632,383,649,408,657,432,659,479,660,526,666,550,680,576,709,604,706,608,676,579,662,552,655,527,654,479,652,433,644,410,628,386,607,369"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="695,525,835,566"/>
<area shape="poly" title=" " alt="" coords="607,364,632,382,651,409,658,435,664,460,680,487,712,515,709,519,676,490,660,462,653,436,646,411,628,386,604,369"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="695,347,835,387"/>
<area shape="poly" title=" " alt="" coords="624,351,680,356,679,361,623,356"/>
<area shape="poly" title=" " alt="" coords="724,436,722,426,729,417,743,411,765,409,789,412,803,418,800,423,787,417,765,415,744,417,732,421,727,427,729,435"/>
<area shape="poly" title=" " alt="" coords="724,704,722,694,729,685,743,679,765,677,789,680,803,686,800,691,787,685,765,683,744,685,732,689,727,695,729,703"/>
<area shape="poly" title=" " alt="" coords="724,615,722,605,729,596,743,590,765,588,789,590,803,597,800,601,787,596,765,593,744,595,732,600,727,606,729,613"/>
<area shape="poly" title=" " alt="" coords="724,525,722,515,729,506,743,501,765,499,789,501,803,507,800,512,787,506,765,504,744,506,732,511,727,517,729,524"/>
<area shape="poly" title=" " alt="" coords="724,347,722,337,729,328,743,322,765,320,789,322,803,329,800,333,787,328,765,325,744,327,732,332,727,338,729,345"/>
<area shape="poly" title=" " alt="" coords="281,29,279,19,286,10,301,5,323,3,347,5,361,11,359,16,345,10,323,8,302,10,289,15,285,21,287,28"/>
<area shape="rect" href="namespaceutilities__mod.html#a3f63425c321a0636992b51e9c79fcac7" title=" " alt="" coords="908,204,1058,245"/>
<area shape="poly" title=" " alt="" coords="383,38,477,30,597,30,662,35,727,45,792,62,853,86,887,107,917,134,963,190,959,193,914,138,884,111,850,91,790,67,726,51,661,40,597,35,477,35,383,43"/>
<area shape="poly" title=" " alt="" coords="996,244,1031,325,1069,432,1110,602,1141,771,1163,916,1176,1018,1170,1018,1158,917,1136,772,1105,603,1063,433,1026,327,991,246"/>
<area shape="poly" title=" " alt="" coords="394,1955,408,1968,421,1988,430,2008,437,2048,434,2087,426,2125,419,2162,418,2197,429,2231,440,2248,456,2264,489,2281,535,2290,592,2293,653,2290,713,2282,770,2268,817,2251,850,2232,888,2191,918,2144,940,2093,957,2039,968,1987,975,1937,979,1858,985,1859,980,1938,973,1988,962,2041,945,2095,922,2147,892,2195,853,2236,819,2256,771,2274,714,2287,653,2295,592,2299,535,2296,487,2286,452,2268,436,2251,424,2234,413,2198,413,2161,420,2124,428,2086,432,2048,425,2010,417,1991,404,1971,391,1959"/>
<area shape="poly" title=" " alt="" coords="281,1916,279,1906,286,1897,301,1891,323,1889,347,1892,361,1898,359,1903,345,1897,323,1895,302,1897,289,1901,285,1907,287,1915"/>
<area shape="poly" title=" " alt="" coords="994,484,1168,1018,1163,1019,988,486"/>
<area shape="poly" title=" " alt="" coords="281,2224,279,2214,286,2205,301,2199,323,2197,347,2200,361,2206,359,2211,345,2205,323,2203,302,2205,289,2209,285,2215,287,2223"/>
<area shape="rect" href="group__io__filenames__mod.html#ga9fa6e6da53eaa8044c7986a245b90638" title="Assert if a copy is in a valid range." alt="" coords="457,2339,627,2379"/>
<area shape="poly" title=" " alt="" coords="359,2263,455,2318,479,2330,477,2334,453,2323,356,2267"/>
<area shape="poly" title=" " alt="" coords="335,1825,381,1760,415,1724,452,1692,461,1686,463,1691,456,1696,418,1727,386,1763,339,1828"/>
<area shape="poly" title=" " alt="" coords="369,1824,453,1786,479,1774,481,1779,455,1791,372,1828"/>
<area shape="poly" title=" " alt="" coords="391,1834,535,1807,597,1792,629,1780,643,1762,651,1745,654,1708,656,1670,663,1649,676,1629,686,1620,690,1624,680,1633,667,1652,661,1671,659,1709,656,1746,648,1765,632,1784,598,1798,537,1812,392,1839"/>
<area shape="poly" title=" " alt="" coords="323,1826,332,1739,354,1605,371,1528,393,1449,419,1370,452,1295,492,1228,533,1182,577,1138,628,1077,691,988,741,911,745,914,695,991,632,1081,581,1141,537,1185,496,1231,456,1298,424,1372,398,1450,376,1529,359,1606,338,1739,328,1827"/>
<area shape="poly" title=" " alt="" coords="391,1866,408,1878,419,1893,426,1907,430,1935,436,1961,443,1973,455,1983,500,2005,540,2011,581,2003,629,1983,645,1973,653,1960,662,1945,677,1930,687,1923,690,1928,680,1934,666,1948,658,1962,648,1976,632,1988,583,2008,540,2016,499,2011,453,1988,439,1976,431,1963,425,1936,421,1909,415,1895,404,1882,388,1870"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga285ec6a4e531cbba343a349a20deea76" title="Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits,..." alt="" coords="474,1933,610,1974"/>
<area shape="poly" title=" " alt="" coords="383,1866,407,1878,432,1898,455,1918,467,1924,464,1929,453,1923,428,1902,405,1883,381,1870"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="678,1968,852,2009"/>
<area shape="poly" title=" " alt="" coords="392,1866,408,1878,421,1897,427,1916,430,1952,433,1986,441,2001,456,2016,484,2031,516,2040,549,2044,582,2043,648,2031,705,2012,706,2017,649,2036,583,2048,548,2049,515,2046,482,2036,452,2020,436,2005,428,1988,424,1953,422,1917,416,1899,404,1882,389,1870"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="472,2173,612,2214"/>
<area shape="poly" title=" " alt="" coords="393,1865,408,1879,429,1911,438,1943,439,1973,437,2003,434,2033,434,2064,440,2096,456,2130,471,2147,489,2162,485,2166,467,2151,452,2132,435,2097,428,2064,428,2033,431,2002,434,1973,433,1944,424,1913,404,1882,390,1869"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="695,2092,835,2133"/>
<area shape="poly" title=" " alt="" coords="393,1866,408,1879,423,1901,430,1924,431,1968,432,2009,440,2029,456,2049,480,2068,506,2083,564,2103,624,2113,680,2116,679,2121,623,2118,563,2108,504,2088,477,2072,452,2053,435,2032,427,2011,425,1968,425,1925,418,1903,404,1882,389,1870"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="695,2181,835,2222"/>
<area shape="poly" title=" " alt="" coords="393,1865,408,1879,423,1902,433,1925,440,1972,435,2017,424,2061,415,2104,413,2146,417,2166,425,2185,437,2205,456,2224,483,2242,514,2253,546,2257,580,2257,647,2245,705,2226,707,2231,648,2250,581,2262,546,2263,512,2258,481,2247,452,2228,433,2208,420,2188,412,2167,408,2146,410,2104,419,2060,430,2016,435,1972,428,1927,419,1905,404,1882,390,1869"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="472,1868,612,1909"/>
<area shape="poly" title=" " alt="" coords="392,1857,457,1870,456,1875,391,1862"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga31a5d51284ae8bd115186ab8e168a574" title="replace the DART missing value code with the original netCDF missing_value (or _FillValue) value." alt="" coords="457,991,628,1031"/>
<area shape="poly" title=" " alt="" coords="321,1826,321,1711,326,1625,335,1526,351,1420,374,1310,408,1202,452,1099,474,1067,500,1040,504,1044,478,1070,456,1102,413,1204,380,1312,356,1421,340,1527,331,1625,327,1711,326,1826"/>
<area shape="poly" title=" " alt="" coords="609,1934,628,1919,650,1882,659,1847,658,1812,653,1777,647,1742,646,1705,654,1668,676,1629,684,1621,688,1624,680,1633,659,1670,652,1706,653,1741,658,1776,663,1811,664,1847,655,1884,632,1922,613,1938"/>
<area shape="poly" title=" " alt="" coords="609,1934,628,1919,644,1895,652,1872,653,1827,654,1780,661,1755,676,1729,692,1714,696,1718,680,1733,666,1757,659,1781,658,1827,657,1873,649,1898,632,1922,612,1938"/>
<area shape="poly" title=" " alt="" coords="610,1931,629,1918,645,1900,653,1881,661,1861,676,1840,709,1814,712,1818,680,1844,666,1864,658,1883,649,1903,632,1922,612,1935"/>
<area shape="poly" title=" " alt="" coords="611,1962,663,1970,663,1975,610,1967"/>
<area shape="poly" title=" " alt="" coords="724,1968,722,1958,729,1949,743,1943,765,1941,789,1944,803,1950,800,1955,787,1949,765,1947,744,1949,732,1953,727,1959,729,1967"/>
<area shape="poly" title=" " alt="" coords="501,2173,499,2163,505,2154,520,2149,542,2147,566,2149,580,2155,578,2160,565,2154,542,2152,521,2154,509,2159,504,2165,506,2172"/>
<area shape="poly" title=" " alt="" coords="599,2170,692,2136,694,2141,601,2175"/>
<area shape="poly" title=" " alt="" coords="724,2092,722,2082,729,2073,743,2067,765,2065,789,2068,803,2074,800,2079,787,2073,765,2071,744,2073,732,2077,727,2083,729,2091"/>
<area shape="poly" title=" " alt="" coords="802,2179,850,2142,924,2071,977,2012,1021,1946,1064,1854,1084,1786,1103,1694,1135,1470,1158,1247,1172,1090,1177,1090,1164,1247,1141,1471,1109,1695,1090,1788,1068,1856,1026,1948,982,2015,927,2075,853,2146,805,2183"/>
<area shape="poly" title=" " alt="" coords="806,2179,829,2163,850,2143,869,2113,879,2086,886,2058,897,2022,965,1857,970,1859,902,2024,891,2059,884,2088,874,2115,854,2146,833,2167,809,2183"/>
<area shape="poly" title=" " alt="" coords="724,2181,722,2171,729,2162,743,2157,765,2155,789,2157,803,2163,800,2168,787,2162,765,2160,744,2162,732,2167,727,2173,729,2180"/>
<area shape="poly" title=" " alt="" coords="501,1868,499,1858,505,1849,520,1843,542,1841,566,1844,580,1850,578,1855,565,1849,542,1847,521,1849,509,1853,504,1859,506,1867"/>
<area shape="poly" title=" " alt="" coords="612,988,628,976,641,960,647,944,652,912,656,879,663,862,676,845,680,842,684,845,680,849,668,865,661,881,657,913,653,946,645,963,632,980,616,992"/>
<area shape="poly" title=" " alt="" coords="614,988,628,976,646,948,654,922,654,895,652,868,649,841,650,813,658,785,676,756,680,752,684,755,680,759,663,787,655,814,654,841,657,867,660,895,659,922,651,951,632,979,618,992"/>
<area shape="poly" title=" " alt="" coords="615,988,628,976,651,937,660,899,658,861,652,824,645,786,644,747,652,707,676,667,679,664,683,667,681,670,657,709,649,747,651,785,657,823,664,861,665,899,656,939,632,979,619,992"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_icgraph" id="agroup__direct__netcdf__mod_ga5a0dc19e06b1c54e04d3bd0921f674a1_icgraph">
<area shape="rect" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,287,1352,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1149,310,1117,310,1117,305,1149,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga7b0931795ec7b987d9782e4998a62b51" name="ga7b0931795ec7b987d9782e4998a62b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b0931795ec7b987d9782e4998a62b51">&#9670;&#160;</a></span>wait_to_receive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::wait_to_receive </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>state_ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recv_pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ensemble_member</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(i8), intent(in)&#160;</td>
          <td class="paramname"><em>finish</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive data from a reader. Start and finish are the local indicies in the copies array for the data being received. If all variables are transposed at once, start = 1, finish = ens_handlemy_num_vars (on receiveing pe) This routine must be called with a corresponding 'send_to_waiting_task'. The data on the sender is non-contiguous since it is a ROW of copies. </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02176">2176</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_cgraph" id="agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_cgraph">
<area shape="rect" title="Receive data from a reader. Start and finish are the local indicies in the copies array for the data ..." alt="" coords="5,91,142,131"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="665,71,794,111"/>
<area shape="poly" title=" " alt="" coords="106,88,145,68,189,52,251,41,314,36,378,35,441,38,556,52,651,69,650,74,556,57,440,44,378,41,315,41,252,47,190,58,147,73,109,92"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="190,91,356,131"/>
<area shape="poly" title=" " alt="" coords="142,108,174,108,174,114,142,114"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="208,156,338,197"/>
<area shape="poly" title=" " alt="" coords="138,129,195,148,193,153,137,134"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="865,5,992,46"/>
<area shape="poly" title=" " alt="" coords="793,68,849,49,851,54,794,73"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="865,71,992,111"/>
<area shape="poly" title=" " alt="" coords="794,88,849,88,849,94,794,94"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="862,136,995,161"/>
<area shape="poly" title=" " alt="" coords="795,107,868,128,866,133,793,112"/>
<area shape="poly" title=" " alt="" coords="235,91,233,81,239,72,253,66,273,64,295,66,307,73,305,77,293,72,273,69,254,71,243,76,238,82,240,89"/>
<area shape="poly" title=" " alt="" coords="327,153,355,141,378,126,403,114,467,99,532,90,650,85,650,91,533,95,468,104,405,119,381,131,357,145,329,158"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="404,153,597,179"/>
<area shape="poly" title=" " alt="" coords="338,171,388,168,389,174,338,176"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="472,204,529,229"/>
<area shape="poly" title=" " alt="" coords="339,185,457,206,456,211,338,190"/>
<area shape="poly" title=" " alt="" coords="542,150,650,114,652,119,543,155"/>
<area shape="poly" title=" " alt="" coords="463,154,455,144,460,134,475,128,501,126,528,129,543,136,540,140,527,134,501,131,477,134,464,138,461,144,467,151"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="645,143,814,183"/>
<area shape="poly" title=" " alt="" coords="598,162,630,161,630,167,598,167"/>
<area shape="rect" href="bort_8f.html#adc4659c5e9171f22248cf61e054ddd17" title=" " alt="" coords="708,208,751,233"/>
<area shape="poly" title=" " alt="" coords="530,214,693,217,692,222,530,219"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_icgraph" id="agroup__direct__netcdf__mod_ga7b0931795ec7b987d9782e4998a62b51_icgraph">
<area shape="rect" title="Receive data from a reader. Start and finish are the local indicies in the copies array for the data ..." alt="" coords="1391,287,1527,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1bde9358fa6fadc774d471d0bec36553" title="read a single netcdf file containing all of the members and possibly inflation information" alt="" coords="981,254,1117,295"/>
<area shape="poly" title=" " alt="" coords="1375,303,1118,282,1118,277,1375,298"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4ddfc9953eb0e009c773f60a75a61f78" title="Read in variables from model restart file and transpose so that every processor has all copies of a s..." alt="" coords="1165,315,1343,356"/>
<area shape="poly" title=" " alt="" coords="1375,322,1344,326,1343,321,1375,316"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga2cf6bb0500d00f01633c84ba7fc0be63" title="Read in the state vectors into an ensemble handle The copies will end up in the state_ens_handlecopie..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="966,284,743,304,743,299,965,279"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="615,283,552,259,450,237,370,228,288,222,184,207,127,196,128,190,185,202,289,217,370,223,451,231,553,254,616,278"/>
<area shape="rect" href="closest__member__tool_8f90.html#a7e46bc7a5ff90cd4579f151415c605aa" title="Select the member closest to the ensemble mean." alt="" coords="393,269,538,295"/>
<area shape="poly" title=" " alt="" coords="584,299,538,294,539,288,585,294"/>
<area shape="rect" href="model__mod__check_8f90.html#a0e457caf0d1bc6e343f9fda665a1e066" title=" " alt="" coords="418,371,514,396"/>
<area shape="poly" title=" " alt="" coords="601,336,504,373,502,368,599,331"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,345,323,371"/>
<area shape="poly" title=" " alt="" coords="585,321,324,353,323,348,585,315"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="401,420,531,446"/>
<area shape="poly" title=" " alt="" coords="642,341,602,378,554,411,529,422,526,417,551,406,599,374,639,337"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,469,545,495"/>
<area shape="poly" title=" " alt="" coords="654,343,614,403,586,434,554,460,533,471,531,466,551,456,582,430,609,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,519,535,544"/>
<area shape="poly" title=" " alt="" coords="661,343,646,382,623,427,592,472,554,510,536,520,533,516,551,505,588,468,618,424,641,380,656,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,568,546,594"/>
<area shape="poly" title=" " alt="" coords="666,344,652,393,630,450,598,509,578,535,554,559,537,570,534,565,551,555,574,532,594,506,626,448,647,391,661,343"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="402,378,323,369,324,363,403,373"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5e6a92968fe0fa12010bff633ab92549" title="Read and transpose variables in cyclic&#45;cyclic distribution (round robbin)" alt="" coords="981,319,1117,360"/>
<area shape="poly" title=" " alt="" coords="1150,340,1117,341,1117,336,1150,335"/>
<area shape="rect" href="group__state__vector__io__mod.html#gaf000183b2a56395ce9b99897ff7c2c77" title="Read the restart information directly from the model netcdf file." alt="" coords="791,315,933,356"/>
<area shape="poly" title=" " alt="" coords="965,340,933,340,933,334,966,335"/>
<area shape="poly" title=" " alt="" coords="775,325,743,321,743,315,775,320"/>
</map>
</div>

</div>
</div>
<a id="ga4db4441591f610b3e2c4d06480c28535" name="ga4db4441591f610b3e2c4d06480c28535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4db4441591f610b3e2c4d06480c28535">&#9670;&#160;</a></span>write_augmented_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::write_augmented_state </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>file_handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>insert the mean and sd into the input file if the user requests this assumes that the files has already been closed and the variables read in. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000046">Todo:</a></b></dt><dd>: only a single domain for single file read supported. need to consider case for multiple domains. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00751">751</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_cgraph" id="agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_cgraph">
<area shape="rect" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="5,1311,162,1351"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#ad77490836a39d93bafc07d1130b15d03" title=" " alt="" coords="651,437,817,478"/>
<area shape="poly" title=" " alt="" coords="88,1309,131,1190,165,1112,207,1036,268,948,334,863,404,780,474,704,602,574,696,487,699,491,606,578,478,708,408,784,338,866,272,952,212,1039,170,1114,136,1192,94,1311"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="1117,157,1247,198"/>
<area shape="poly" title=" " alt="" coords="84,1310,119,1037,154,826,200,599,228,486,260,379,294,280,332,192,373,118,418,61,442,40,467,24,493,14,520,11,735,11,822,7,891,3,923,4,958,9,995,19,1038,37,1075,59,1109,86,1159,143,1155,147,1105,90,1072,63,1036,41,994,24,957,14,923,9,891,8,822,12,735,16,520,16,494,20,469,29,445,44,422,64,378,120,337,194,299,282,265,381,234,488,206,600,159,827,125,1037,90,1311"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#ae290ccc4e130e2cc3280aff6a920eae5" title="if allow_transpose is ok, allocate the vars if they aren&#39;t already allocated, error out if allow_tran..." alt="" coords="220,1049,387,1090"/>
<area shape="poly" title=" " alt="" coords="89,1309,104,1268,129,1214,164,1157,208,1106,222,1096,225,1100,211,1110,168,1160,134,1216,109,1270,94,1311"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#afeab8324b47d0683e6156f466d78ae63" title=" " alt="" coords="651,816,817,857"/>
<area shape="poly" title=" " alt="" coords="106,1308,208,1222,260,1186,301,1160,395,1100,564,971,695,865,698,869,568,975,399,1104,304,1165,263,1190,211,1226,109,1312"/>
<area shape="rect" href="group__io__filenames__mod.html#gaa18cdd7babc2d4407b56a32660feb0ba" title="set netcdf file type" alt="" coords="878,1337,1030,1378"/>
<area shape="poly" title=" " alt="" coords="162,1331,863,1352,863,1358,162,1336"/>
<area shape="rect" href="namespacemodel__mod.html#abdcc8e59be0bed36526d6db26905201e" title="Returns the size of the DART state vector (i.e. model) as an integer." alt="" coords="210,1261,397,1287"/>
<area shape="poly" title=" " alt="" coords="161,1308,235,1289,237,1294,163,1313"/>
<area shape="rect" href="group__io__filenames__mod.html#gaee132c42cb29edf14a9214b9dee5fcb5" title="Return the appropriate input file for copy and domain." alt="" coords="227,1392,380,1433"/>
<area shape="poly" title=" " alt="" coords="142,1349,233,1384,231,1389,140,1354"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a1dc986aa083a10802a643bb28852a379" title="! Return my_pe corresponding to the physical task" alt="" coords="220,1481,387,1522"/>
<area shape="poly" title=" " alt="" coords="107,1350,154,1394,211,1442,253,1471,250,1475,208,1446,150,1398,104,1354"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="1113,1720,1250,1761"/>
<area shape="poly" title=" " alt="" coords="93,1351,108,1398,133,1461,167,1529,212,1592,283,1676,314,1711,345,1740,379,1764,418,1781,464,1791,520,1795,735,1795,887,1790,1037,1770,1097,1758,1098,1763,1037,1775,887,1795,735,1800,520,1800,463,1797,416,1786,376,1768,342,1744,310,1715,279,1680,208,1595,163,1532,128,1463,103,1400,88,1353"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="661,1539,807,1579"/>
<area shape="poly" title=" " alt="" coords="93,1351,107,1391,131,1442,165,1492,187,1514,211,1531,264,1557,320,1574,378,1585,437,1590,550,1588,645,1575,646,1581,550,1593,437,1596,378,1590,319,1580,262,1562,208,1536,183,1518,161,1496,126,1445,102,1393,88,1353"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1b7ae906009b2de66351c7a1bb904987" title="Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for ..." alt="" coords="662,1859,806,1899"/>
<area shape="poly" title=" " alt="" coords="90,1351,103,1450,127,1591,144,1663,164,1728,186,1780,212,1814,260,1849,314,1873,372,1890,431,1899,490,1903,547,1902,646,1893,647,1898,547,1908,490,1908,430,1905,370,1895,312,1878,257,1853,208,1818,182,1783,159,1730,139,1664,122,1592,97,1451,84,1352"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a8484d5e765733567bfc5fc3ac349926c" title=" " alt="" coords="871,575,1037,615"/>
<area shape="poly" title=" " alt="" coords="770,476,908,564,905,568,767,481"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="1099,427,1265,467"/>
<area shape="poly" title=" " alt="" coords="818,458,871,459,954,461,1037,459,1083,456,1083,461,1037,464,954,466,871,464,818,463"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a2fdde01fcc94334a27304883a3a24ed2" title=" " alt="" coords="871,116,1037,157"/>
<area shape="poly" title=" " alt="" coords="737,436,751,383,776,312,815,236,840,200,869,168,873,164,877,168,873,172,844,203,820,238,781,314,756,385,742,438"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#aa36862e3808e22729932c05309787cad" title=" " alt="" coords="871,205,1037,246"/>
<area shape="poly" title=" " alt="" coords="742,436,761,398,789,350,825,301,869,257,875,252,879,256,872,261,829,304,793,353,766,401,747,438"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a599228d19d5b50bcdb5aad95b661abc5" title=" " alt="" coords="871,295,1037,335"/>
<area shape="poly" title=" " alt="" coords="757,435,808,394,869,351,889,340,892,345,872,356,811,399,761,439"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#afe9b85f8305298bcdcacfb6aecf98554" title=" " alt="" coords="871,51,1037,91"/>
<area shape="poly" title=" " alt="" coords="735,437,745,373,768,285,786,236,808,188,835,143,869,103,873,98,877,102,873,106,840,146,813,191,791,238,773,286,750,374,740,438"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="889,853,1019,894"/>
<area shape="poly" title=" " alt="" coords="741,478,754,541,778,629,817,727,843,774,873,817,900,842,896,846,869,821,838,777,812,729,773,631,749,542,736,479"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="889,767,1019,807"/>
<area shape="poly" title=" " alt="" coords="751,477,933,752,928,755,747,480"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a7855fe1f625a5f81663049bced769a27" title=" " alt="" coords="871,409,1037,450"/>
<area shape="poly" title=" " alt="" coords="817,444,855,440,855,445,818,450"/>
<area shape="rect" href="namespacempi__utilities__mod.html#abf5f213db52aac32b7f0bdf774d1a1d9" title="this must be paired with a single broadcast_send() on one other task, and broadcast_recv() on all oth..." alt="" coords="1117,607,1247,647"/>
<area shape="poly" title=" " alt="" coords="1037,604,1102,613,1101,618,1037,609"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="1344,817,1472,858"/>
<area shape="poly" title=" " alt="" coords="1000,572,1036,554,1059,539,1084,527,1140,511,1186,501,1208,500,1230,504,1254,513,1280,527,1312,555,1338,587,1359,624,1376,663,1397,739,1407,801,1401,802,1392,740,1371,665,1355,626,1334,590,1308,558,1277,532,1252,518,1229,509,1208,506,1186,506,1141,516,1086,532,1062,543,1038,559,1002,576"/>
<area shape="rect" href="namespacempi__utilities__mod.html#a5d695a71f9877df21d7ff2a39dba9821" title="this must be paired with the same number of broadcast_recv()s on all other tasks. it will not return ..." alt="" coords="1117,541,1247,582"/>
<area shape="poly" title=" " alt="" coords="1037,580,1101,571,1102,576,1037,586"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a77071efdef7cc8ea113667122f8a86ef" title=" " alt="" coords="1099,672,1265,713"/>
<area shape="poly" title=" " alt="" coords="996,613,1086,657,1104,664,1102,669,1084,661,993,618"/>
<area shape="poly" title=" " alt="" coords="1009,572,1035,554,1050,537,1058,520,1067,502,1083,484,1099,473,1102,477,1087,488,1071,505,1063,522,1055,540,1039,558,1012,576"/>
<area shape="poly" title=" " alt="" coords="1249,641,1280,658,1317,692,1348,730,1392,802,1388,805,1344,733,1313,695,1277,663,1246,646"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1541,817,1668,858"/>
<area shape="poly" title=" " alt="" coords="1473,835,1525,835,1525,840,1473,840"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1541,1017,1668,1058"/>
<area shape="poly" title=" " alt="" coords="1431,856,1574,1004,1570,1008,1427,860"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1538,622,1671,648"/>
<area shape="poly" title=" " alt="" coords="1427,815,1578,657,1582,661,1431,819"/>
<area shape="poly" title=" " alt="" coords="1248,574,1280,593,1304,616,1325,642,1359,699,1383,755,1400,802,1395,803,1379,757,1354,701,1320,645,1300,620,1277,597,1246,579"/>
<area shape="poly" title=" " alt="" coords="1139,427,1137,417,1144,408,1159,402,1182,400,1206,402,1221,409,1219,414,1205,408,1182,405,1160,407,1147,412,1142,418,1144,425"/>
<area shape="poly" title=" " alt="" coords="912,205,910,195,917,186,932,181,954,179,978,181,992,187,990,192,976,186,954,184,933,186,920,191,915,197,917,204"/>
<area shape="poly" title=" " alt="" coords="912,295,910,285,917,276,932,270,954,268,978,270,992,277,990,282,976,276,954,273,933,275,920,280,915,286,917,293"/>
<area shape="poly" title=" " alt="" coords="1020,887,1075,897,1140,905,1210,905,1278,896,1320,882,1360,863,1362,868,1322,887,1279,902,1210,911,1140,910,1075,903,1019,892"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="1085,861,1278,887"/>
<area shape="poly" title=" " alt="" coords="1019,871,1070,871,1070,876,1019,876"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="1153,962,1210,988"/>
<area shape="poly" title=" " alt="" coords="991,892,1086,941,1139,960,1137,965,1084,945,989,897"/>
<area shape="poly" title=" " alt="" coords="1266,858,1328,848,1329,853,1267,863"/>
<area shape="poly" title=" " alt="" coords="1144,862,1137,852,1141,842,1156,836,1182,834,1209,837,1223,844,1221,848,1208,842,1182,840,1158,842,1145,846,1142,852,1148,859"/>
<area shape="poly" title=" " alt="" coords="1019,772,1075,765,1140,761,1210,762,1279,772,1323,787,1362,807,1360,812,1321,792,1278,778,1210,768,1141,766,1075,770,1020,778"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="1085,788,1278,813"/>
<area shape="poly" title=" " alt="" coords="1019,788,1070,791,1069,796,1019,793"/>
<area shape="poly" title=" " alt="" coords="1264,811,1329,822,1328,827,1263,816"/>
<area shape="rect" href="namespaceutilities__mod.html#ae5919d9aaedac3ac4128d1d68ed05769" title="return whether output should be written from this task" alt="" coords="1102,1138,1261,1164"/>
<area shape="poly" title=" " alt="" coords="974,449,1008,498,1026,529,1040,562,1057,627,1065,683,1066,734,1063,782,1061,830,1062,880,1070,936,1088,999,1103,1035,1122,1069,1162,1124,1157,1128,1118,1072,1098,1038,1082,1001,1064,937,1056,880,1055,830,1058,782,1060,734,1059,684,1052,628,1034,564,1021,532,1004,501,970,452"/>
<area shape="poly" title=" " alt="" coords="1014,407,1035,389,1049,367,1056,346,1058,303,1060,260,1067,237,1083,215,1101,199,1105,203,1087,218,1072,240,1065,261,1063,303,1061,347,1054,369,1039,393,1017,411"/>
<area shape="rect" href="namespaceutilities__mod.html#a4dfab5f032a600c975d376033a7ee61c" title="set whether output is written to a log file or simply ignored" alt="" coords="1122,272,1242,313"/>
<area shape="poly" title=" " alt="" coords="1008,407,1035,389,1050,373,1058,357,1067,340,1083,324,1106,310,1109,315,1087,328,1071,343,1063,359,1054,376,1039,393,1011,411"/>
<area shape="rect" href="namespacempi__utilities__mod.html#a19228477ddb48773bf4fb3858c997d82" title="Synchronize all tasks. This subroutine does not return until all tasks execute this line of code." alt="" coords="1117,337,1247,378"/>
<area shape="poly" title=" " alt="" coords="1019,406,1101,380,1102,385,1021,411"/>
<area shape="rect" href="namespaceutilities__mod.html#ad297e7b3a121a9c280417846a9198ac9" title=" " alt="" coords="1326,477,1490,503"/>
<area shape="poly" title=" " alt="" coords="1012,407,1035,389,1047,373,1052,356,1055,322,1059,288,1068,273,1083,258,1134,231,1157,225,1180,223,1204,226,1228,233,1280,258,1306,278,1330,302,1365,357,1389,414,1403,461,1398,462,1384,416,1361,360,1325,305,1303,282,1277,263,1226,238,1203,231,1180,228,1158,230,1135,236,1087,263,1072,276,1065,290,1060,322,1058,357,1051,375,1039,393,1016,411"/>
<area shape="poly" title=" " alt="" coords="1144,1139,1137,1130,1141,1120,1156,1114,1182,1112,1209,1114,1223,1121,1221,1126,1208,1119,1182,1117,1158,1119,1145,1124,1142,1129,1148,1136"/>
<area shape="poly" title=" " alt="" coords="1219,196,1252,223,1281,259,1298,294,1309,326,1317,383,1319,442,1329,515,1367,675,1400,802,1395,803,1362,677,1324,516,1314,442,1312,383,1304,327,1293,296,1276,262,1248,227,1215,201"/>
<area shape="poly" title=" " alt="" coords="1139,157,1137,147,1144,138,1159,133,1182,131,1206,133,1221,139,1219,144,1205,138,1182,136,1160,138,1147,143,1142,149,1144,156"/>
<area shape="poly" title=" " alt="" coords="1249,368,1266,377,1280,389,1293,412,1309,453,1343,570,1401,802,1396,803,1338,571,1304,455,1288,415,1276,393,1263,382,1246,373"/>
<area shape="poly" title=" " alt="" coords="1429,501,1575,610,1572,615,1426,505"/>
<area shape="poly" title=" " alt="" coords="768,855,825,890,902,931,992,970,1086,998,1140,1010,1184,1018,1227,1016,1277,998,1315,973,1346,939,1371,903,1389,871,1394,873,1375,906,1350,943,1318,977,1280,1003,1228,1021,1184,1024,1139,1016,1084,1003,990,975,900,936,823,894,765,860"/>
<area shape="poly" title=" " alt="" coords="762,813,811,782,870,753,923,734,979,720,1083,701,1083,706,980,725,925,740,872,757,813,786,765,818"/>
<area shape="poly" title=" " alt="" coords="737,815,752,764,778,696,816,624,841,591,869,561,918,525,973,497,1029,476,1082,461,1084,466,1031,481,975,502,921,529,872,565,845,594,821,627,782,699,757,766,743,816"/>
<area shape="poly" title=" " alt="" coords="818,848,874,857,873,863,817,853"/>
<area shape="poly" title=" " alt="" coords="817,815,873,802,874,808,818,820"/>
<area shape="poly" title=" " alt="" coords="912,1337,910,1327,917,1318,932,1313,954,1311,978,1313,992,1319,990,1324,976,1318,954,1316,933,1318,920,1323,915,1329,917,1336"/>
<area shape="poly" title=" " alt="" coords="267,1262,260,1252,264,1242,279,1236,303,1234,330,1237,344,1244,341,1248,329,1242,303,1240,280,1242,268,1246,265,1252,271,1259"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="451,1253,591,1294"/>
<area shape="poly" title=" " alt="" coords="397,1271,436,1271,436,1276,397,1276"/>
<area shape="rect" href="namespacemodel__mod.html#a517753ac903f85d18d0550d12235b833" title="Called to do one time initialization of the model. In this case, it reads in the grid information,..." alt="" coords="445,1164,597,1205"/>
<area shape="poly" title=" " alt="" coords="336,1258,454,1209,456,1214,338,1263"/>
<area shape="poly" title=" " alt="" coords="481,1253,479,1243,485,1234,500,1229,521,1227,544,1229,558,1235,556,1240,543,1234,521,1232,501,1234,489,1239,484,1245,486,1252"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="1112,1256,1252,1297"/>
<area shape="poly" title=" " alt="" coords="592,1271,1096,1273,1096,1279,592,1277"/>
<area shape="poly" title=" " alt="" coords="1251,1257,1276,1238,1310,1196,1337,1148,1359,1097,1375,1046,1395,948,1403,873,1408,874,1400,949,1380,1047,1364,1099,1342,1151,1315,1199,1280,1242,1254,1261"/>
<area shape="poly" title=" " alt="" coords="532,1162,550,1135,576,1104,607,1073,644,1050,691,1032,735,1021,778,1015,818,1015,894,1026,966,1044,1038,1062,1112,1070,1150,1067,1190,1060,1232,1046,1277,1025,1318,993,1350,952,1375,909,1392,871,1397,873,1380,912,1355,955,1322,997,1280,1029,1234,1051,1192,1065,1151,1073,1112,1075,1037,1067,965,1050,893,1031,817,1021,778,1021,736,1026,693,1037,647,1055,610,1078,580,1107,555,1138,537,1165"/>
<area shape="rect" href="namespaceutilities__mod.html#ada43bd6e7099952a626e082d7fa0e440" title="Confirms that a namelist read was successful. If it failed produces an error message and stops execut..." alt="" coords="1113,1188,1250,1229"/>
<area shape="poly" title=" " alt="" coords="598,1193,646,1198,892,1207,1098,1207,1098,1213,892,1213,645,1203,597,1198"/>
<area shape="rect" href="namespaceutilities__mod.html#ada0bc0fbdb62dda0a03f7b23a7de35aa" title="unfortunately you can&#39;t pass a namelist as an argument, so all modules with namelists have to call wr..." alt="" coords="650,1089,818,1115"/>
<area shape="poly" title=" " alt="" coords="560,1161,644,1123,663,1117,664,1122,646,1128,563,1166"/>
<area shape="rect" href="namespaceutilities__mod.html#a57146d1bf098cd251ef93abb838d1f30" title="return whether nml should be written to terminal for more details see above." alt="" coords="645,1162,823,1188"/>
<area shape="poly" title=" " alt="" coords="598,1178,630,1177,630,1182,598,1184"/>
<area shape="rect" href="namespacemodel__mod.html#aff0144ea4fcf84973812d4a1d4d9c823" title="Fill the qty_stagger array to tell what type of stagger each variable has. This will be useful for in..." alt="" coords="663,1449,805,1490"/>
<area shape="poly" title=" " alt="" coords="582,1203,599,1216,644,1269,680,1328,707,1386,725,1434,720,1435,702,1388,676,1330,640,1272,596,1220,579,1207"/>
<area shape="poly" title=" " alt="" coords="1249,1192,1277,1174,1306,1140,1331,1102,1351,1061,1368,1018,1390,938,1400,873,1406,874,1395,939,1373,1020,1356,1063,1336,1105,1311,1144,1280,1178,1252,1196"/>
<area shape="poly" title=" " alt="" coords="1247,1185,1277,1174,1421,1116,1542,1062,1544,1067,1423,1121,1279,1179,1249,1190"/>
<area shape="poly" title=" " alt="" coords="819,1108,1087,1138,1086,1143,818,1114"/>
<area shape="poly" title=" " alt="" coords="699,1090,692,1080,696,1070,710,1064,734,1062,760,1065,773,1072,771,1076,759,1070,734,1068,712,1070,699,1074,697,1080,703,1087"/>
<area shape="poly" title=" " alt="" coords="823,1168,1086,1153,1087,1159,823,1173"/>
<area shape="poly" title=" " alt="" coords="699,1163,692,1154,696,1144,710,1138,734,1136,760,1138,773,1145,771,1150,759,1143,734,1141,712,1143,699,1148,697,1153,703,1160"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="884,1655,1024,1695"/>
<area shape="poly" title=" " alt="" coords="773,1488,824,1525,883,1584,930,1641,926,1644,879,1588,821,1529,770,1493"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="884,1427,1024,1467"/>
<area shape="poly" title=" " alt="" coords="805,1460,868,1453,868,1458,806,1465"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="884,1516,1024,1557"/>
<area shape="poly" title=" " alt="" coords="804,1488,871,1508,869,1514,803,1493"/>
<area shape="poly" title=" " alt="" coords="912,1655,910,1645,917,1636,932,1630,954,1628,978,1630,992,1637,990,1642,976,1636,954,1633,933,1635,920,1640,915,1646,917,1653"/>
<area shape="poly" title=" " alt="" coords="912,1427,910,1417,917,1408,932,1402,954,1400,978,1402,992,1409,990,1414,976,1408,954,1405,933,1407,920,1412,915,1418,917,1425"/>
<area shape="poly" title=" " alt="" coords="989,1514,1035,1477,1073,1435,1107,1389,1159,1309,1164,1312,1112,1392,1077,1438,1039,1481,992,1518"/>
<area shape="poly" title=" " alt="" coords="912,1516,910,1506,917,1497,932,1491,954,1489,978,1492,992,1498,990,1503,976,1497,954,1495,933,1497,920,1501,915,1507,917,1515"/>
<area shape="poly" title=" " alt="" coords="262,1392,260,1382,267,1373,281,1367,303,1365,327,1368,341,1374,339,1379,326,1373,303,1371,283,1373,270,1377,265,1383,267,1391"/>
<area shape="poly" title=" " alt="" coords="262,1481,260,1471,267,1462,281,1457,303,1455,327,1457,341,1463,339,1468,326,1462,303,1460,283,1462,270,1467,265,1473,267,1480"/>
<area shape="poly" title=" " alt="" coords="1186,1719,1395,873,1400,874,1191,1720"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="1338,1720,1478,1761"/>
<area shape="poly" title=" " alt="" coords="1251,1738,1322,1738,1322,1743,1251,1743"/>
<area shape="poly" title=" " alt="" coords="782,1536,804,1520,820,1500,830,1472,836,1427,843,1298,839,946,836,762,837,596,847,468,856,424,868,396,888,378,908,369,929,366,950,366,993,366,1014,359,1035,345,1048,331,1055,316,1060,287,1064,255,1071,239,1083,223,1105,204,1109,208,1087,226,1076,242,1069,257,1065,287,1060,318,1052,334,1039,349,1017,364,994,371,950,372,929,371,909,374,891,382,873,399,861,426,852,469,843,596,841,761,844,946,848,1298,842,1428,835,1473,825,1503,808,1524,786,1540"/>
<area shape="poly" title=" " alt="" coords="776,1536,800,1520,821,1500,837,1471,843,1444,849,1417,869,1389,873,1385,877,1389,873,1393,854,1419,848,1446,842,1473,825,1503,803,1524,779,1540"/>
<area shape="poly" title=" " alt="" coords="775,1577,901,1645,899,1649,773,1582"/>
<area shape="poly" title=" " alt="" coords="767,1536,869,1478,883,1472,885,1476,872,1483,769,1541"/>
<area shape="poly" title=" " alt="" coords="807,1549,868,1543,868,1548,808,1554"/>
<area shape="poly" title=" " alt="" coords="808,1561,919,1577,980,1594,1038,1617,1072,1636,1103,1660,1154,1707,1150,1711,1100,1664,1069,1641,1036,1621,978,1599,918,1583,807,1566"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="884,1859,1024,1899"/>
<area shape="poly" title=" " alt="" coords="750,1579,802,1664,873,1771,928,1845,924,1848,868,1774,798,1666,746,1581"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="873,1720,1035,1761"/>
<area shape="poly" title=" " alt="" coords="752,1578,801,1640,835,1674,872,1705,880,1710,877,1714,869,1709,831,1678,797,1643,748,1582"/>
<area shape="poly" title=" " alt="" coords="912,1859,910,1849,917,1840,932,1834,954,1832,978,1834,992,1841,990,1846,976,1840,954,1837,933,1839,920,1844,915,1850,917,1857"/>
<area shape="poly" title=" " alt="" coords="1035,1738,1097,1738,1097,1743,1035,1743"/>
<area shape="poly" title=" " alt="" coords="745,1857,793,1785,828,1743,869,1706,876,1701,880,1705,872,1710,832,1747,797,1788,749,1860"/>
<area shape="poly" title=" " alt="" coords="741,1857,789,1751,826,1683,869,1617,916,1565,920,1569,873,1621,831,1686,794,1753,746,1859"/>
<area shape="poly" title=" " alt="" coords="787,1897,841,1914,904,1925,972,1926,1005,1920,1036,1909,1077,1882,1112,1846,1141,1808,1161,1773,1166,1776,1145,1811,1116,1849,1081,1886,1038,1913,1006,1925,972,1931,904,1931,839,1919,785,1902"/>
<area shape="poly" title=" " alt="" coords="806,1876,868,1876,868,1882,806,1882"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="884,1997,1024,2038"/>
<area shape="poly" title=" " alt="" coords="769,1898,908,1986,906,1991,766,1902"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="884,2087,1024,2127"/>
<area shape="poly" title=" " alt="" coords="751,1898,801,1968,835,2009,872,2048,907,2076,904,2080,869,2052,831,2012,797,1971,747,1901"/>
<area shape="poly" title=" " alt="" coords="912,1997,910,1987,917,1978,932,1973,954,1971,978,1973,992,1979,990,1984,976,1978,954,1976,933,1978,920,1983,915,1989,917,1996"/>
<area shape="poly" title=" " alt="" coords="912,2087,910,2077,917,2068,932,2062,954,2060,978,2062,992,2069,990,2074,976,2068,954,2065,933,2067,920,2072,915,2078,917,2085"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_icgraph" id="agroup__direct__netcdf__mod_ga4db4441591f610b3e2c4d06480c28535_icgraph">
<area shape="rect" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="294,5,450,46"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="100,13,246,39"/>
<area shape="poly" title=" " alt="" coords="279,28,247,28,247,23,279,23"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="5,13,52,39"/>
<area shape="poly" title=" " alt="" coords="84,28,52,28,52,23,84,23"/>
</map>
</div>

</div>
</div>
<a id="ga06dc065665c83c091c1b4c4feb5c16b8" name="ga06dc065665c83c091c1b4c4feb5c16b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga06dc065665c83c091c1b4c4feb5c16b8">&#9670;&#160;</a></span>write_extra_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_extra_attributes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_dimid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>file_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>copy_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write out extra copies (if specified in the filter_nml) attribute in the last time slot. This is only used when writting single file diagnostc/restart files. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000068">Todo:</a></b></dt><dd>we should always write double, unless the single output namelist flag is set. this gives you no way to write single precision if you've compiled with normal r8 - FIXME </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000069">Todo:</a></b></dt><dd>ONLY ONE DOMAIN FOR SINGLE FILES </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02466">2466</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_cgraph" id="agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_cgraph">
<area shape="rect" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="5,343,152,383"/>
<area shape="rect" href="group__io__filenames__mod.html#gaa18cdd7babc2d4407b56a32660feb0ba" title="set netcdf file type" alt="" coords="205,29,357,70"/>
<area shape="poly" title=" " alt="" coords="81,341,92,290,114,221,148,147,171,112,198,81,202,77,206,81,202,85,175,115,153,150,119,223,97,291,86,343"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="211,119,351,159"/>
<area shape="poly" title=" " alt="" coords="85,341,102,305,126,260,158,212,198,170,204,166,207,170,201,174,162,216,130,262,106,308,90,343"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="211,208,351,249"/>
<area shape="poly" title=" " alt="" coords="99,340,143,300,198,259,208,254,211,258,201,264,146,304,102,344"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="211,297,351,338"/>
<area shape="poly" title=" " alt="" coords="151,344,195,334,196,339,153,349"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="211,387,351,427"/>
<area shape="poly" title=" " alt="" coords="152,376,196,386,195,391,151,381"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="660,444,791,485"/>
<area shape="poly" title=" " alt="" coords="106,382,148,412,201,436,259,452,319,463,440,474,552,475,645,470,645,476,553,481,440,480,318,468,258,457,199,442,145,416,103,386"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="657,1585,794,1626"/>
<area shape="poly" title=" " alt="" coords="97,382,140,430,169,455,201,475,257,496,310,503,361,501,409,495,456,492,502,496,525,503,548,514,570,530,593,552,607,575,620,611,643,719,664,862,682,1024,710,1348,725,1570,719,1570,705,1348,677,1025,659,863,638,720,614,613,602,577,589,555,567,534,545,519,523,508,501,501,456,497,409,500,361,506,310,508,256,502,198,480,166,459,137,434,93,385"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="200,1163,362,1203"/>
<area shape="poly" title=" " alt="" coords="87,383,273,1147,268,1148,82,384"/>
<area shape="poly" title=" " alt="" coords="242,29,240,19,247,10,260,5,281,3,303,5,316,11,314,16,301,10,281,8,262,10,250,15,246,20,248,28"/>
<area shape="poly" title=" " alt="" coords="242,119,240,109,247,100,260,94,281,92,303,94,316,101,314,105,301,100,281,97,262,99,250,104,246,110,248,117"/>
<area shape="poly" title=" " alt="" coords="242,208,240,198,247,189,260,183,281,181,303,184,316,190,314,195,301,189,281,187,262,189,250,193,246,199,248,207"/>
<area shape="poly" title=" " alt="" coords="242,297,240,287,247,278,260,273,281,271,303,273,316,279,314,284,301,278,281,276,262,278,250,283,246,288,248,296"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="655,327,796,367"/>
<area shape="poly" title=" " alt="" coords="351,320,640,339,640,344,351,325"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="866,444,994,485"/>
<area shape="poly" title=" " alt="" coords="764,366,881,433,878,438,762,370"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1051,379,1178,419"/>
<area shape="poly" title=" " alt="" coords="988,441,1040,422,1042,427,990,446"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1051,444,1178,485"/>
<area shape="poly" title=" " alt="" coords="994,462,1036,462,1036,467,994,467"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1048,509,1181,535"/>
<area shape="poly" title=" " alt="" coords="995,482,1057,501,1056,506,994,487"/>
<area shape="poly" title=" " alt="" coords="242,387,240,377,247,368,260,362,281,360,303,362,316,369,314,373,301,368,281,365,262,367,250,372,246,378,248,385"/>
<area shape="poly" title=" " alt="" coords="791,462,850,462,850,467,791,467"/>
<area shape="poly" title=" " alt="" coords="687,444,685,434,691,425,705,419,726,417,748,420,761,426,759,431,746,425,725,423,706,425,694,429,690,435,692,443"/>
<area shape="poly" title=" " alt="" coords="728,1584,920,499,925,500,733,1585"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="860,1585,1000,1626"/>
<area shape="poly" title=" " alt="" coords="795,1603,844,1603,844,1608,795,1608"/>
<area shape="poly" title=" " alt="" coords="281,1162,290,1043,312,868,328,779,350,697,376,632,391,607,408,589,455,560,478,552,501,549,524,552,547,559,570,571,593,589,607,610,621,644,645,747,666,884,684,1040,711,1353,725,1570,720,1570,706,1353,679,1041,661,885,640,748,616,646,603,612,589,593,567,576,545,564,523,557,501,555,480,557,457,565,412,593,396,610,381,634,355,699,334,780,317,869,295,1043,286,1163"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="420,627,582,667"/>
<area shape="poly" title=" " alt="" coords="282,1162,297,1061,324,916,342,842,361,774,384,718,408,679,411,675,415,679,412,682,388,720,366,776,347,844,329,918,303,1062,288,1163"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="431,716,571,757"/>
<area shape="poly" title=" " alt="" coords="280,1162,285,1089,303,984,319,927,341,870,371,816,408,768,416,761,419,765,412,771,375,819,346,872,324,928,308,985,290,1090,285,1162"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="425,805,577,846"/>
<area shape="poly" title=" " alt="" coords="282,1162,292,1103,314,1022,330,978,351,934,377,893,408,857,412,853,416,857,412,861,381,897,356,937,335,980,319,1023,297,1104,287,1163"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="431,895,571,935"/>
<area shape="poly" title=" " alt="" coords="285,1161,301,1117,326,1060,361,999,383,971,408,946,415,941,419,945,412,950,387,975,366,1002,330,1062,306,1119,291,1163"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="418,984,583,1025"/>
<area shape="poly" title=" " alt="" coords="293,1161,340,1100,372,1065,408,1036,417,1030,420,1034,412,1040,376,1069,344,1103,298,1164"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="431,1073,571,1114"/>
<area shape="poly" title=" " alt="" coords="327,1160,409,1125,427,1117,429,1122,411,1129,329,1165"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="431,1163,571,1203"/>
<area shape="poly" title=" " alt="" coords="362,1180,415,1180,415,1186,362,1186"/>
<area shape="rect" href="group__state__structure__mod.html#ga66d88ca7f0eeb73d74f5be11ce71da9b" title="Return short_name of a variable if it exist." alt="" coords="431,1252,571,1293"/>
<area shape="poly" title=" " alt="" coords="334,1201,435,1243,433,1248,332,1206"/>
<area shape="rect" href="group__state__structure__mod.html#ga4025efcde2bd8bc702bb10b26b393075" title="Return units of a variable if it exist." alt="" coords="431,1341,571,1382"/>
<area shape="poly" title=" " alt="" coords="303,1202,351,1249,412,1302,452,1331,449,1335,408,1306,348,1253,300,1205"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="431,1431,571,1471"/>
<area shape="poly" title=" " alt="" coords="293,1202,338,1290,372,1343,412,1392,447,1420,444,1424,408,1396,367,1346,333,1293,288,1205"/>
<area shape="rect" href="group__io__filenames__mod.html#ga34c52d7cbf0e9288483454380aedafe8" title="Determine whether a copy could potentially have units. Copies such as Spread and Inflation never have..." alt="" coords="416,1520,585,1561"/>
<area shape="poly" title=" " alt="" coords="289,1203,303,1256,327,1329,363,1408,386,1446,412,1481,445,1509,441,1513,408,1485,382,1449,358,1411,322,1331,298,1258,284,1204"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="410,1585,591,1626"/>
<area shape="poly" title=" " alt="" coords="286,1204,292,1273,311,1371,327,1424,349,1477,377,1526,412,1571,415,1574,412,1578,408,1574,372,1529,344,1479,322,1426,306,1372,287,1274,280,1204"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga97512c742d614257d5013e176e85a3a9" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="412,1651,590,1691"/>
<area shape="poly" title=" " alt="" coords="284,1204,288,1283,293,1337,304,1398,319,1461,342,1524,372,1583,412,1636,415,1639,412,1643,408,1639,368,1586,337,1526,314,1463,298,1399,288,1338,282,1283,279,1204"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad501af477a3530059fd8cac992d89632" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="412,1716,590,1757"/>
<area shape="poly" title=" " alt="" coords="287,1203,302,1307,328,1456,346,1533,365,1604,388,1662,412,1701,415,1704,411,1708,408,1705,383,1664,360,1605,340,1534,323,1457,296,1308,282,1204"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga09f849b5b89663f36e43ba4058555515" title="Write clamping to variable attributes to files created from scratch." alt="" coords="429,1781,573,1836"/>
<area shape="poly" title=" " alt="" coords="287,1204,300,1319,326,1487,343,1574,363,1654,386,1721,412,1767,418,1773,414,1777,408,1770,381,1723,358,1656,338,1575,321,1488,295,1319,282,1204"/>
<area shape="poly" title=" " alt="" coords="459,627,457,617,464,608,479,602,501,600,524,602,539,609,536,614,523,608,501,605,480,607,467,612,462,618,464,625"/>
<area shape="poly" title=" " alt="" coords="459,716,457,706,464,697,479,691,501,689,524,692,539,698,536,703,523,697,501,695,480,697,467,701,462,707,464,715"/>
<area shape="poly" title=" " alt="" coords="459,805,457,795,464,786,479,781,501,779,524,781,539,787,536,792,523,786,501,784,480,786,467,791,462,797,464,804"/>
<area shape="poly" title=" " alt="" coords="459,895,457,885,464,876,479,870,501,868,524,870,539,877,536,882,523,876,501,873,480,875,467,880,462,886,464,893"/>
<area shape="poly" title=" " alt="" coords="459,984,457,974,464,965,479,959,501,957,524,960,539,966,536,971,523,965,501,963,480,965,467,969,462,975,464,983"/>
<area shape="poly" title=" " alt="" coords="459,1073,457,1063,464,1054,479,1049,501,1047,524,1049,539,1055,536,1060,523,1054,501,1052,480,1054,467,1059,462,1065,464,1072"/>
<area shape="poly" title=" " alt="" coords="459,1163,457,1153,464,1144,479,1138,501,1136,524,1138,539,1145,536,1150,523,1144,501,1141,480,1143,467,1148,462,1154,464,1161"/>
<area shape="poly" title=" " alt="" coords="459,1252,457,1242,464,1233,479,1227,501,1225,524,1228,539,1234,536,1239,523,1233,501,1231,480,1233,467,1237,462,1243,464,1251"/>
<area shape="poly" title=" " alt="" coords="459,1341,457,1331,464,1322,479,1317,501,1315,524,1317,539,1323,536,1328,523,1322,501,1320,480,1322,467,1327,462,1333,464,1340"/>
<area shape="poly" title=" " alt="" coords="459,1431,457,1421,464,1412,479,1406,501,1404,524,1406,539,1413,536,1418,523,1412,501,1409,480,1411,467,1416,462,1422,464,1429"/>
<area shape="poly" title=" " alt="" coords="459,1520,457,1510,464,1501,479,1495,501,1493,524,1496,539,1502,536,1507,523,1501,501,1499,480,1501,467,1505,462,1511,464,1519"/>
<area shape="poly" title=" " alt="" coords="592,1603,641,1603,641,1608,592,1608"/>
<area shape="poly" title=" " alt="" coords="572,1648,641,1627,642,1632,574,1653"/>
<area shape="poly" title=" " alt="" coords="565,1713,590,1701,614,1682,638,1661,678,1633,681,1637,641,1665,618,1686,593,1705,567,1718"/>
<area shape="poly" title=" " alt="" coords="572,1780,589,1767,607,1741,614,1716,620,1690,637,1661,670,1633,673,1637,641,1665,625,1692,619,1717,612,1743,593,1770,575,1784"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="655,1699,796,1739"/>
<area shape="poly" title=" " alt="" coords="570,1777,638,1750,656,1743,658,1748,640,1755,572,1782"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="639,1788,812,1829"/>
<area shape="poly" title=" " alt="" coords="573,1806,624,1806,624,1811,573,1811"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="641,1877,810,1918"/>
<area shape="poly" title=" " alt="" coords="573,1834,659,1869,657,1874,571,1839"/>
<area shape="poly" title=" " alt="" coords="687,1699,685,1689,691,1680,705,1674,726,1672,748,1674,761,1681,759,1685,746,1680,725,1677,706,1679,694,1684,690,1690,692,1697"/>
<area shape="poly" title=" " alt="" coords="687,1788,685,1778,691,1769,705,1763,726,1761,748,1764,761,1770,759,1775,746,1769,725,1767,706,1769,694,1773,690,1779,692,1787"/>
<area shape="poly" title=" " alt="" coords="687,1877,685,1867,691,1858,705,1853,726,1851,748,1853,761,1859,759,1864,746,1858,725,1856,706,1858,694,1863,690,1868,692,1876"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_icgraph" id="agroup__direct__netcdf__mod_ga06dc065665c83c091c1b4c4feb5c16b8_icgraph">
<area shape="rect" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1003,243,1149,284"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="805,271,955,312"/>
<area shape="poly" title=" " alt="" coords="988,279,956,284,955,278,987,274"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="600,89,757,129"/>
<area shape="poly" title=" " alt="" coords="1007,240,732,132,734,127,1009,235"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="607,275,750,316"/>
<area shape="poly" title=" " alt="" coords="789,296,750,297,750,292,789,291"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,275,552,316"/>
<area shape="poly" title=" " alt="" coords="592,298,553,298,553,293,592,293"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,26,331,51"/>
<area shape="poly" title=" " alt="" coords="657,263,595,143,550,66,526,52,498,41,441,29,384,26,332,29,331,24,384,21,442,24,500,36,528,47,554,62,600,140,662,260"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,339,315,365"/>
<area shape="poly" title=" " alt="" coords="593,322,553,330,425,346,315,353,314,347,425,340,552,325,592,317"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,235,306,261"/>
<area shape="poly" title=" " alt="" coords="592,274,552,266,419,253,306,250,306,245,419,248,553,261,593,269"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,286,137,311"/>
<area shape="poly" title=" " alt="" coords="626,326,553,354,451,383,368,402,328,405,286,403,238,394,184,380,153,366,125,349,84,314,87,310,129,344,156,362,186,375,239,389,286,397,328,399,367,396,450,378,551,349,624,321"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,492,515,518"/>
<area shape="poly" title=" " alt="" coords="664,331,620,403,590,442,554,475,517,495,514,490,551,471,586,438,616,400,659,328"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,467,323,493"/>
<area shape="poly" title=" " alt="" coords="656,330,612,380,584,404,554,425,496,449,435,466,376,476,324,481,323,475,375,470,433,461,494,444,551,420,581,400,609,376,652,327"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,594,524,619"/>
<area shape="poly" title=" " alt="" coords="673,332,659,385,636,450,602,517,580,549,554,576,524,595,521,591,551,572,575,545,597,515,631,448,654,384,668,331"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,568,323,594"/>
<area shape="poly" title=" " alt="" coords="671,332,657,378,633,433,599,487,578,512,554,533,513,550,453,563,324,579,323,574,452,558,511,545,551,528,574,508,595,484,628,431,652,377,666,330"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,76,545,102"/>
<area shape="poly" title=" " alt="" coords="660,263,642,227,618,188,587,148,551,115,532,105,534,100,554,111,591,145,622,185,647,225,665,260"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,126,535,151"/>
<area shape="poly" title=" " alt="" coords="652,264,609,213,581,187,551,165,529,154,531,149,554,160,585,183,613,209,657,261"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,175,546,201"/>
<area shape="poly" title=" " alt="" coords="633,269,551,222,507,204,509,199,554,217,636,265"/>
<area shape="poly" title=" " alt="" coords="427,266,377,215,310,124,265,53,269,50,314,121,381,211,431,263"/>
<area shape="poly" title=" " alt="" coords="374,323,309,341,308,336,373,318"/>
<area shape="poly" title=" " alt="" coords="363,275,306,261,307,256,365,270"/>
<area shape="poly" title=" " alt="" coords="363,299,137,301,137,295,363,294"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,26,94,51"/>
<area shape="poly" title=" " alt="" coords="169,41,95,41,95,36,169,36"/>
<area shape="poly" title=" " alt="" coords="195,267,122,288,120,282,194,262"/>
<area shape="poly" title=" " alt="" coords="400,500,323,490,324,485,401,495"/>
<area shape="poly" title=" " alt="" coords="391,600,323,592,324,586,392,595"/>
<area shape="poly" title=" " alt="" coords="645,81,602,48,578,33,552,22,487,10,421,10,359,17,307,28,306,22,358,12,420,4,487,5,553,17,580,28,605,43,648,76"/>
</map>
</div>

</div>
</div>
<a id="ga1b7ae906009b2de66351c7a1bb904987" name="ga1b7ae906009b2de66351c7a1bb904987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1b7ae906009b2de66351c7a1bb904987">&#9670;&#160;</a></span>write_extra_variables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_extra_variables </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>model_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>copyname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>curr_ens_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timeindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for the when writting single file diagnostc/restart files. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000067">Todo:</a></b></dt><dd>ONLY ONE DOMAIN FOR SINGLE FILE OUTPUT </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02400">2400</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_cgraph" id="agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_cgraph">
<area shape="rect" title="Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for ..." alt="" coords="5,253,150,294"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="198,29,338,70"/>
<area shape="poly" title=" " alt="" coords="85,252,125,171,157,124,196,81,200,77,204,81,200,85,161,127,130,174,89,254"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="198,119,338,159"/>
<area shape="poly" title=" " alt="" coords="98,251,142,211,196,170,205,165,208,169,199,175,145,216,102,255"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="198,208,338,249"/>
<area shape="poly" title=" " alt="" coords="150,254,182,246,183,251,151,259"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="198,297,338,338"/>
<area shape="poly" title=" " alt="" coords="151,288,183,295,182,300,150,293"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="198,387,338,427"/>
<area shape="poly" title=" " alt="" coords="110,292,227,375,224,380,107,297"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="199,452,337,493"/>
<area shape="poly" title=" " alt="" coords="92,293,134,362,164,402,199,437,205,441,201,445,196,441,160,405,129,365,87,296"/>
<area shape="poly" title=" " alt="" coords="232,29,230,19,236,10,249,5,268,3,288,5,301,11,298,16,287,10,268,8,250,10,239,15,235,20,237,28"/>
<area shape="poly" title=" " alt="" coords="232,119,230,109,236,100,249,94,268,92,288,94,301,101,298,105,287,100,268,97,250,99,239,104,235,110,237,117"/>
<area shape="poly" title=" " alt="" coords="232,208,230,198,236,189,249,183,268,181,288,184,301,190,298,195,287,189,268,187,250,189,239,193,235,199,237,207"/>
<area shape="poly" title=" " alt="" coords="232,297,230,287,236,278,249,273,268,271,288,273,301,279,298,284,287,278,268,276,250,278,239,283,235,288,237,296"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="386,308,526,349"/>
<area shape="poly" title=" " alt="" coords="338,319,371,321,370,326,338,324"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="574,341,703,382"/>
<area shape="poly" title=" " alt="" coords="527,339,559,345,558,350,526,344"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="754,276,881,317"/>
<area shape="poly" title=" " alt="" coords="695,338,745,320,746,325,697,343"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="754,341,881,382"/>
<area shape="poly" title=" " alt="" coords="703,359,738,359,738,364,703,364"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="751,406,884,432"/>
<area shape="poly" title=" " alt="" coords="704,380,761,398,760,404,702,385"/>
<area shape="poly" title=" " alt="" coords="232,387,230,377,236,368,249,362,268,360,288,362,301,369,298,373,287,368,268,365,250,367,239,372,235,378,237,385"/>
<area shape="poly" title=" " alt="" coords="336,449,559,382,560,388,338,454"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="386,452,526,493"/>
<area shape="poly" title=" " alt="" coords="337,470,371,470,371,475,337,475"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_icgraph" id="agroup__direct__netcdf__mod_ga1b7ae906009b2de66351c7a1bb904987_icgraph">
<area shape="rect" title="Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for ..." alt="" coords="989,243,1133,284"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="600,89,757,129"/>
<area shape="poly" title=" " alt="" coords="994,240,730,132,732,127,996,235"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga53e97fc6bd08a2af8be0d542ecc56a58" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="805,271,941,312"/>
<area shape="poly" title=" " alt="" coords="974,279,942,284,941,279,973,274"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,26,331,51"/>
<area shape="poly" title=" " alt="" coords="645,81,602,48,578,33,552,22,487,10,421,10,359,17,307,28,306,22,358,12,420,4,487,5,553,17,580,28,605,43,648,76"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,26,94,51"/>
<area shape="poly" title=" " alt="" coords="169,41,95,41,95,36,169,36"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="607,275,750,316"/>
<area shape="poly" title=" " alt="" coords="789,296,750,297,750,292,789,291"/>
<area shape="poly" title=" " alt="" coords="657,263,595,143,550,66,526,52,498,41,441,29,384,26,332,29,331,24,384,21,442,24,500,36,528,47,554,62,600,140,662,260"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,275,552,316"/>
<area shape="poly" title=" " alt="" coords="592,298,553,298,553,293,592,293"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,230,315,255"/>
<area shape="poly" title=" " alt="" coords="592,274,552,266,425,252,314,246,315,241,425,247,553,261,593,269"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,339,306,365"/>
<area shape="poly" title=" " alt="" coords="593,322,553,330,419,346,306,353,306,348,419,341,552,325,592,317"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,339,137,365"/>
<area shape="poly" title=" " alt="" coords="625,326,553,353,452,378,370,389,288,389,184,380,121,368,122,363,185,374,289,384,370,384,451,373,552,348,623,321"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,442,515,467"/>
<area shape="poly" title=" " alt="" coords="654,330,610,378,583,403,554,425,515,443,513,439,551,420,580,399,607,374,650,326"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,467,323,493"/>
<area shape="poly" title=" " alt="" coords="668,332,651,370,627,412,594,451,554,482,523,495,491,504,425,510,362,505,309,496,310,491,363,500,425,504,490,498,521,490,551,477,591,448,622,409,646,367,663,330"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,543,524,569"/>
<area shape="poly" title=" " alt="" coords="669,332,653,376,628,428,596,480,554,526,522,545,519,540,551,522,591,477,624,425,648,374,664,330"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,568,323,594"/>
<area shape="poly" title=" " alt="" coords="676,332,666,390,645,460,629,495,609,529,584,559,554,583,523,599,490,609,456,614,421,615,355,609,301,597,302,592,356,604,421,610,455,609,489,604,521,594,551,579,580,555,604,526,624,493,640,458,661,388,671,331"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,76,545,102"/>
<area shape="poly" title=" " alt="" coords="660,263,642,227,618,188,587,148,551,115,532,105,534,100,554,111,591,145,622,185,647,225,665,260"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,126,535,151"/>
<area shape="poly" title=" " alt="" coords="652,264,609,213,581,187,551,165,529,154,531,149,554,160,585,183,613,209,657,261"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,175,546,201"/>
<area shape="poly" title=" " alt="" coords="633,269,551,222,507,204,509,199,554,217,636,265"/>
<area shape="poly" title=" " alt="" coords="427,266,377,215,310,124,265,53,269,50,314,121,381,211,431,263"/>
<area shape="poly" title=" " alt="" coords="369,274,310,258,312,253,370,268"/>
<area shape="poly" title=" " alt="" coords="374,323,307,341,306,336,373,318"/>
<area shape="poly" title=" " alt="" coords="364,307,185,329,127,341,126,336,184,324,364,301"/>
<area shape="poly" title=" " alt="" coords="194,354,137,354,137,349,194,349"/>
<area shape="poly" title=" " alt="" coords="401,465,324,474,323,469,400,460"/>
<area shape="poly" title=" " alt="" coords="392,567,324,576,323,570,391,562"/>
</map>
</div>

</div>
</div>
<a id="ga490370b86f88f566fa0e84c367401b0a" name="ga490370b86f88f566fa0e84c367401b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga490370b86f88f566fa0e84c367401b0a">&#9670;&#160;</a></span>write_model_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_model_attributes </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>member_dimid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_dimid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>file_handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write model attributes to for each variable when using "single file io". </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000064">Todo:</a></b></dt><dd>we should always write double, unless the single output namelist flag is set. this gives you no way to write single precision if you've compiled with normal r8 - FIXME </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000065">Todo:</a></b></dt><dd>ONLY ONE DOMAIN FOR SINGLE FILES </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000066">Todo:</a></b></dt><dd>if we already have a unique names we can take this test out </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02309">2309</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_cgraph" id="agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_cgraph">
<area shape="rect" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="5,422,158,463"/>
<area shape="rect" href="group__state__structure__mod.html#gac1ff557084c37c7e9ee32f2deb248c5d" title="Transform the state type to a domain that can be used to write diagnostic files. One domain for the w..." alt="" coords="217,5,357,61"/>
<area shape="poly" title=" " alt="" coords="82,422,90,356,109,264,125,214,146,163,172,115,204,71,205,70,209,73,208,75,176,118,151,166,130,216,115,266,95,357,87,422"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="217,109,357,150"/>
<area shape="poly" title=" " alt="" coords="84,421,96,369,118,300,154,226,177,192,204,161,208,157,212,161,208,164,181,195,158,229,123,302,101,371,89,422"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="217,198,357,239"/>
<area shape="poly" title=" " alt="" coords="89,421,105,385,131,339,164,292,204,250,210,245,213,249,207,254,168,295,135,342,110,387,94,423"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="217,288,357,328"/>
<area shape="poly" title=" " alt="" coords="102,420,147,380,204,339,215,333,217,338,207,343,151,384,106,424"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="217,377,357,418"/>
<area shape="poly" title=" " alt="" coords="158,423,201,413,202,419,159,428"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="217,466,357,507"/>
<area shape="poly" title=" " alt="" coords="159,456,202,466,201,471,158,461"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="666,524,797,564"/>
<area shape="poly" title=" " alt="" coords="109,461,153,491,207,516,265,531,325,542,446,553,559,554,651,549,651,555,559,560,446,559,324,547,264,536,205,521,150,496,106,465"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="663,1665,800,1706"/>
<area shape="poly" title=" " alt="" coords="101,462,145,509,175,533,207,553,264,574,317,581,367,579,415,573,462,570,508,575,554,594,576,610,599,632,613,654,626,691,649,799,670,942,688,1104,716,1427,731,1649,725,1650,711,1427,683,1104,665,942,644,800,620,692,608,656,595,635,573,614,551,598,507,580,462,576,416,579,367,584,316,586,262,580,204,558,172,538,142,513,97,465"/>
<area shape="rect" href="group__state__structure__mod.html#ga992db47810ea7c2d14da8cfaf2dd8038" title=" " alt="" coords="217,632,357,672"/>
<area shape="poly" title=" " alt="" coords="96,462,139,533,171,574,207,611,222,621,218,626,204,615,167,578,135,536,91,465"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga507c64d98551df97643e9e549a1e3a6d" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="206,1242,368,1283"/>
<area shape="poly" title=" " alt="" coords="91,463,279,1226,274,1228,85,464"/>
<area shape="poly" title=" " alt="" coords="248,109,246,99,252,90,266,84,287,82,309,85,322,91,320,96,308,90,287,87,267,89,256,94,251,100,253,108"/>
<area shape="poly" title=" " alt="" coords="248,198,246,188,252,179,266,174,287,172,309,174,322,180,320,185,308,179,287,177,267,179,256,183,251,189,253,197"/>
<area shape="poly" title=" " alt="" coords="248,287,246,278,252,269,266,263,287,261,309,263,322,269,320,274,308,268,287,266,267,268,256,273,251,279,253,286"/>
<area shape="poly" title=" " alt="" coords="248,377,246,367,252,358,266,352,287,350,309,353,322,359,320,364,308,358,287,355,267,357,256,362,251,368,253,376"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="661,406,802,447"/>
<area shape="poly" title=" " alt="" coords="357,399,646,418,646,424,357,404"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="872,524,1000,564"/>
<area shape="poly" title=" " alt="" coords="770,445,887,513,884,517,768,450"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1057,458,1184,499"/>
<area shape="poly" title=" " alt="" coords="994,520,1046,502,1048,507,996,525"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1057,524,1184,564"/>
<area shape="poly" title=" " alt="" coords="1000,541,1042,541,1042,547,1000,547"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1054,588,1187,614"/>
<area shape="poly" title=" " alt="" coords="1001,561,1063,581,1062,586,1000,566"/>
<area shape="poly" title=" " alt="" coords="248,466,246,456,252,447,266,442,287,440,309,442,322,448,320,453,308,447,287,445,267,447,256,451,251,457,253,465"/>
<area shape="poly" title=" " alt="" coords="797,541,856,541,856,547,797,547"/>
<area shape="poly" title=" " alt="" coords="693,523,691,514,697,505,711,499,732,497,754,499,767,505,765,510,752,504,731,502,712,504,700,509,696,515,698,522"/>
<area shape="poly" title=" " alt="" coords="734,1664,926,579,931,580,739,1665"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="866,1665,1006,1706"/>
<area shape="poly" title=" " alt="" coords="801,1683,850,1683,850,1688,801,1688"/>
<area shape="poly" title=" " alt="" coords="287,1242,296,1122,318,948,334,858,356,777,382,711,397,686,414,668,461,639,484,632,507,629,530,631,553,639,576,651,599,669,613,689,627,724,651,827,672,963,690,1120,717,1433,731,1649,726,1649,712,1433,685,1120,667,964,646,828,622,725,609,692,595,672,573,655,551,643,529,636,507,634,486,637,463,644,418,673,402,690,387,714,361,778,340,859,323,948,301,1123,292,1242"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="426,706,588,747"/>
<area shape="poly" title=" " alt="" coords="288,1241,303,1140,330,996,348,922,367,854,390,797,414,758,417,755,421,759,418,761,394,800,372,855,353,923,335,997,309,1141,294,1242"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="437,796,577,836"/>
<area shape="poly" title=" " alt="" coords="286,1242,291,1168,309,1064,325,1006,347,949,377,895,414,847,422,840,425,844,418,851,381,898,352,951,330,1008,314,1065,296,1169,291,1242"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="431,885,583,926"/>
<area shape="poly" title=" " alt="" coords="288,1241,298,1182,320,1101,336,1057,357,1014,383,973,414,937,418,933,422,937,418,940,387,976,362,1016,341,1059,325,1103,303,1184,293,1242"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="437,974,577,1015"/>
<area shape="poly" title=" " alt="" coords="291,1241,307,1197,332,1139,367,1079,389,1051,414,1026,421,1020,425,1024,418,1030,393,1054,372,1082,336,1142,312,1199,297,1243"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="424,1064,589,1104"/>
<area shape="poly" title=" " alt="" coords="299,1240,346,1179,378,1145,414,1115,423,1109,426,1114,418,1119,382,1149,350,1183,304,1243"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="437,1153,577,1194"/>
<area shape="poly" title=" " alt="" coords="333,1239,415,1204,433,1197,435,1202,417,1209,335,1244"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="437,1242,577,1283"/>
<area shape="poly" title=" " alt="" coords="368,1260,421,1260,421,1265,368,1265"/>
<area shape="rect" href="group__state__structure__mod.html#ga66d88ca7f0eeb73d74f5be11ce71da9b" title="Return short_name of a variable if it exist." alt="" coords="437,1332,577,1372"/>
<area shape="poly" title=" " alt="" coords="340,1281,441,1323,439,1328,338,1286"/>
<area shape="rect" href="group__state__structure__mod.html#ga4025efcde2bd8bc702bb10b26b393075" title="Return units of a variable if it exist." alt="" coords="437,1421,577,1462"/>
<area shape="poly" title=" " alt="" coords="309,1281,357,1329,418,1382,458,1410,455,1415,414,1386,354,1333,306,1285"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="437,1510,577,1551"/>
<area shape="poly" title=" " alt="" coords="299,1282,344,1370,378,1422,418,1471,453,1500,450,1504,414,1475,373,1426,339,1372,294,1284"/>
<area shape="rect" href="group__io__filenames__mod.html#ga34c52d7cbf0e9288483454380aedafe8" title="Determine whether a copy could potentially have units. Copies such as Spread and Inflation never have..." alt="" coords="422,1600,591,1640"/>
<area shape="poly" title=" " alt="" coords="295,1283,309,1336,333,1408,369,1488,392,1526,418,1561,451,1589,447,1593,414,1564,388,1529,364,1490,328,1410,304,1337,290,1284"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="416,1665,597,1706"/>
<area shape="poly" title=" " alt="" coords="292,1283,298,1352,317,1450,333,1503,355,1556,383,1606,418,1650,421,1653,418,1657,414,1654,378,1609,350,1559,328,1505,312,1451,293,1353,286,1284"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga97512c742d614257d5013e176e85a3a9" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="418,1730,596,1771"/>
<area shape="poly" title=" " alt="" coords="290,1283,294,1362,299,1417,310,1477,325,1541,348,1603,378,1663,418,1715,421,1719,418,1723,414,1719,374,1666,343,1606,320,1542,304,1478,294,1418,288,1363,285,1283"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad501af477a3530059fd8cac992d89632" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="418,1796,596,1836"/>
<area shape="poly" title=" " alt="" coords="293,1283,308,1386,334,1536,352,1613,371,1683,394,1741,418,1781,421,1784,417,1787,414,1784,389,1744,366,1685,346,1614,329,1537,302,1387,288,1283"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga09f849b5b89663f36e43ba4058555515" title="Write clamping to variable attributes to files created from scratch." alt="" coords="435,1860,579,1916"/>
<area shape="poly" title=" " alt="" coords="293,1283,306,1398,332,1566,349,1654,369,1734,392,1800,418,1846,424,1853,420,1856,414,1849,387,1803,364,1735,344,1655,327,1567,301,1399,288,1284"/>
<area shape="poly" title=" " alt="" coords="465,706,463,696,470,687,485,682,507,680,530,682,545,688,542,693,529,687,507,685,486,687,473,691,468,697,470,705"/>
<area shape="poly" title=" " alt="" coords="465,795,463,786,470,776,485,771,507,769,530,771,545,777,542,782,529,776,507,774,486,776,473,781,468,787,470,794"/>
<area shape="poly" title=" " alt="" coords="465,885,463,875,470,866,485,860,507,858,530,861,545,867,542,872,529,866,507,863,486,865,473,870,468,876,470,884"/>
<area shape="poly" title=" " alt="" coords="465,974,463,964,470,955,485,950,507,948,530,950,545,956,542,961,529,955,507,953,486,955,473,959,468,965,470,973"/>
<area shape="poly" title=" " alt="" coords="465,1063,463,1054,470,1044,485,1039,507,1037,530,1039,545,1045,542,1050,529,1044,507,1042,486,1044,473,1049,468,1055,470,1062"/>
<area shape="poly" title=" " alt="" coords="465,1153,463,1143,470,1134,485,1128,507,1126,530,1129,545,1135,542,1140,529,1134,507,1131,486,1133,473,1138,468,1144,470,1152"/>
<area shape="poly" title=" " alt="" coords="465,1242,463,1232,470,1223,485,1218,507,1216,530,1218,545,1224,542,1229,529,1223,507,1221,486,1223,473,1227,468,1233,470,1241"/>
<area shape="poly" title=" " alt="" coords="465,1331,463,1322,470,1312,485,1307,507,1305,530,1307,545,1313,542,1318,529,1312,507,1310,486,1312,473,1317,468,1323,470,1330"/>
<area shape="poly" title=" " alt="" coords="465,1421,463,1411,470,1402,485,1396,507,1394,530,1397,545,1403,542,1408,529,1402,507,1399,486,1401,473,1406,468,1412,470,1420"/>
<area shape="poly" title=" " alt="" coords="465,1510,463,1500,470,1491,485,1486,507,1484,530,1486,545,1492,542,1497,529,1491,507,1489,486,1491,473,1495,468,1501,470,1509"/>
<area shape="poly" title=" " alt="" coords="465,1599,463,1590,470,1580,485,1575,507,1573,530,1575,545,1581,542,1586,529,1580,507,1578,486,1580,473,1585,468,1591,470,1598"/>
<area shape="poly" title=" " alt="" coords="598,1683,647,1683,647,1688,598,1688"/>
<area shape="poly" title=" " alt="" coords="578,1727,647,1707,648,1712,580,1732"/>
<area shape="poly" title=" " alt="" coords="571,1793,596,1780,620,1761,644,1740,684,1712,687,1716,647,1745,624,1766,599,1785,573,1797"/>
<area shape="poly" title=" " alt="" coords="578,1860,595,1846,613,1820,620,1796,626,1769,643,1741,676,1712,679,1716,647,1744,631,1771,625,1797,618,1823,599,1850,581,1864"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="661,1778,802,1819"/>
<area shape="poly" title=" " alt="" coords="576,1857,644,1829,662,1822,664,1827,646,1834,578,1862"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="645,1868,818,1908"/>
<area shape="poly" title=" " alt="" coords="579,1885,630,1885,630,1891,579,1891"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="647,1957,816,1998"/>
<area shape="poly" title=" " alt="" coords="579,1914,665,1948,663,1953,577,1919"/>
<area shape="poly" title=" " alt="" coords="693,1778,691,1768,697,1759,711,1754,732,1752,754,1754,767,1760,765,1765,752,1759,731,1757,712,1759,700,1763,696,1769,698,1777"/>
<area shape="poly" title=" " alt="" coords="693,1867,691,1858,697,1849,711,1843,732,1841,754,1843,767,1849,765,1854,752,1848,731,1846,712,1848,700,1853,696,1859,698,1866"/>
<area shape="poly" title=" " alt="" coords="693,1957,691,1947,697,1938,711,1932,732,1930,754,1933,767,1939,765,1944,752,1938,731,1935,712,1937,700,1942,696,1948,698,1956"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_icgraph" id="agroup__direct__netcdf__mod_ga490370b86f88f566fa0e84c367401b0a_icgraph">
<area shape="rect" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="989,287,1141,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="791,287,941,328"/>
<area shape="poly" title=" " alt="" coords="973,310,941,310,941,305,973,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga9832acfa2d0a5df09bb4a312efa0d407" name="ga9832acfa2d0a5df09bb4a312efa0d407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9832acfa2d0a5df09bb4a312efa0d407">&#9670;&#160;</a></span>write_model_variables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_model_variables </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1netcdf__file__type.html">netcdf_file_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>model_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>memindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structtime__manager__mod_1_1time__type.html">time_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>curr_ens_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>timeindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write state to the last time slice of a file when using "single file io". </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000063">Todo:</a></b></dt><dd>ONLY ONE DOMAIN FOR SINGLE FILE OUTPUT </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l02247">2247</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_cgraph" id="agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_cgraph">
<area shape="rect" title="Write state to the last time slice of a file when using &quot;single file io&quot;." alt="" coords="5,288,156,328"/>
<area shape="rect" href="group__state__structure__mod.html#gac1ff557084c37c7e9ee32f2deb248c5d" title="Transform the state type to a domain that can be used to write diagnostic files. One domain for the w..." alt="" coords="204,5,344,61"/>
<area shape="poly" title=" " alt="" coords="86,286,101,243,125,187,159,127,202,71,204,69,207,73,206,75,163,130,130,189,106,245,91,288"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="204,109,344,150"/>
<area shape="poly" title=" " alt="" coords="93,286,137,225,168,191,202,160,208,156,212,160,205,165,172,195,141,229,97,289"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="204,198,344,239"/>
<area shape="poly" title=" " alt="" coords="125,284,213,243,215,248,128,289"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="204,288,344,328"/>
<area shape="poly" title=" " alt="" coords="156,305,188,305,188,311,156,311"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="204,377,344,418"/>
<area shape="poly" title=" " alt="" coords="128,326,215,367,213,372,125,331"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="204,466,344,507"/>
<area shape="poly" title=" " alt="" coords="103,327,205,427,237,454,233,458,202,431,100,330"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="205,532,343,572"/>
<area shape="poly" title=" " alt="" coords="91,327,107,367,132,417,165,469,206,517,210,520,206,524,202,520,160,473,127,419,102,369,87,329"/>
<area shape="poly" title=" " alt="" coords="238,109,236,99,242,90,255,84,274,82,294,85,307,91,304,96,293,90,274,87,256,89,245,94,241,100,243,108"/>
<area shape="poly" title=" " alt="" coords="238,198,236,188,242,179,255,174,274,172,294,174,307,180,304,185,293,179,274,177,256,179,245,183,241,189,243,197"/>
<area shape="poly" title=" " alt="" coords="238,287,236,278,242,269,255,263,274,261,294,263,307,270,304,274,293,268,274,266,256,268,245,273,241,279,243,286"/>
<area shape="poly" title=" " alt="" coords="238,377,236,367,242,358,255,352,274,350,294,353,307,359,304,364,293,358,274,355,256,357,245,362,241,368,243,376"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="392,388,532,428"/>
<area shape="poly" title=" " alt="" coords="344,398,377,400,376,406,344,404"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="580,421,709,462"/>
<area shape="poly" title=" " alt="" coords="533,418,565,424,564,429,532,423"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="760,356,887,396"/>
<area shape="poly" title=" " alt="" coords="701,418,751,399,752,404,703,423"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="760,421,887,462"/>
<area shape="poly" title=" " alt="" coords="709,439,744,439,744,444,709,444"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="757,486,890,511"/>
<area shape="poly" title=" " alt="" coords="710,459,767,478,766,483,708,464"/>
<area shape="poly" title=" " alt="" coords="238,466,236,456,242,447,255,442,274,440,294,442,307,448,304,453,293,447,274,445,256,447,245,451,241,457,243,465"/>
<area shape="poly" title=" " alt="" coords="342,529,565,462,566,467,344,534"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="392,532,532,572"/>
<area shape="poly" title=" " alt="" coords="343,549,377,549,377,555,343,555"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_icgraph" id="agroup__direct__netcdf__mod_ga9832acfa2d0a5df09bb4a312efa0d407_icgraph">
<area shape="rect" title="Write state to the last time slice of a file when using &quot;single file io&quot;." alt="" coords="975,287,1125,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga53e97fc6bd08a2af8be0d542ecc56a58" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="791,287,927,328"/>
<area shape="poly" title=" " alt="" coords="960,310,927,310,927,305,960,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga53e97fc6bd08a2af8be0d542ecc56a58" name="ga53e97fc6bd08a2af8be0d542ecc56a58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53e97fc6bd08a2af8be0d542ecc56a58">&#9670;&#160;</a></span>write_single_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public direct_netcdf_mod::write_single_file </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structensemble__manager__mod_1_1ensemble__type.html">ensemble_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ens_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1file__info__type.html">file_info_type</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>file_handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write all variable to a single file including all member, and optionally inflation, mean, sd </p>
<p>@ todo FIXME : This sync is not necessary but ensures that all of the variable information gets written out if filter happens to crash in the middle of a run. This may slow down the code for longer runs.</p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00656">656</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_cgraph" id="agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_cgraph">
<area shape="rect" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="5,1072,142,1112"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#ad77490836a39d93bafc07d1130b15d03" title=" " alt="" coords="200,460,367,500"/>
<area shape="poly" title=" " alt="" coords="79,1070,187,739,267,514,272,516,192,741,84,1072"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="901,842,1029,883"/>
<area shape="poly" title=" " alt="" coords="73,1071,82,919,103,685,118,560,137,444,160,346,173,306,187,275,229,208,272,155,319,115,370,86,426,64,489,50,639,31,696,19,744,6,766,3,788,5,811,14,835,31,843,44,849,64,860,123,872,289,878,458,883,558,919,708,954,826,949,828,913,710,878,559,872,458,866,289,854,124,844,65,838,46,831,35,808,19,787,10,766,8,745,11,697,24,640,36,490,55,427,69,372,90,322,119,276,159,233,211,192,277,178,308,165,347,142,445,123,561,108,685,87,919,78,1071"/>
<area shape="rect" href="namespacetime__manager__mod.html#a579c796316d18ecb716c5face232cb8c" title=" " alt="" coords="639,1214,833,1239"/>
<area shape="poly" title=" " alt="" coords="85,1111,100,1143,123,1180,153,1216,191,1243,239,1261,280,1263,323,1255,376,1243,400,1233,424,1223,471,1216,508,1217,591,1223,623,1223,623,1228,591,1228,508,1222,471,1222,426,1228,402,1238,378,1248,324,1260,281,1268,238,1266,188,1248,150,1220,119,1183,96,1145,81,1114"/>
<area shape="rect" href="namespacempi__utilities__mod.html#ae08b6543f55b372bd6addea0eb1e04a0" title="Return my unique task id. Values run from 0 to N&#45;1 (where N is the total number of MPI tasks." alt="" coords="671,69,801,110"/>
<area shape="poly" title=" " alt="" coords="73,1071,78,971,95,815,110,724,129,630,155,537,187,447,231,336,251,290,272,248,297,211,329,176,371,142,424,108,481,85,541,74,601,71,655,74,655,79,601,76,542,79,482,90,426,113,374,146,333,179,301,214,276,251,255,292,236,338,192,449,160,538,134,632,115,725,100,815,84,971,78,1071"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#ae290ccc4e130e2cc3280aff6a920eae5" title="if allow_transpose is ok, allocate the vars if they aren&#39;t already allocated, error out if allow_tran..." alt="" coords="200,876,367,916"/>
<area shape="poly" title=" " alt="" coords="82,1070,121,1000,152,960,188,926,193,922,196,927,191,930,156,964,126,1003,86,1072"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#afeab8324b47d0683e6156f466d78ae63" title=" " alt="" coords="200,752,367,792"/>
<area shape="poly" title=" " alt="" coords="80,1070,121,977,152,919,188,862,215,829,244,801,248,804,219,833,192,865,156,921,126,979,85,1072"/>
<area shape="rect" href="group__io__filenames__mod.html#gaa18cdd7babc2d4407b56a32660feb0ba" title="set netcdf file type" alt="" coords="207,1038,360,1079"/>
<area shape="poly" title=" " alt="" coords="142,1078,191,1070,192,1076,143,1084"/>
<area shape="rect" href="namespacemodel__mod.html#abdcc8e59be0bed36526d6db26905201e" title="Returns the size of the DART state vector (i.e. model) as an integer." alt="" coords="190,964,377,990"/>
<area shape="poly" title=" " alt="" coords="94,1069,136,1034,188,1000,204,993,206,998,191,1005,139,1038,98,1073"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a1dc986aa083a10802a643bb28852a379" title="! Return my_pe corresponding to the physical task" alt="" coords="200,1193,367,1234"/>
<area shape="poly" title=" " alt="" coords="112,1110,234,1182,232,1187,109,1115"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="667,1409,805,1450"/>
<area shape="poly" title=" " alt="" coords="79,1112,92,1245,116,1447,150,1654,170,1739,192,1800,237,1889,259,1925,282,1956,308,1983,340,2007,378,2030,426,2053,472,2072,512,2082,531,2081,550,2077,569,2068,590,2054,606,2037,622,2013,649,1948,672,1867,691,1778,717,1598,729,1465,735,1465,722,1599,696,1778,677,1869,654,1950,626,2015,610,2040,593,2058,572,2073,551,2082,531,2087,512,2087,471,2077,424,2058,376,2035,337,2012,305,1987,278,1959,254,1928,233,1892,187,1802,165,1740,144,1655,111,1448,87,1246,74,1113"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga0254908b100e01af1a9f26cc4685bf76" title="We need to compare the time of the current assim_model to the netcdf time coordinate variable (the un..." alt="" coords="215,1104,352,1144"/>
<area shape="poly" title=" " alt="" coords="143,1100,200,1108,199,1114,142,1105"/>
<area shape="rect" href="group__io__filenames__mod.html#gabdde16ce15123f6a0fd3ccd9a03a8bd2" title="Number of output ensemble members." alt="" coords="195,1649,372,1690"/>
<area shape="poly" title=" " alt="" coords="77,1112,77,1199,82,1260,90,1328,104,1401,125,1474,154,1545,192,1610,205,1626,222,1638,219,1643,202,1629,188,1613,149,1548,120,1476,99,1402,85,1329,76,1260,72,1199,71,1112"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga1b7ae906009b2de66351c7a1bb904987" title="Write out extra copies (if specified in the filter_nml) in the last time slot. This is only used for ..." alt="" coords="211,1560,356,1600"/>
<area shape="poly" title=" " alt="" coords="86,1112,270,1544,265,1546,81,1114"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga9832acfa2d0a5df09bb4a312efa0d407" title="Write state to the last time slice of a file when using &quot;single file io&quot;." alt="" coords="208,1749,359,1790"/>
<area shape="poly" title=" " alt="" coords="79,1112,92,1230,115,1404,131,1494,149,1579,169,1649,192,1700,209,1720,230,1738,226,1742,205,1724,187,1703,164,1651,144,1580,125,1495,110,1404,86,1230,74,1113"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a8484d5e765733567bfc5fc3ac349926c" title=" " alt="" coords="425,597,591,638"/>
<area shape="poly" title=" " alt="" coords="320,498,461,586,459,591,317,503"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#acd680bca47a44ef5b88a7beff4843816" title="Return the physical task for my_pe." alt="" coords="653,388,819,428"/>
<area shape="poly" title=" " alt="" coords="367,494,419,500,476,502,534,496,590,481,605,473,614,462,623,451,638,439,650,433,652,437,641,443,627,454,618,466,608,477,592,486,535,501,476,507,418,505,367,500"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a2fdde01fcc94334a27304883a3a24ed2" title=" " alt="" coords="425,253,591,294"/>
<area shape="poly" title=" " alt="" coords="294,458,345,384,381,342,423,304,431,299,434,304,427,309,385,346,349,388,299,461"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#aa36862e3808e22729932c05309787cad" title=" " alt="" coords="425,342,591,383"/>
<area shape="poly" title=" " alt="" coords="315,457,365,426,424,393,437,387,440,392,426,398,368,430,318,461"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a599228d19d5b50bcdb5aad95b661abc5" title=" " alt="" coords="425,432,591,472"/>
<area shape="poly" title=" " alt="" coords="366,467,409,462,409,467,367,472"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#afe9b85f8305298bcdcacfb6aecf98554" title=" " alt="" coords="425,122,591,163"/>
<area shape="poly" title=" " alt="" coords="286,458,300,403,326,327,367,246,393,208,423,174,428,170,431,174,427,178,397,211,371,249,331,329,305,404,291,460"/>
<area shape="rect" href="namespacempi__utilities__mod.html#adec13c965903d1181b4379234d4cc602" title="Receive data into the destination array from the src task. If time is specified, it is received in a ..." alt="" coords="443,720,573,760"/>
<area shape="poly" title=" " alt="" coords="303,499,427,647,480,706,476,710,423,651,299,502"/>
<area shape="rect" href="namespacempi__utilities__mod.html#af398cd54ac6d3c0b7f7f10be44eaf953" title="Send the srcarray to the destination id. If time is specified, it is also sent in a separate communic..." alt="" coords="443,785,573,826"/>
<area shape="poly" title=" " alt="" coords="292,500,306,553,333,625,372,702,398,738,427,770,432,774,428,778,423,774,393,741,368,705,328,627,301,555,287,501"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a7855fe1f625a5f81663049bced769a27" title=" " alt="" coords="425,188,591,228"/>
<area shape="poly" title=" " alt="" coords="289,458,307,413,335,355,374,294,397,265,423,239,429,235,432,239,427,243,401,268,378,297,340,358,312,416,294,460"/>
<area shape="rect" href="namespacempi__utilities__mod.html#abf5f213db52aac32b7f0bdf774d1a1d9" title="this must be paired with a single broadcast_send() on one other task, and broadcast_recv() on all oth..." alt="" coords="671,453,801,494"/>
<area shape="poly" title=" " alt="" coords="562,594,590,576,604,560,613,544,621,527,638,510,656,498,659,502,641,514,626,530,617,546,609,563,593,581,565,599"/>
<area shape="poly" title=" " alt="" coords="553,594,638,553,694,539,740,528,762,527,785,531,808,539,834,554,866,581,893,613,914,650,931,688,953,764,963,826,958,827,948,765,926,690,910,652,889,616,863,584,831,558,806,544,783,536,762,533,741,534,695,544,640,558,555,599"/>
<area shape="rect" href="namespacempi__utilities__mod.html#a5d695a71f9877df21d7ff2a39dba9821" title="this must be paired with the same number of broadcast_recv()s on all other tasks. it will not return ..." alt="" coords="671,568,801,608"/>
<area shape="poly" title=" " alt="" coords="591,604,655,595,656,601,592,609"/>
<area shape="rect" href="namespaceensemble__manager__mod.html#a77071efdef7cc8ea113667122f8a86ef" title=" " alt="" coords="653,633,819,674"/>
<area shape="poly" title=" " alt="" coords="592,628,638,635,637,640,591,633"/>
<area shape="poly" title=" " alt="" coords="567,594,589,577,602,559,608,543,612,509,616,474,624,457,637,439,642,435,645,439,641,443,628,460,621,476,617,509,613,544,606,562,593,580,571,598"/>
<area shape="poly" title=" " alt="" coords="803,488,834,510,865,547,891,588,911,632,928,676,951,760,962,826,957,827,946,761,923,678,907,634,886,591,861,550,831,514,800,493"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="1100,842,1227,883"/>
<area shape="poly" title=" " alt="" coords="1029,860,1085,860,1085,865,1029,865"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="1100,1028,1227,1068"/>
<area shape="poly" title=" " alt="" coords="990,881,1131,1015,1128,1019,986,885"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="1097,542,1230,567"/>
<area shape="poly" title=" " alt="" coords="977,840,1144,579,1148,582,982,843"/>
<area shape="poly" title=" " alt="" coords="803,601,834,619,858,642,879,668,914,724,939,780,956,826,951,828,934,782,909,727,875,671,854,646,831,623,800,605"/>
<area shape="poly" title=" " alt="" coords="693,387,691,378,698,368,713,363,736,361,761,363,775,369,773,374,759,368,736,366,714,368,701,373,696,379,698,386"/>
<area shape="poly" title=" " alt="" coords="466,342,464,332,471,323,486,318,508,316,532,318,547,324,545,329,531,323,508,321,487,323,474,327,469,333,471,341"/>
<area shape="poly" title=" " alt="" coords="466,431,464,422,471,412,486,407,508,405,532,407,547,413,545,418,531,412,508,410,487,412,474,417,469,423,471,430"/>
<area shape="poly" title=" " alt="" coords="573,722,630,714,697,710,766,715,801,722,834,733,867,752,898,776,943,828,939,831,894,780,864,756,832,738,799,728,766,721,697,716,631,719,574,728"/>
<area shape="rect" href="namespacetime__manager__mod.html#a49d0e8625bf9d4526a982406e7cd5415" title=" " alt="" coords="639,998,833,1023"/>
<area shape="poly" title=" " alt="" coords="575,757,593,771,610,796,618,820,619,867,620,913,626,937,641,961,658,976,678,989,675,993,655,981,637,964,622,939,614,914,614,867,613,821,605,799,589,775,572,761"/>
<area shape="rect" href="status_8f.html#ad8a3d1b45f0635666e1570308968da0d" title=" " alt="" coords="707,748,765,774"/>
<area shape="poly" title=" " alt="" coords="574,743,692,754,691,760,573,749"/>
<area shape="poly" title=" " alt="" coords="766,995,831,960,881,926,926,891,929,895,885,930,834,965,769,1000"/>
<area shape="poly" title=" " alt="" coords="698,999,691,989,695,979,711,973,736,971,764,974,778,981,776,985,762,979,736,976,712,978,699,983,696,988,702,996"/>
<area shape="rect" href="namespacetime__manager__mod.html#a7cd4532f00e5dee5fa8ea45296c85675" title=" " alt="" coords="881,1146,1049,1187"/>
<area shape="poly" title=" " alt="" coords="758,1022,922,1135,919,1139,755,1026"/>
<area shape="poly" title=" " alt="" coords="574,810,833,841,886,848,885,854,832,846,574,815"/>
<area shape="poly" title=" " alt="" coords="523,825,557,897,594,990,602,1022,605,1052,604,1104,605,1128,610,1151,622,1175,641,1199,645,1203,641,1207,637,1203,617,1177,605,1153,600,1129,599,1104,600,1052,597,1023,589,991,552,899,518,827"/>
<area shape="poly" title=" " alt="" coords="813,1211,831,1199,848,1178,866,1146,901,1062,930,971,952,897,957,898,936,973,906,1064,871,1148,853,1181,834,1203,816,1215"/>
<area shape="poly" title=" " alt="" coords="787,1210,869,1189,871,1194,789,1216"/>
<area shape="rect" href="namespaceutilities__mod.html#ae5919d9aaedac3ac4128d1d68ed05769" title="return whether output should be written from this task" alt="" coords="885,520,1045,546"/>
<area shape="poly" title=" " alt="" coords="593,224,744,259,834,284,860,308,883,336,919,397,944,456,959,504,954,506,939,458,915,399,879,339,857,312,831,289,743,264,591,229"/>
<area shape="poly" title=" " alt="" coords="567,185,590,172,604,161,613,149,623,138,638,126,658,114,661,119,641,130,627,142,617,153,608,165,593,177,570,189"/>
<area shape="rect" href="namespaceutilities__mod.html#a4dfab5f032a600c975d376033a7ee61c" title="set whether output is written to a log file or simply ignored" alt="" coords="676,184,796,224"/>
<area shape="poly" title=" " alt="" coords="591,204,660,202,661,208,591,209"/>
<area shape="rect" href="namespacempi__utilities__mod.html#a19228477ddb48773bf4fb3858c997d82" title="Synchronize all tasks. This subroutine does not return until all tasks execute this line of code." alt="" coords="671,298,801,339"/>
<area shape="poly" title=" " alt="" coords="568,226,593,239,617,258,641,278,663,289,660,294,638,282,614,263,590,243,566,231"/>
<area shape="rect" href="namespaceutilities__mod.html#ad297e7b3a121a9c280417846a9198ac9" title=" " alt="" coords="883,291,1047,317"/>
<area shape="poly" title=" " alt="" coords="561,184,618,167,688,154,762,152,799,158,834,169,871,191,903,219,929,249,949,276,945,279,925,252,899,223,868,195,832,174,797,163,761,158,688,159,620,172,562,189"/>
<area shape="poly" title=" " alt="" coords="932,521,925,512,929,502,943,496,965,494,989,496,1002,503,999,508,988,501,965,499,944,501,933,506,930,511,936,518"/>
<area shape="poly" title=" " alt="" coords="774,108,807,135,835,170,859,224,872,272,877,316,877,359,873,448,875,499,883,558,920,708,955,826,950,828,914,709,878,559,870,500,868,448,872,359,872,317,867,273,854,226,830,173,803,139,771,112"/>
<area shape="poly" title=" " alt="" coords="693,69,691,59,698,50,713,44,736,42,761,45,775,51,773,56,759,50,736,48,714,49,701,54,696,60,698,68"/>
<area shape="poly" title=" " alt="" coords="803,329,820,338,835,350,854,376,866,400,872,424,874,447,875,497,883,558,956,826,951,828,878,559,870,498,869,447,867,424,861,402,850,379,831,354,817,342,800,333"/>
<area shape="poly" title=" " alt="" coords="979,316,1145,528,1141,531,975,319"/>
<area shape="poly" title=" " alt="" coords="321,790,369,815,426,835,550,857,675,867,791,869,885,866,885,871,791,874,675,872,549,862,424,840,367,820,318,795"/>
<area shape="poly" title=" " alt="" coords="322,748,370,726,424,705,534,678,637,661,638,667,535,684,426,710,372,731,325,753"/>
<area shape="poly" title=" " alt="" coords="293,750,343,671,380,624,423,583,446,567,468,557,508,546,547,534,568,524,590,509,605,491,613,474,621,457,638,439,645,434,648,438,641,443,626,460,617,477,609,494,593,512,570,529,549,539,509,551,470,562,449,572,427,587,384,628,347,674,298,753"/>
<area shape="poly" title=" " alt="" coords="366,757,427,749,428,754,367,763"/>
<area shape="poly" title=" " alt="" coords="367,782,428,791,427,796,366,787"/>
<area shape="poly" title=" " alt="" coords="244,1038,242,1028,248,1019,262,1014,283,1012,306,1014,320,1020,317,1025,305,1019,283,1017,263,1019,251,1023,247,1029,249,1037"/>
<area shape="poly" title=" " alt="" coords="248,966,241,956,246,946,260,940,283,938,309,940,322,947,320,952,308,945,283,943,261,945,249,950,247,955,253,962"/>
<area shape="rect" href="group__state__structure__mod.html#ga2451b499f472d28b8f6869dd668c5911" title="Returns the number of elements in the domain." alt="" coords="438,1261,578,1302"/>
<area shape="poly" title=" " alt="" coords="359,988,379,1000,406,1027,429,1058,465,1125,489,1191,503,1245,498,1246,484,1193,460,1127,424,1061,402,1031,375,1005,356,993"/>
<area shape="rect" href="namespacemodel__mod.html#a517753ac903f85d18d0550d12235b833" title="Called to do one time initialization of the model. In this case, it reads in the grid information,..." alt="" coords="432,1002,584,1043"/>
<area shape="poly" title=" " alt="" coords="351,988,417,1001,416,1007,350,993"/>
<area shape="poly" title=" " alt="" coords="466,1261,464,1251,471,1242,486,1236,508,1234,532,1237,547,1243,545,1248,531,1242,508,1240,487,1241,474,1246,469,1252,471,1260"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="666,1264,806,1304"/>
<area shape="poly" title=" " alt="" coords="579,1279,650,1280,650,1286,579,1285"/>
<area shape="poly" title=" " alt="" coords="805,1267,831,1250,850,1203,884,1104,950,897,955,899,889,1106,855,1205,835,1254,808,1272"/>
<area shape="poly" title=" " alt="" coords="578,1041,635,1053,700,1058,768,1054,801,1046,831,1033,871,1006,904,969,929,930,947,895,952,898,934,933,908,973,875,1010,834,1038,802,1051,769,1059,700,1064,634,1058,577,1046"/>
<area shape="rect" href="namespaceutilities__mod.html#ada43bd6e7099952a626e082d7fa0e440" title="Confirms that a namelist read was successful. If it failed produces an error message and stops execut..." alt="" coords="667,1149,805,1190"/>
<area shape="poly" title=" " alt="" coords="543,1041,692,1138,689,1143,540,1045"/>
<area shape="rect" href="namespaceutilities__mod.html#ada0bc0fbdb62dda0a03f7b23a7de35aa" title="unfortunately you can&#39;t pass a namelist as an argument, so all modules with namelists have to call wr..." alt="" coords="652,924,820,950"/>
<area shape="poly" title=" " alt="" coords="547,999,638,959,658,952,660,957,640,964,550,1004"/>
<area shape="poly" title=" " alt="" coords="804,1147,831,1128,855,1102,877,1073,912,1010,937,948,952,897,958,899,942,950,917,1012,881,1076,859,1106,834,1133,807,1151"/>
<area shape="poly" title=" " alt="" coords="804,1147,1084,1067,1086,1072,806,1152"/>
<area shape="poly" title=" " alt="" coords="744,922,830,785,898,660,948,559,953,562,903,662,835,788,749,925"/>
<area shape="poly" title=" " alt="" coords="698,926,691,916,695,906,711,900,736,898,764,900,778,907,776,912,762,906,736,903,712,905,699,910,696,915,702,922"/>
<area shape="poly" title=" " alt="" coords="244,1193,242,1183,248,1174,262,1168,283,1166,306,1169,320,1175,317,1180,305,1174,283,1172,263,1173,251,1178,247,1184,249,1192"/>
<area shape="poly" title=" " alt="" coords="780,1406,808,1387,831,1362,848,1332,858,1305,866,1254,868,1200,878,1134,915,1003,949,897,954,899,921,1004,883,1135,873,1201,871,1255,863,1306,853,1334,835,1365,811,1391,783,1411"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="895,1409,1035,1450"/>
<area shape="poly" title=" " alt="" coords="805,1427,879,1427,879,1432,805,1432"/>
<area shape="poly" title=" " alt="" coords="352,1132,452,1140,512,1141,577,1138,643,1130,709,1116,772,1094,831,1064,854,1048,874,1028,907,983,933,937,950,896,955,898,937,939,912,986,878,1032,857,1052,834,1069,774,1099,710,1121,644,1135,577,1143,513,1146,452,1145,352,1137"/>
<area shape="poly" title=" " alt="" coords="352,1130,465,1148,592,1179,640,1199,665,1206,664,1212,638,1204,591,1184,464,1154,352,1135"/>
<area shape="poly" title=" " alt="" coords="353,1137,379,1155,398,1185,405,1214,405,1242,401,1271,398,1298,399,1325,407,1351,427,1377,451,1395,477,1410,535,1429,596,1436,652,1436,652,1442,595,1442,534,1434,475,1415,448,1400,423,1380,402,1353,393,1326,393,1298,396,1270,399,1242,400,1214,393,1187,375,1159,350,1141"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad9dc061f4e03f757d1ead8be309c5a28" title="The current time is appended to the &quot;time&quot; coordinate variable. The new length of the &quot;time&quot; variable..." alt="" coords="440,1326,576,1367"/>
<area shape="poly" title=" " alt="" coords="353,1137,379,1155,394,1175,401,1196,404,1235,406,1273,413,1292,427,1311,430,1314,426,1318,423,1315,409,1294,401,1274,399,1235,396,1197,389,1178,375,1159,350,1142"/>
<area shape="poly" title=" " alt="" coords="577,1358,637,1364,705,1362,739,1357,772,1347,803,1333,831,1314,850,1294,861,1275,867,1255,869,1235,870,1189,872,1163,878,1134,950,897,955,898,883,1135,877,1163,875,1189,875,1235,872,1256,866,1277,854,1297,834,1318,806,1338,774,1352,740,1362,705,1367,637,1369,576,1363"/>
<area shape="poly" title=" " alt="" coords="569,1323,590,1311,604,1296,613,1281,621,1265,638,1250,648,1244,651,1248,641,1254,626,1268,617,1283,609,1299,593,1315,572,1328"/>
<area shape="poly" title=" " alt="" coords="567,1365,664,1401,663,1406,565,1370"/>
<area shape="poly" title=" " alt="" coords="244,1649,242,1639,248,1630,262,1624,283,1622,306,1625,320,1631,317,1636,305,1630,283,1628,263,1629,251,1634,247,1640,249,1648"/>
<area shape="poly" title=" " alt="" coords="305,1557,357,1516,389,1495,424,1477,482,1458,541,1444,651,1430,652,1435,542,1449,483,1463,426,1482,392,1499,360,1520,309,1561"/>
<area shape="rect" href="group__state__structure__mod.html#gad92f36893c6ea16e86a11a6070274f66" title="Return dimension length." alt="" coords="438,1873,578,1914"/>
<area shape="poly" title=" " alt="" coords="358,1595,379,1611,398,1640,407,1668,409,1695,408,1722,406,1776,412,1804,427,1834,455,1862,451,1866,423,1837,407,1806,401,1776,402,1721,404,1695,402,1669,393,1642,375,1615,354,1599"/>
<area shape="rect" href="group__state__structure__mod.html#ga9ebb1890db2ed6eabb723a70a0359c9b" title="Returns the dimension name." alt="" coords="438,1516,578,1556"/>
<area shape="poly" title=" " alt="" coords="355,1563,422,1550,423,1555,356,1568"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="438,1605,578,1646"/>
<area shape="poly" title=" " alt="" coords="356,1592,423,1605,422,1611,355,1597"/>
<area shape="rect" href="group__state__structure__mod.html#ga2155f1657ec19fc8f4f4ea52c123c731" title="Returns the number of variables in the domain." alt="" coords="438,1784,578,1824"/>
<area shape="poly" title=" " alt="" coords="358,1596,379,1611,393,1628,400,1645,406,1677,410,1710,416,1727,427,1745,456,1772,452,1776,423,1748,411,1729,405,1711,401,1678,395,1647,388,1631,375,1615,355,1600"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="438,1694,578,1735"/>
<area shape="poly" title=" " alt="" coords="353,1598,378,1611,404,1632,427,1655,464,1683,461,1687,423,1659,400,1636,376,1615,351,1603"/>
<area shape="poly" title=" " alt="" coords="466,1873,464,1863,471,1854,486,1848,508,1846,532,1849,547,1855,545,1860,531,1854,508,1852,487,1853,474,1858,469,1864,471,1872"/>
<area shape="poly" title=" " alt="" coords="466,1515,464,1506,471,1496,486,1491,508,1489,532,1491,547,1497,545,1502,531,1496,508,1494,487,1496,474,1501,469,1507,471,1514"/>
<area shape="poly" title=" " alt="" coords="466,1605,464,1595,471,1586,486,1580,508,1578,532,1581,547,1587,545,1592,531,1586,508,1584,487,1585,474,1590,469,1596,471,1604"/>
<area shape="poly" title=" " alt="" coords="551,1781,572,1765,589,1745,612,1698,622,1655,623,1615,619,1576,615,1536,614,1493,620,1447,637,1396,665,1350,698,1313,702,1317,669,1354,642,1398,625,1448,619,1494,620,1535,625,1575,628,1615,627,1656,617,1700,594,1748,576,1769,554,1785"/>
<area shape="poly" title=" " alt="" coords="466,1783,464,1774,471,1764,486,1759,508,1757,532,1759,547,1765,545,1770,531,1764,508,1762,487,1764,474,1769,469,1775,471,1782"/>
<area shape="poly" title=" " alt="" coords="466,1694,464,1684,471,1675,486,1670,508,1668,532,1670,547,1676,545,1681,531,1675,508,1673,487,1675,474,1679,469,1685,471,1693"/>
<area shape="poly" title=" " alt="" coords="298,1788,318,1821,346,1859,383,1895,426,1923,472,1942,512,1950,530,1950,549,1946,590,1923,616,1892,640,1843,662,1781,681,1712,710,1572,727,1464,733,1465,715,1573,686,1713,667,1783,645,1845,621,1895,593,1927,551,1951,531,1955,511,1956,470,1947,424,1928,379,1899,342,1862,313,1824,293,1791"/>
<area shape="poly" title=" " alt="" coords="323,1788,458,1863,455,1867,321,1792"/>
<area shape="poly" title=" " alt="" coords="321,1746,350,1725,375,1700,386,1682,392,1665,396,1633,402,1601,410,1584,423,1567,427,1564,430,1568,427,1571,414,1587,407,1603,401,1634,397,1666,390,1684,379,1703,353,1729,325,1750"/>
<area shape="poly" title=" " alt="" coords="313,1746,375,1699,398,1677,423,1656,434,1650,436,1655,427,1661,402,1681,379,1703,316,1751"/>
<area shape="poly" title=" " alt="" coords="359,1778,423,1788,422,1793,358,1783"/>
<area shape="poly" title=" " alt="" coords="358,1748,423,1732,424,1738,359,1754"/>
<area shape="rect" href="group__state__structure__mod.html#gac1ff557084c37c7e9ee32f2deb248c5d" title="Transform the state type to a domain that can be used to write diagnostic files. One domain for the w..." alt="" coords="438,1988,578,2044"/>
<area shape="poly" title=" " alt="" coords="298,1789,348,1872,384,1922,427,1967,439,1977,435,1981,423,1971,380,1925,343,1875,293,1792"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_icgraph" id="agroup__direct__netcdf__mod_ga53e97fc6bd08a2af8be0d542ecc56a58_icgraph">
<area shape="rect" title="write all variable to a single file including all member, and optionally inflation,..." alt="" coords="791,287,927,328"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
</map>
</div>

</div>
</div>
<a id="ga507c64d98551df97643e9e549a1e3a6d" name="ga507c64d98551df97643e9e549a1e3a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga507c64d98551df97643e9e549a1e3a6d">&#9670;&#160;</a></span>write_variable_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_variable_attributes </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfileid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncvarid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>varid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structio__filenames__mod_1_1stage__metadata__type.html">stage_metadata_type</a>), intent(in)&#160;</td>
          <td class="paramname"><em>name_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>copy_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write model attributes if they exist. This is only used for files that are created by DART. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000056">Todo:</a></b></dt><dd>FIXME: also need to have different routines for different different types of numbers for add_offset and scale_factor. Keeping it simple for now since they are not being used. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000057">Todo:</a></b></dt><dd>FIXME: should this be independent of the name_handle? right now it is just used to put unitless for the sd and inflation values attributes for variables without units such as inflation and sd </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000058">Todo:</a></b></dt><dd>FIXME: put clamping values with min_val, max_val, valid_range, or whatever the proper CF-range </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01759">1759</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_cgraph" id="agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_cgraph">
<area shape="rect" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="5,700,168,741"/>
<area shape="rect" href="group__io__filenames__mod.html#ga45295fc627a87616894e8881276544bd" title="Determine if a variable should be clamped or not. If clapming information is stored in the state stru..." alt="" coords="225,29,388,70"/>
<area shape="poly" title=" " alt="" coords="87,699,98,575,122,390,139,294,160,206,184,132,198,103,214,81,216,79,220,82,218,85,203,106,189,134,165,207,144,295,127,391,103,575,92,700"/>
<area shape="rect" href="group__state__structure__mod.html#ga0dd12124e61e29f9b276fe998086d325" title="Return offset of a variable if it exists." alt="" coords="236,119,377,159"/>
<area shape="poly" title=" " alt="" coords="87,699,101,590,127,432,144,351,165,276,188,214,214,171,221,163,225,167,218,174,192,216,170,277,150,352,132,433,106,591,93,700"/>
<area shape="rect" href="group__io__filenames__mod.html#ga818dae6f65edfebbe3015940f2fc226c" title="Return whether the file is an input, output or prior files." alt="" coords="230,208,383,249"/>
<area shape="poly" title=" " alt="" coords="85,699,88,619,93,564,104,503,119,438,142,374,173,314,214,260,217,257,221,261,218,263,178,317,147,376,125,440,109,504,99,565,93,620,90,699"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="236,297,377,338"/>
<area shape="poly" title=" " alt="" coords="86,699,94,633,114,540,130,489,152,439,180,391,214,349,221,342,225,346,218,353,184,394,157,441,135,491,119,541,99,634,92,700"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="224,387,389,427"/>
<area shape="poly" title=" " alt="" coords="89,699,102,647,125,578,162,504,186,469,214,438,219,434,222,438,218,442,190,472,166,506,130,580,107,649,94,700"/>
<area shape="rect" href="group__state__structure__mod.html#gaf18f1f0caed8738602335ab270cfe855" title="Return long_name of a variable if it exist." alt="" coords="236,476,377,517"/>
<area shape="poly" title=" " alt="" coords="94,698,112,662,138,616,172,569,214,528,221,522,224,527,217,532,176,572,142,619,116,664,99,701"/>
<area shape="rect" href="group__state__structure__mod.html#ga40a45c901d3f68e6ee72776e7c8be203" title="Return scale factor of a variable if it exists." alt="" coords="236,565,377,606"/>
<area shape="poly" title=" " alt="" coords="108,698,155,657,214,617,226,610,229,615,217,621,158,662,111,702"/>
<area shape="rect" href="group__state__structure__mod.html#ga66d88ca7f0eeb73d74f5be11ce71da9b" title="Return short_name of a variable if it exist." alt="" coords="236,655,377,695"/>
<area shape="poly" title=" " alt="" coords="168,701,220,690,221,695,169,706"/>
<area shape="rect" href="group__state__structure__mod.html#ga4025efcde2bd8bc702bb10b26b393075" title="Return units of a variable if it exist." alt="" coords="236,744,377,785"/>
<area shape="poly" title=" " alt="" coords="169,734,221,745,220,750,168,739"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="236,833,377,874"/>
<area shape="poly" title=" " alt="" coords="123,739,260,823,257,827,120,743"/>
<area shape="rect" href="group__io__filenames__mod.html#ga34c52d7cbf0e9288483454380aedafe8" title="Determine whether a copy could potentially have units. Copies such as Spread and Inflation never have..." alt="" coords="222,923,391,963"/>
<area shape="poly" title=" " alt="" coords="103,739,150,807,182,847,217,884,255,912,252,916,214,888,178,850,145,810,98,742"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="463,1081,600,1122"/>
<area shape="poly" title=" " alt="" coords="95,740,108,788,132,851,168,917,191,947,217,973,240,989,261,998,302,1006,346,1009,370,1014,398,1023,445,1046,487,1071,485,1075,442,1051,396,1028,369,1019,345,1014,301,1011,260,1003,238,993,214,977,187,950,163,920,127,854,103,790,90,742"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga85a4fb44801f712976ce12f96ac367f2" title="Write model integer missing_value/_FillValue attributes if they exist." alt="" coords="216,1037,397,1078"/>
<area shape="poly" title=" " alt="" coords="94,740,106,795,129,868,165,947,189,984,218,1017,229,1027,225,1031,214,1021,185,987,161,950,124,870,101,796,89,742"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga97512c742d614257d5013e176e85a3a9" title="Write model r4 missing_value/_FillValue attributes if they exist." alt="" coords="217,1103,396,1143"/>
<area shape="poly" title=" " alt="" coords="92,741,99,807,119,899,135,950,157,999,184,1046,218,1088,222,1092,218,1096,214,1091,180,1049,152,1002,130,952,114,901,94,808,86,741"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gad501af477a3530059fd8cac992d89632" title="Write model r8 missing_value/_FillValue attributes if they exist." alt="" coords="217,1168,396,1209"/>
<area shape="poly" title=" " alt="" coords="90,741,95,817,112,927,127,987,150,1047,179,1103,218,1153,221,1157,217,1160,214,1157,175,1106,145,1049,122,989,106,928,89,818,85,741"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga09f849b5b89663f36e43ba4058555515" title="Write clamping to variable attributes to files created from scratch." alt="" coords="234,1233,379,1288"/>
<area shape="poly" title=" " alt="" coords="90,741,92,826,97,886,106,952,122,1022,145,1092,176,1159,218,1219,224,1225,220,1229,214,1222,172,1161,140,1094,117,1024,101,953,91,887,86,827,84,741"/>
<area shape="poly" title=" " alt="" coords="265,29,263,19,270,10,284,5,306,3,330,5,344,11,342,16,329,10,306,8,285,10,273,15,268,21,270,28"/>
<area shape="poly" title=" " alt="" coords="265,119,263,109,270,100,284,94,306,92,330,94,344,101,342,106,329,100,306,97,285,99,273,104,268,110,270,117"/>
<area shape="poly" title=" " alt="" coords="265,208,263,198,270,189,284,183,306,181,330,184,344,190,342,195,329,189,306,187,285,189,273,193,268,199,270,207"/>
<area shape="poly" title=" " alt="" coords="265,297,263,287,270,278,284,273,306,271,330,273,344,279,342,284,329,278,306,276,285,278,273,283,268,289,270,296"/>
<area shape="poly" title=" " alt="" coords="265,387,263,377,270,368,284,362,306,360,330,362,344,369,342,374,329,368,306,365,285,367,273,372,268,378,270,385"/>
<area shape="poly" title=" " alt="" coords="265,476,263,466,270,457,284,451,306,449,330,452,344,458,342,463,329,457,306,455,285,457,273,461,268,467,270,475"/>
<area shape="poly" title=" " alt="" coords="265,565,263,555,270,546,284,541,306,539,330,541,344,547,342,552,329,546,306,544,285,546,273,551,268,557,270,564"/>
<area shape="poly" title=" " alt="" coords="265,655,263,645,270,636,284,630,306,628,330,630,344,637,342,642,329,636,306,633,285,635,273,640,268,646,270,653"/>
<area shape="poly" title=" " alt="" coords="265,744,263,734,270,725,284,719,306,717,330,720,344,726,342,731,329,725,306,723,285,725,273,729,268,735,270,743"/>
<area shape="poly" title=" " alt="" coords="265,833,263,823,270,814,284,809,306,807,330,809,344,815,342,820,329,814,306,812,285,814,273,819,268,825,270,832"/>
<area shape="poly" title=" " alt="" coords="265,923,263,913,270,904,284,898,306,896,330,898,344,905,342,910,329,904,306,901,285,903,273,908,268,914,270,921"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="671,1049,800,1090"/>
<area shape="poly" title=" " alt="" coords="600,1088,655,1079,656,1085,601,1094"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="665,1115,806,1155"/>
<area shape="poly" title=" " alt="" coords="601,1110,650,1118,649,1124,600,1115"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="857,984,984,1025"/>
<area shape="poly" title=" " alt="" coords="794,1046,846,1028,848,1033,796,1051"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="857,1049,984,1090"/>
<area shape="poly" title=" " alt="" coords="800,1067,841,1067,841,1072,800,1072"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="854,1114,987,1140"/>
<area shape="poly" title=" " alt="" coords="801,1087,863,1107,861,1112,799,1092"/>
<area shape="poly" title=" " alt="" coords="398,1073,448,1083,447,1088,397,1078"/>
<area shape="poly" title=" " alt="" coords="396,1112,447,1107,447,1112,396,1117"/>
<area shape="poly" title=" " alt="" coords="364,1165,396,1153,444,1133,461,1126,463,1131,446,1137,398,1157,365,1170"/>
<area shape="poly" title=" " alt="" coords="377,1231,395,1218,411,1197,418,1177,426,1155,443,1133,449,1129,452,1133,447,1137,431,1158,423,1178,416,1200,399,1222,381,1236"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="461,1171,601,1211"/>
<area shape="poly" title=" " alt="" coords="378,1236,448,1214,449,1219,379,1241"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="445,1260,617,1301"/>
<area shape="poly" title=" " alt="" coords="379,1264,430,1269,429,1274,378,1269"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="447,1349,615,1390"/>
<area shape="poly" title=" " alt="" coords="367,1286,475,1340,473,1344,364,1291"/>
<area shape="poly" title=" " alt="" coords="492,1171,490,1161,497,1152,511,1146,531,1144,553,1146,567,1153,564,1157,552,1152,531,1149,512,1151,500,1156,496,1162,498,1169"/>
<area shape="poly" title=" " alt="" coords="492,1260,490,1250,497,1241,511,1235,531,1233,553,1236,567,1242,564,1247,552,1241,531,1239,512,1241,500,1245,496,1251,498,1259"/>
<area shape="poly" title=" " alt="" coords="492,1349,490,1339,497,1330,511,1325,531,1323,553,1325,567,1331,564,1336,552,1330,531,1328,512,1330,500,1335,496,1340,498,1348"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_icgraph" id="agroup__direct__netcdf__mod_ga507c64d98551df97643e9e549a1e3a6d_icgraph">
<area shape="rect" title="Write model attributes if they exist. This is only used for files that are created by DART." alt="" coords="1624,204,1786,245"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga30e5e10d0b1bbc7e42a16ee50f75906f" title="Write variables from start_var to end_var for actual ensemble members." alt="" coords="1420,268,1576,324"/>
<area shape="poly" title=" " alt="" coords="1631,253,1577,272,1576,267,1629,248"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga06dc065665c83c091c1b4c4feb5c16b8" title="Write out extra copies (if specified in the filter_nml) attribute in the last time slot...." alt="" coords="1425,139,1571,179"/>
<area shape="poly" title=" " alt="" coords="1624,201,1564,182,1566,177,1625,196"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga490370b86f88f566fa0e84c367401b0a" title="Write model attributes to for each variable when using &quot;single file io&quot;." alt="" coords="1422,204,1574,245"/>
<area shape="poly" title=" " alt="" coords="1608,227,1575,227,1575,222,1608,222"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1188,337,1369,378"/>
<area shape="poly" title=" " alt="" coords="1406,325,1354,339,1353,334,1405,320"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1185,272,1372,313"/>
<area shape="poly" title=" " alt="" coords="1404,297,1372,297,1372,291,1404,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="991,305,1127,346"/>
<area shape="poly" title=" " alt="" coords="1172,345,1127,338,1128,333,1173,340"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,305,933,346"/>
<area shape="poly" title=" " alt="" coords="976,328,934,328,934,323,976,323"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,305,743,346"/>
<area shape="poly" title=" " alt="" coords="775,328,743,328,743,323,775,323"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,248,552,289"/>
<area shape="poly" title=" " alt="" coords="585,304,540,292,542,287,586,299"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,97,331,122"/>
<area shape="poly" title=" " alt="" coords="657,292,642,254,619,211,589,170,551,137,498,114,440,102,383,99,332,101,332,96,383,93,441,97,500,109,554,133,593,166,624,208,647,251,662,290"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,311,315,337"/>
<area shape="poly" title=" " alt="" coords="585,328,315,327,315,322,585,323"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,207,306,233"/>
<area shape="poly" title=" " alt="" coords="638,297,599,265,551,239,487,222,421,215,359,214,307,217,306,212,358,209,421,209,488,217,553,234,602,260,642,293"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,258,137,284"/>
<area shape="poly" title=" " alt="" coords="645,359,605,396,580,413,553,425,451,460,407,471,366,477,324,476,281,468,235,453,183,429,162,415,142,398,111,357,88,317,75,285,79,283,93,314,115,354,146,394,165,411,186,425,237,448,283,463,325,471,365,471,407,466,450,455,551,420,577,408,602,391,642,355"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,515,515,541"/>
<area shape="poly" title=" " alt="" coords="657,361,616,430,588,467,554,498,517,518,514,513,551,494,584,463,612,427,652,359"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,541,323,566"/>
<area shape="poly" title=" " alt="" coords="666,362,654,409,632,463,599,515,578,537,554,556,523,571,490,580,456,585,422,586,357,581,303,570,304,564,358,575,422,581,456,580,489,575,521,566,551,551,575,533,595,512,627,460,648,407,661,361"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,363,524,389"/>
<area shape="poly" title=" " alt="" coords="585,349,521,365,520,360,584,344"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,389,323,414"/>
<area shape="poly" title=" " alt="" coords="637,358,598,384,553,404,493,416,432,421,374,419,323,415,324,409,374,414,432,415,493,411,552,399,596,379,634,353"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,617,545,642"/>
<area shape="poly" title=" " alt="" coords="667,362,654,414,632,477,600,542,579,573,554,600,524,618,521,614,551,596,574,569,595,540,627,475,649,413,661,361"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,46,535,72"/>
<area shape="poly" title=" " alt="" coords="659,291,644,247,622,194,591,140,551,93,520,75,523,70,554,89,595,137,627,191,649,245,664,290"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,147,546,173"/>
<area shape="poly" title=" " alt="" coords="646,294,605,243,579,217,551,195,514,176,516,171,554,190,583,213,609,240,650,291"/>
<area shape="poly" title=" " alt="" coords="424,240,275,125,278,121,427,236"/>
<area shape="poly" title=" " alt="" coords="374,296,309,313,308,308,373,291"/>
<area shape="poly" title=" " alt="" coords="363,247,306,234,307,229,365,242"/>
<area shape="poly" title=" " alt="" coords="363,272,137,273,137,268,363,266"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,97,94,122"/>
<area shape="poly" title=" " alt="" coords="169,112,95,112,95,107,169,107"/>
<area shape="poly" title=" " alt="" coords="195,240,122,260,120,255,194,235"/>
<area shape="poly" title=" " alt="" coords="401,539,324,548,323,543,400,533"/>
<area shape="poly" title=" " alt="" coords="392,388,324,396,323,391,391,383"/>
<area shape="poly" title=" " alt="" coords="1171,311,1128,318,1127,313,1170,306"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga811379f67b7a78e7cbfab32f80b54b8c" title="Creates a template file for single file io Calls the model for any model specific attributes to be wr..." alt="" coords="1203,204,1354,245"/>
<area shape="poly" title=" " alt="" coords="1414,187,1350,206,1349,201,1412,182"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga4db4441591f610b3e2c4d06480c28535" title="insert the mean and sd into the input file if the user requests this assumes that the files has alrea..." alt="" coords="981,63,1137,103"/>
<area shape="poly" title=" " alt="" coords="1409,146,1137,99,1138,94,1410,141"/>
<area shape="poly" title=" " alt="" coords="1188,236,1004,260,791,296,744,308,742,302,790,291,1004,255,1187,231"/>
<area shape="poly" title=" " alt="" coords="973,61,854,34,782,22,705,13,624,9,541,10,459,19,380,36,349,48,320,65,276,98,272,94,317,60,347,44,378,31,458,13,541,5,624,3,705,8,783,17,855,29,974,56"/>
<area shape="poly" title=" " alt="" coords="1406,227,1354,227,1354,222,1406,222"/>
</map>
</div>

</div>
</div>
<a id="ga4797f5013f67a845fdd1ac9aee5bdd9a" name="ga4797f5013f67a845fdd1ac9aee5bdd9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4797f5013f67a845fdd1ac9aee5bdd9a">&#9670;&#160;</a></span>write_variables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine direct_netcdf_mod::write_variables </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(r8), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>var_block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>end_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_file_clamping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>force_copy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write variables from start_var to end_var no clamping. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000053">Todo:</a></b></dt><dd>reduce output in log file? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000054">Todo:</a></b></dt><dd>FIXME, the first variable in the second domain is not found when using coamps_nest. </dd></dl>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l01538">1538</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_cgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_cgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_cgraph" id="agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_cgraph">
<area shape="rect" title="Write variables from start_var to end_var no clamping." alt="" coords="5,547,142,587"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga285ec6a4e531cbba343a349a20deea76" title="Check a variable for out of bounds and clamp or fail if needed. If the variable has clamping limits,..." alt="" coords="207,169,344,210"/>
<area shape="poly" title=" " alt="" coords="74,546,81,485,100,401,115,355,134,309,158,266,188,227,198,217,202,221,192,230,162,269,138,312,120,357,105,402,87,486,79,547"/>
<area shape="rect" href="namespaceoptions__mod.html#a536448bfef7c5c838d79e714ca7bbb6a" title=" " alt="" coords="409,208,582,249"/>
<area shape="poly" title=" " alt="" coords="74,546,83,493,102,422,117,385,136,349,159,315,188,286,235,257,288,238,342,227,393,222,394,228,343,232,289,243,237,262,191,290,163,319,140,351,122,387,107,424,88,494,79,547"/>
<area shape="rect" href="group__state__structure__mod.html#ga13bee77daeb47cebbc6a5afe1f996e1f" title="Returns the variable name." alt="" coords="426,297,566,338"/>
<area shape="poly" title=" " alt="" coords="75,546,84,497,104,435,119,402,137,371,160,343,188,321,214,307,242,297,300,287,358,287,411,294,410,299,357,293,300,292,243,302,216,312,191,325,164,347,142,374,123,405,109,436,89,499,80,547"/>
<area shape="rect" href="group__state__structure__mod.html#ga2a5be4999aa85f06acc61594f6ebd23c" title="Returns whether a variable should be clamped or not." alt="" coords="205,359,346,399"/>
<area shape="poly" title=" " alt="" coords="83,545,124,479,153,443,188,410,195,405,198,409,191,414,157,446,128,482,88,547"/>
<area shape="rect" href="group__state__structure__mod.html#ga1afde1c8dca54decec4036a12a074a95" title="Returns whether a variable should be updated or not." alt="" coords="205,448,346,489"/>
<area shape="poly" title=" " alt="" coords="112,544,188,505,213,493,215,498,191,509,115,549"/>
<area shape="rect" href="group__state__structure__mod.html#gac8402c2505f0506c3e8c91810c18ce74" title="Return and array containing the dimension lengths, for the DART state excluding the UNLIMITED dim." alt="" coords="205,587,346,627"/>
<area shape="poly" title=" " alt="" coords="143,578,190,587,189,593,142,583"/>
<area shape="rect" href="group__state__structure__mod.html#ga1c99dd9ce25dae36c2d31e3ec24ab983" title="Returns the number of dimensions for a variable." alt="" coords="426,545,566,586"/>
<area shape="poly" title=" " alt="" coords="142,553,189,548,275,545,361,548,410,552,409,558,361,554,275,550,190,554,142,559"/>
<area shape="rect" href="group__state__structure__mod.html#ga3296e1af2ff8b574a2e537fffc50dbb2" title="Returns the number of dimensions for a variable." alt="" coords="205,676,346,717"/>
<area shape="poly" title=" " alt="" coords="108,586,231,665,228,670,105,590"/>
<area shape="rect" href="group__state__structure__mod.html#gaed482c290580f45e54eac3d6b161acc4" title="Returns the size of a variable in a specific domain." alt="" coords="205,765,346,806"/>
<area shape="poly" title=" " alt="" coords="88,586,130,652,159,691,191,726,227,755,223,759,188,730,155,694,126,655,84,589"/>
<area shape="rect" href="group__state__structure__mod.html#ga9966d44b1adb8875a8d887e2e5a4181b" title="Return whether the domain has an unlimited dimension." alt="" coords="205,920,346,961"/>
<area shape="poly" title=" " alt="" coords="80,587,91,643,112,719,145,803,166,844,192,881,222,909,218,913,188,885,162,847,140,806,107,721,86,644,75,588"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ab84e952e7df4fd6a0770e9fca314b932" title="check return code from previous call. on error, print and stop. if you want to continue after an erro..." alt="" coords="207,831,344,871"/>
<area shape="poly" title=" " alt="" coords="81,587,93,634,114,695,147,759,167,789,192,816,196,820,192,824,188,820,163,792,142,762,110,697,88,635,76,589"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga31a5d51284ae8bd115186ab8e168a574" title="replace the DART missing value code with the original netCDF missing_value (or _FillValue) value." alt="" coords="190,1021,361,1062"/>
<area shape="poly" title=" " alt="" coords="79,587,87,656,106,755,121,810,139,866,163,920,192,971,209,992,229,1010,226,1014,205,995,187,974,158,922,135,867,115,811,101,756,82,657,74,588"/>
<area shape="rect" href="group__state__structure__mod.html#gaa746db1fcb2bb9eb002482f72b8e33a7" title="Return clamping maximum for a given variable." alt="" coords="410,29,582,70"/>
<area shape="poly" title=" " alt="" coords="296,167,345,124,408,81,419,75,422,79,410,85,349,129,300,171"/>
<area shape="rect" href="group__state__structure__mod.html#ga1979761ca8bd2fb09627149fee5de375" title="Return clamping minimum for a given variable." alt="" coords="412,119,580,159"/>
<area shape="poly" title=" " alt="" coords="343,171,396,159,397,164,344,177"/>
<area shape="poly" title=" " alt="" coords="344,199,394,208,393,213,343,204"/>
<area shape="poly" title=" " alt="" coords="313,208,447,287,444,291,311,213"/>
<area shape="poly" title=" " alt="" coords="458,29,456,19,462,10,476,5,496,3,517,5,530,11,528,16,516,10,496,8,477,10,466,15,461,20,463,28"/>
<area shape="poly" title=" " alt="" coords="458,119,456,109,462,100,476,94,496,92,517,94,530,101,528,105,516,100,496,97,477,99,466,104,461,110,463,117"/>
<area shape="poly" title=" " alt="" coords="458,208,456,198,462,189,476,183,496,181,517,184,530,190,528,195,516,189,496,187,477,189,466,193,461,199,463,207"/>
<area shape="poly" title=" " alt="" coords="458,297,456,287,462,278,476,273,496,271,517,273,530,279,528,284,516,278,496,276,477,278,466,283,461,288,463,296"/>
<area shape="poly" title=" " alt="" coords="237,359,235,349,241,340,255,334,275,332,297,334,310,341,308,345,296,340,275,337,256,339,245,344,240,350,242,357"/>
<area shape="poly" title=" " alt="" coords="237,448,235,438,241,429,255,423,275,421,297,424,310,430,308,435,296,429,275,427,256,429,245,433,240,439,242,447"/>
<area shape="poly" title=" " alt="" coords="237,587,235,577,241,568,255,562,275,560,297,562,310,569,308,573,296,568,275,565,256,567,245,572,240,578,242,585"/>
<area shape="poly" title=" " alt="" coords="346,591,410,579,411,584,347,596"/>
<area shape="poly" title=" " alt="" coords="458,545,456,535,462,526,476,521,496,519,517,521,530,527,528,532,516,526,496,524,477,526,466,531,461,536,463,544"/>
<area shape="poly" title=" " alt="" coords="237,676,235,666,241,657,255,651,275,649,297,652,310,658,308,663,296,657,275,655,256,657,245,661,240,667,242,675"/>
<area shape="poly" title=" " alt="" coords="237,765,235,755,241,746,255,741,275,739,297,741,310,747,308,752,296,746,275,744,256,746,245,751,240,756,242,764"/>
<area shape="rect" href="group__state__structure__mod.html#gaa4224d79f976c86c9b1e393242b2ff67" title=" " alt="" coords="426,765,566,806"/>
<area shape="poly" title=" " alt="" coords="346,783,410,783,410,788,346,788"/>
<area shape="rect" href="namespaceutilities__mod.html#a12b6bcff9ee2f6b821e7a01543fb0dfa" title="write to log and/or standard output, messages, warnings, debug, errors" alt="" coords="630,765,759,806"/>
<area shape="poly" title=" " alt="" coords="346,763,409,751,496,744,583,751,618,758,617,763,582,756,496,749,409,756,347,768"/>
<area shape="poly" title=" " alt="" coords="566,783,615,783,615,788,566,788"/>
<area shape="rect" href="namespaceutilities__mod.html#a9e688ceaa3cb2caac0a21dcf687d21d6" title="call this routine if you find an error before the logfile has been opened." alt="" coords="810,700,937,741"/>
<area shape="poly" title=" " alt="" coords="751,762,801,744,802,749,753,767"/>
<area shape="rect" href="namespaceutilities__mod.html#a19b014d0d1c69eb19cb8e2b5454fb428" title="call this routine if you end up in a function or subroutine here that CANNOT be called before the ini..." alt="" coords="810,765,937,806"/>
<area shape="poly" title=" " alt="" coords="759,783,794,783,794,788,759,788"/>
<area shape="rect" href="namespaceutilities__mod.html#a54f5adeb1920ae3e09826e1feeb09138" title="if trying to write an unformatted string, like &quot;write(*,*)&quot; to both standard output and the logfile,..." alt="" coords="807,830,940,856"/>
<area shape="poly" title=" " alt="" coords="760,804,817,822,816,828,758,809"/>
<area shape="poly" title=" " alt="" coords="237,920,235,910,241,901,255,895,275,893,297,896,310,902,308,907,296,901,275,899,256,901,245,905,240,911,242,919"/>
<area shape="poly" title=" " alt="" coords="344,844,456,834,582,815,614,807,616,813,583,820,457,839,345,850"/>
<area shape="rect" href="namespacenetcdf__utilities__mod.html#ad1aed8fb433368a14c78e5dd6102687f" title="look up and return the filename for this handle" alt="" coords="426,880,566,921"/>
<area shape="poly" title=" " alt="" coords="345,864,411,879,410,884,344,869"/>
<area shape="rect" href="group__state__structure__mod.html#gaba0e71d34ddf5ca56d1ee3cb4dcf291d" title="Return .true. if the variable has a &#39;FillValue&#39;." alt="" coords="426,969,566,1010"/>
<area shape="poly" title=" " alt="" coords="361,1019,410,1007,411,1012,362,1024"/>
<area shape="rect" href="group__state__structure__mod.html#gaf9b49db0f0b3c932f1a2d53819516c91" title="Return .true. if the variable has a &#39;missing_value&#39;." alt="" coords="413,1059,578,1099"/>
<area shape="poly" title=" " alt="" coords="362,1054,398,1060,397,1065,361,1059"/>
<area shape="rect" href="group__state__structure__mod.html#gae70d16314c72c97cf3d1dbdac38e4552" title="Return netCDF type of a variable (aka &#39;xtype&#39;)" alt="" coords="426,1148,566,1189"/>
<area shape="poly" title=" " alt="" coords="314,1060,447,1138,444,1142,311,1065"/>
<area shape="poly" title=" " alt="" coords="458,969,456,959,462,950,476,945,496,943,517,945,530,951,528,956,516,950,496,948,477,950,466,955,461,960,463,968"/>
<area shape="poly" title=" " alt="" coords="458,1059,456,1049,462,1040,476,1034,496,1032,517,1034,530,1041,528,1045,516,1040,496,1037,477,1039,466,1044,461,1050,463,1057"/>
<area shape="poly" title=" " alt="" coords="458,1148,456,1138,462,1129,476,1123,496,1121,517,1124,530,1130,528,1135,516,1129,496,1127,477,1129,466,1133,461,1139,463,1147"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_icgraph.png" border="0" usemap="#agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_icgraph" alt=""/></div>
<map name="agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_icgraph" id="agroup__direct__netcdf__mod_ga4797f5013f67a845fdd1ac9aee5bdd9a_icgraph">
<area shape="rect" title="Write variables from start_var to end_var no clamping." alt="" coords="1400,287,1536,328"/>
<area shape="rect" href="group__direct__netcdf__mod.html#gaac697410acb3e6e9c9483c6865694799" title="Transpose from state_ens_handlecopies to the writers according to the memory limit imposed by write_v..." alt="" coords="1168,254,1349,295"/>
<area shape="poly" title=" " alt="" coords="1384,297,1349,291,1350,286,1385,292"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga5a0dc19e06b1c54e04d3bd0921f674a1" title="Single processor version of transpose write. Takes copies array one row at a time and writes copy to ..." alt="" coords="1165,319,1352,360"/>
<area shape="poly" title=" " alt="" coords="1385,323,1353,328,1352,323,1384,318"/>
<area shape="rect" href="group__direct__netcdf__mod.html#ga8ca56c81dfed34ffca506790ad794e1c" title="This code transposes and writes out the state vector copies This can either be done on a single task ..." alt="" coords="981,287,1117,328"/>
<area shape="poly" title=" " alt="" coords="1153,294,1118,299,1117,294,1152,288"/>
<area shape="rect" href="group__state__vector__io__mod.html#ga9e82df2178766c49361ea39cb5ec39c0" title="write the restart information directly into the model netcdf file." alt="" coords="791,287,933,328"/>
<area shape="poly" title=" " alt="" coords="966,310,933,310,933,305,966,305"/>
<area shape="rect" href="group__state__vector__io__mod.html#gab0cd1b1a5e523fff63e58b5e32aa137f" title="Write state vectors from an ensemble_handle The inflation handles are options (used by filter,..." alt="" coords="600,287,743,328"/>
<area shape="poly" title=" " alt="" coords="775,310,743,310,743,305,775,305"/>
<area shape="rect" href="namespaceobs__model__mod.html#a03fc749b8153a9183a25baa68e40b6b1" title=" " alt="" coords="379,103,552,144"/>
<area shape="poly" title=" " alt="" coords="647,276,606,219,580,190,551,164,522,147,525,142,554,160,584,186,610,216,652,272"/>
<area shape="rect" href="namespacefilter__mod.html#ab534c6a0fba7c3dc09e5e1d7d4081725" title="The code does not use vars arrays except:" alt="" coords="185,5,331,31"/>
<area shape="poly" title=" " alt="" coords="662,272,650,222,629,162,597,104,576,78,551,56,526,41,499,29,441,15,384,10,331,11,331,6,384,5,442,10,501,24,528,36,554,52,579,74,601,101,634,160,655,220,667,271"/>
<area shape="rect" href="integrate__model_8f90.html#a39361a38d1d1f388f940daadcf81708d" title="Program to integrate assimilation model forward for asynchronous filter execution." alt="" coords="201,57,315,83"/>
<area shape="poly" title=" " alt="" coords="660,273,646,230,624,180,593,132,573,111,551,94,523,79,493,68,430,57,369,57,315,62,315,57,368,51,431,52,495,63,525,74,554,89,577,107,597,129,629,177,651,228,665,271"/>
<area shape="rect" href="perfect__model__obs_8f90.html#a58753874ca7dcb34421e47b0b8aab056" title=" " alt="" coords="210,167,306,192"/>
<area shape="poly" title=" " alt="" coords="639,278,600,244,551,215,487,195,421,184,358,180,306,180,306,174,359,175,421,179,488,190,553,210,603,240,643,274"/>
<area shape="rect" href="perfect__model__obs_8f90.html#ace838a670d33ed820e1afa9c1965cbf4" title="Program to build an obs_sequence file from simulated observations." alt="" coords="5,167,137,192"/>
<area shape="poly" title=" " alt="" coords="584,292,184,207,131,196,132,190,185,202,585,287"/>
<area shape="rect" href="model__mod__check_8f90.html#a93ebac630e4dec9573eb9da1a1cb2ead" title=" " alt="" coords="416,320,515,346"/>
<area shape="poly" title=" " alt="" coords="585,321,516,329,515,324,584,316"/>
<area shape="rect" href="model__mod__check_8f90.html#af2536688a15213cba4ebc6a851a45104" title="Tests model_mod routines. Very useful when adding a new model. This version works for models with any..." alt="" coords="193,295,323,320"/>
<area shape="poly" title=" " alt="" coords="585,310,324,310,324,305,585,305"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#a7c606b69ccc4bec7ebfa954764bf201c" title="fill inflation values in a separate file" alt="" coords="407,421,524,447"/>
<area shape="poly" title=" " alt="" coords="639,340,600,373,554,404,512,423,510,418,551,400,597,369,636,336"/>
<area shape="rect" href="fill__inflation__restart_8f90.html#ac8e72a7b76fdba3de229a655e9e54545" title="Generate initial inflation files from namelist values. This way an experiment can always start from a..." alt="" coords="193,396,323,422"/>
<area shape="poly" title=" " alt="" coords="616,337,553,361,432,389,324,405,323,399,431,383,552,356,614,332"/>
<area shape="rect" href="perturb__single__instance_8f90.html#aff26cf01390ffd898782721077437137" title="This is a utility program that computes an ensemble of restarts using the model_mod pert_model_copies..." alt="" coords="387,471,545,496"/>
<area shape="poly" title=" " alt="" coords="655,343,614,404,586,435,554,462,533,472,531,468,551,457,582,431,610,400,650,340"/>
<area shape="rect" href="test__cf__conventions_8f90.html#a5a105288bd6bafb8756891940bbf2497" title=" " alt="" coords="397,520,535,546"/>
<area shape="poly" title=" " alt="" coords="662,343,646,382,623,427,592,473,554,511,536,522,533,517,551,507,588,469,618,425,641,380,657,341"/>
<area shape="rect" href="test__read__write__restarts_8f90.html#ad75528c600d04f930410d57ba3d4adfc" title=" " alt="" coords="385,569,546,595"/>
<area shape="poly" title=" " alt="" coords="666,344,653,393,631,451,598,510,578,537,554,560,537,571,534,567,551,556,574,533,594,507,626,449,648,391,661,342"/>
<area shape="poly" title=" " alt="" coords="419,97,330,47,298,34,300,29,332,42,421,92"/>
<area shape="poly" title=" " alt="" coords="369,101,310,86,312,81,370,96"/>
<area shape="poly" title=" " alt="" coords="374,151,307,169,306,164,373,146"/>
<area shape="poly" title=" " alt="" coords="364,134,185,157,127,169,126,163,184,152,364,129"/>
<area shape="rect" href="filter_8f90.html#a3e86f9737a8d44a69560730870a3b5f4" title="Main DART Ensemble Filtering Program." alt="" coords="48,5,94,31"/>
<area shape="poly" title=" " alt="" coords="169,21,95,21,95,16,169,16"/>
<area shape="poly" title=" " alt="" coords="194,182,137,182,137,177,194,177"/>
<area shape="poly" title=" " alt="" coords="400,328,323,318,324,313,401,322"/>
<area shape="poly" title=" " alt="" coords="391,428,323,419,324,414,392,423"/>
<area shape="poly" title=" " alt="" coords="1149,326,1117,321,1118,315,1150,320"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaf9895fa2d5184a06d7e067817bc46895" name="gaf9895fa2d5184a06d7e067817bc46895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf9895fa2d5184a06d7e067817bc46895">&#9670;&#160;</a></span>msgstring</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=512) direct_netcdf_mod::msgstring</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00135">135</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>

</div>
</div>
<a id="ga0ee9f8782a2aebda59b8b20a45537673" name="ga0ee9f8782a2aebda59b8b20a45537673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ee9f8782a2aebda59b8b20a45537673">&#9670;&#160;</a></span>msgstring2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=512) direct_netcdf_mod::msgstring2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00135">135</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>

</div>
</div>
<a id="ga537d935ffe862c59c53c24dc4825ec14" name="ga537d935ffe862c59c53c24dc4825ec14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga537d935ffe862c59c53c24dc4825ec14">&#9670;&#160;</a></span>overwrite_time_in_output_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical direct_netcdf_mod::overwrite_time_in_output_file = .false.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000042">Todo:</a></b></dt><dd>FIXME: this should be in a namelist somewhere and passed in from a higher level routine.</dd></dl>
<p>we had this in the ROMS branch but no one can remember why. we think it's because we copied a template file into place for filter to overwrite and it might not have had the right analysis time in the file. it's true that filter doesn't change the time in the file, but when we're doing direct updates of a netcdf file it's also true that we rarely update the file we read from; in case of an error you've destroyed your input needed to rerun the job. (but we don't remember for sure if this was the reason.) </p>

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00151">151</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>

</div>
</div>
<a id="ga1afe8e546cf04d71faf60750393aaa9f" name="ga1afe8e546cf04d71faf60750393aaa9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1afe8e546cf04d71faf60750393aaa9f">&#9670;&#160;</a></span>ret</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer direct_netcdf_mod::ret</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00134">134</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>

</div>
</div>
<a id="ga8747a4cc552d1e203e04d48d72ae3269" name="ga8747a4cc552d1e203e04d48d72ae3269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8747a4cc552d1e203e04d48d72ae3269">&#9670;&#160;</a></span>single_io_task_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter direct_netcdf_mod::single_io_task_id = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="direct__netcdf__mod_8f90_source.html#l00131">131</a> of file <a class="el" href="direct__netcdf__mod_8f90_source.html">direct_netcdf_mod.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
